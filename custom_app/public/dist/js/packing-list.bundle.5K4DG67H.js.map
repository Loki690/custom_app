{
  "version": 3,
  "sources": ["../../../../../apps/erpnext/node_modules/onscan.js/onscan.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/Barcode.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/CODE39/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/CODE128/constants.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/CODE128/CODE128.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/CODE128/auto.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/CODE128/CODE128_AUTO.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/CODE128/CODE128A.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/CODE128/CODE128B.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/CODE128/CODE128C.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/CODE128/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/constants.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/encoder.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/EAN.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/EAN13.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/EAN8.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/EAN5.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/EAN2.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/UPC.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/UPCE.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/EAN_UPC/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/ITF/constants.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/ITF/ITF.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/ITF/ITF14.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/ITF/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/MSI/MSI.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/MSI/checksums.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/MSI/MSI10.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/MSI/MSI11.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/MSI/MSI1010.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/MSI/MSI1110.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/MSI/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/pharmacode/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/codabar/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/GenericBarcode/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/barcodes/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/help/merge.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/help/linearizeEncodings.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/help/fixOptions.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/help/optionsFromStrings.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/options/defaults.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/help/getOptionsFromElement.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/renderers/shared.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/renderers/canvas.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/renderers/svg.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/renderers/object.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/renderers/index.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/exceptions/exceptions.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/help/getRenderProperties.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/exceptions/ErrorHandler.js", "../../../../../apps/frappe/node_modules/jsbarcode/bin/JsBarcode.js", "../../../../../apps/custom_app/custom_app/customapp/page/packing_list/packing_list_item_selector.js", "../../../../../apps/custom_app/custom_app/customapp/page/packing_list/packing_list_item_cart.js", "../../../../../apps/custom_app/custom_app/customapp/page/packing_list/packing_list_item_details.js", "../../../../../apps/custom_app/custom_app/customapp/page/packing_list/packing_list_number_pad.js", "../../../../../apps/custom_app/custom_app/customapp/page/packing_list/packing_list_payment.js", "../../../../../apps/custom_app/custom_app/customapp/page/packing_list/packing_list_past_oder_list.js", "../../../../../apps/custom_app/custom_app/customapp/page/packing_list/packing_list_past_order_summary.js", "../../../../../apps/custom_app/custom_app/customapp/page/packing_list/packing_list_controller.js"],
  "sourcesContent": ["/*\n * onScan.js - scan-events for hardware barcodes scanners in javascript\n */\n;(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory()) :\n    global.onScan = factory()\n}(this, (function () {\n\tvar onScan = {\t\n\t\t\n\t\t/**\n\t\t * \n\t\t * @param DomElement oDomElement\n\t\t * @param Object oOptions\n\t\t * @return self\n\t\t */\n\t\tattachTo: function(oDomElement, oOptions) {\n\t\n\t\t\tif(oDomElement.scannerDetectionData !== undefined){\n\t\t\t\tthrow new Error(\"onScan.js is already initialized for DOM element \" + oDomElement);\n\t\t\t}\n\t\n\t\t\tvar oDefaults = {\n\t\t\t\tonScan: function(sScanned, iQty){}, // Callback after detection of a successfull scanning:  function(){sScancode, iCount)}()\n\t\t\t\tonScanError: function(oDebug){}, // Callback after detection of a unsuccessfull scanning (scanned string in parameter)\n\t\t\t\tonKeyProcess: function(sChar, oEvent){}, // Callback after receiving and processing a char (scanned char in parameter)\n\t\t\t\tonKeyDetect: function(iKeyCode, oEvent){}, // Callback after detecting a keyDown (key char in parameter) - in contrast to onKeyProcess, this fires for non-character keys like tab, arrows, etc. too!\n\t\t\t\tonPaste: function(sPasted, oEvent){}, // Callback after receiving a value on paste, no matter if it is a valid code or not\n\t\t\t\tkeyCodeMapper: function(oEvent) {return onScan.decodeKeyEvent(oEvent)}, // Custom function to decode a keydown event into a character. Must return decoded character or NULL if the given event should not be processed.\n\t\t\t\tonScanButtonLongPress: function(){}, // Callback after detection of a successfull scan while the scan button was pressed and held down\n\t\t\t\tscanButtonKeyCode:false, // Key code of the scanner hardware button (if the scanner button a acts as a key itself) \n\t\t\t\tscanButtonLongPressTime:500, // How long (ms) the hardware button should be pressed, until a callback gets executed\n\t\t\t\ttimeBeforeScanTest:100, // Wait duration (ms) after keypress event to check if scanning is finished\n\t\t\t\tavgTimeByChar:30, // Average time (ms) between 2 chars. Used to do difference between keyboard typing and scanning\n\t\t\t\tminLength:6, // Minimum length for a scanning\n\t\t\t\tsuffixKeyCodes:[9,13], // Chars to remove and means end of scanning\n\t\t\t\tprefixKeyCodes:[], // Chars to remove and means start of scanning\n\t\t\t\tignoreIfFocusOn:false, // do not handle scans if the currently focused element matches this selector or object\n\t\t\t\tstopPropagation:false, // Stop immediate propagation on keypress event\n\t\t\t\tpreventDefault:false, // Prevent default action on keypress event\n\t\t\t\tcaptureEvents:false, // Get the events before any listeners deeper in the DOM\n\t\t\t\treactToKeydown:true, // look for scan input in keyboard events\n\t\t\t\treactToPaste:false, // look for scan input in paste events\n\t\t\t\tsingleScanQty: 1, // Quantity of Items put out to onScan in a single scan\n\t\t\t}\n\t\t\t\t\t\t\t\t\t\n\t\t\toOptions = this._mergeOptions(oDefaults, oOptions);\n\t\n\t\t\t// initializing options and variables on DomElement\n\t\t\toDomElement.scannerDetectionData = {\n\t\t\t\t\toptions: oOptions,\n\t\t\t\t\tvars:{\n\t\t\t\t\t\tfirstCharTime: 0,\n\t\t\t\t\t\tlastCharTime: 0,\n\t\t\t\t\t\taccumulatedString: '',\n\t\t\t\t\t\ttestTimer: false,\n\t\t\t\t\t\tlongPressTimeStart: 0,\n\t\t\t\t\t\tlongPressed: false\n\t\t\t\t\t}\n\t\t\t\t\n\t\t\t};\n\t\t\t\n\t\t\t// initializing handlers (based on settings)\n\t\t\tif (oOptions.reactToPaste === true){\n\t\t\t\toDomElement.addEventListener(\"paste\", this._handlePaste, oOptions.captureEvents);\n\t\t\t}\n\t\t\tif (oOptions.scanButtonKeyCode !== false){\n\t\t\t\toDomElement.addEventListener(\"keyup\", this._handleKeyUp, oOptions.captureEvents);\n\t\t\t}\n\t\t\tif (oOptions.reactToKeydown === true || oOptions.scanButtonKeyCode !== false){\t\n\t\t\t\toDomElement.addEventListener(\"keydown\", this._handleKeyDown, oOptions.captureEvents);\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t\n\t\t/**\n\t\t * \n\t\t * @param DomElement oDomElement\n\t\t * @return void\n\t\t */\n\t\tdetachFrom: function(oDomElement) {\n\t\t\t// detaching all used events\n\t\t\tif (oDomElement.scannerDetectionData.options.reactToPaste){\n\t\t\t\toDomElement.removeEventListener(\"paste\", this._handlePaste);\n\t\t\t}\n\t\t\tif (oDomElement.scannerDetectionData.options.scanButtonKeyCode !== false){\n\t\t\t\toDomElement.removeEventListener(\"keyup\", this._handleKeyUp);\n\t\t\t}\n\t\t\toDomElement.removeEventListener(\"keydown\", this._handleKeyDown);\n\t\t\t\n\t\t\t// clearing data off DomElement\n\t\t\toDomElement.scannerDetectionData = undefined; \n\t\t\treturn;\n\t\t},\n\t\t\n\t\t/**\n\t\t * \n\t\t * @param DomElement oDomElement\n\t\t * @return Object\n\t\t */\n\t\tgetOptions: function(oDomElement){\n\t\t\treturn oDomElement.scannerDetectionData.options;\t\t\t\n\t\t},\n\t\n\t\t/**\n\t\t * \n\t\t * @param DomElement oDomElement\n\t\t * @param Object oOptions\n\t\t * @return self\n\t\t */\n\t\tsetOptions: function(oDomElement, oOptions){\n\t\t\t// check if some handlers need to be changed based on possible option changes\n\t\t\tswitch (oDomElement.scannerDetectionData.options.reactToPaste){\n\t\t\t\tcase true: \n\t\t\t\t\tif (oOptions.reactToPaste === false){\n\t\t\t\t\t\toDomElement.removeEventListener(\"paste\", this._handlePaste);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase false:\n\t\t\t\t\tif (oOptions.reactToPaste === true){\n\t\t\t\t\t\toDomElement.addEventListener(\"paste\", this._handlePaste);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\tswitch (oDomElement.scannerDetectionData.options.scanButtonKeyCode){\n\t\t\t\tcase false:\n\t\t\t\t\tif (oOptions.scanButtonKeyCode !== false){\n\t\t\t\t\t\toDomElement.addEventListener(\"keyup\", this._handleKeyUp);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault: \n\t\t\t\t\tif (oOptions.scanButtonKeyCode === false){\n\t\t\t\t\t\toDomElement.removeEventListener(\"keyup\", this._handleKeyUp);\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\n\t\t\t// merge old and new options\n\t\t\toDomElement.scannerDetectionData.options = this._mergeOptions(oDomElement.scannerDetectionData.options, oOptions);\n\t\t\n\t\t\t// reinitiallize\n\t\t\tthis._reinitialize(oDomElement);\n\t\t\treturn this;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Transforms key codes into characters.\n\t\t * \n\t\t * By default, only the follwing key codes are taken into account\n\t\t * - 48-90 (letters and regular numbers)\n\t\t * - 96-105 (numeric keypad numbers)\n\t\t * - 106-111 (numeric keypad operations)\n\t\t * \n\t\t * All other keys will yield empty strings!\n\t\t * \n\t\t * The above keycodes will be decoded using the KeyboardEvent.key property on modern\n\t\t * browsers. On older browsers the method will fall back to String.fromCharCode()\n\t\t * putting the result to upper/lower case depending on KeyboardEvent.shiftKey if\n\t\t * it is set.\n\t\t * \n\t\t * @param KeyboardEvent oEvent\n\t\t * @return string\n\t\t */\n\t\tdecodeKeyEvent : function (oEvent) {\n\t\t\tvar iCode = this._getNormalizedKeyNum(oEvent);\n\t\t\tswitch (true) {\n\t\t\t\tcase iCode >= 48 && iCode <= 90: // numbers and letters\n\t\t\t\tcase iCode >= 106 && iCode <= 111: // operations on numeric keypad (+, -, etc.)\n\t\t\t\t\tif (oEvent.key !== undefined && oEvent.key !== '') {\n\t\t\t\t\t\treturn oEvent.key;\n\t\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\tvar sDecoded = String.fromCharCode(iCode);\n\t\t\t\t\tswitch (oEvent.shiftKey) {\n\t\t\t\t\t\tcase false: sDecoded = sDecoded.toLowerCase(); break;\n\t\t\t\t\t\tcase true: sDecoded = sDecoded.toUpperCase(); break;\n\t\t\t\t\t}\n\t\t\t\t\treturn sDecoded;\n\t\t\t\tcase iCode >= 96 && iCode <= 105: // numbers on numeric keypad\n\t\t\t\t\treturn 0+(iCode-96);\n\t\t\t}\n\t\t\treturn '';\n\t\t},\n\t\t\n\t\t/**\n\t\t * Simulates a scan of the provided code.\n\t     *\n\t\t * The scan code can be defined as\n\t\t * - a string - in this case no keyCode decoding is done and the code is merely validated\n\t\t * against constraints like minLenght, etc.\n\t\t * - an array of keyCodes (e.g. `[70,71,80]`) - will produce `keydown` events with corresponding\n\t\t * `keyCode` properties. NOTE: these events will have empty `key` properties, so decoding may\n\t\t * yield different results than with native events.\n\t\t * - an array of objects (e.g. `[{keyCode: 70, key: \"F\", shiftKey: true}, {keyCode: 71, key: \"g\"}]`) -\n\t\t * this way almost any event can be simulated, but it's a lot of work to do.\n\t\t *\n\t\t * @param DomElement oDomElement\n\t\t * @param string|array mStringOrArray\n\t\t * @return self\n\t\t */\n\t\tsimulate: function(oDomElement, mStringOrArray){\n\t\t\tthis._reinitialize(oDomElement);\n\t\t\tif (Array.isArray(mStringOrArray)){\n\t\t\t\tmStringOrArray.forEach(function(mKey){\n\t\t\t\t\tvar oEventProps = {};\n\t\t\t\t\tif( (typeof mKey === \"object\" || typeof mKey === 'function') && (mKey !== null) ) {\n\t\t\t\t\t\toEventProps = mKey;\n\t\t\t\t\t} else {\n\t\t\t\t\t\toEventProps.keyCode = parseInt(mKey);\n\t\t\t\t\t}\n\t\t\t\t\tvar oEvent = new KeyboardEvent('keydown', oEventProps);\n\t\t\t\t\tdocument.dispatchEvent(oEvent);\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tthis._validateScanCode(oDomElement, mStringOrArray);\n\t\t\t}\n\t\t\treturn this;\n\t\t},\n\t\t\n\t\t/**\n\t\t * @private\n\t\t * @param DomElement oDomElement\n\t\t * @return void\n\t\t */\n\t\t_reinitialize: function(oDomElement){\n\t\t\tvar oVars = oDomElement.scannerDetectionData.vars;\n\t\t\toVars.firstCharTime = 0;\n\t\t\toVars.lastCharTime = 0;\n\t\t\toVars.accumulatedString = '';\n\t\t\treturn;\n\t\t},\n\t\t\n\t\t/**\n\t\t * @private\n\t\t * @param DomElement oDomElement\n\t     * @return boolean\n\t\t */\n\t\t_isFocusOnIgnoredElement: function(oDomElement){\n\t\t\t\n\t\t\tvar ignoreSelectors = oDomElement.scannerDetectionData.options.ignoreIfFocusOn;\n\t\n\t        if(!ignoreSelectors){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\n\t\t\tvar oFocused = document.activeElement;\n\t\t\t\n\t\t\t// checks if ignored element is an array, and if so it checks if one of the elements of it is an active one\n\t\t\tif (Array.isArray(ignoreSelectors)){\n\t\t\t\tfor(var i=0; i<ignoreSelectors.length; i++){\n\t\t\t\t\tif(oFocused.matches(ignoreSelectors[i]) === true){\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t// if the option consists of an single element, it only checks this one\n\t\t\t} else if (oFocused.matches(ignoreSelectors)){\n\t\t\t\treturn true;\t\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\t// if the active element is not listed in the ignoreIfFocusOn option, return false\n\t\t    return false;\n\t    },\n\t\t\n\t    /**\n\t     * Validates the scan code accumulated by the given DOM element and fires the respective events.\n\t     * \n\t     * @private\n\t     * @param DomElement oDomElement\n\t     * @return boolean\n\t     */\n\t\t_validateScanCode: function(oDomElement, sScanCode){\n\t\t\tvar oScannerData = oDomElement.scannerDetectionData;\t\t\t\n\t\t\tvar oOptions = oScannerData.options;\n\t\t\tvar iSingleScanQty = oScannerData.options.singleScanQty;\n\t\t\tvar iFirstCharTime = oScannerData.vars.firstCharTime;\n\t\t\tvar iLastCharTime = oScannerData.vars.lastCharTime;\n\t\t\tvar oScanError = {};\n\t        var oEvent;\n\t        \n\t\t\tswitch(true){\n\t\t\t\t\n\t\t\t\t// detect codes that are too short\n\t\t\t\tcase (sScanCode.length < oOptions.minLength):\n\t\t\t\t\toScanError = {\n\t\t\t\t\t\tmessage: \"Receieved code is shorter then minimal length\"\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t// detect codes that were entered too slow\t\n\t\t\t\tcase ((iLastCharTime - iFirstCharTime) > (sScanCode.length * oOptions.avgTimeByChar)):\n\t\t\t\t\toScanError = {\n\t\t\t\t\t\tmessage: \"Receieved code was not entered in time\"\n\t\t\t\t\t};\t\t\t\t\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t// if a code was not filtered out earlier it is valid\t\n\t\t\t\tdefault:\n\t\t\t\t\toOptions.onScan.call(oDomElement, sScanCode, iSingleScanQty);\n\t\t\t\t\toEvent = new CustomEvent(\n\t\t\t\t\t\t'scan',\n\t\t\t\t\t\t{\t\n\t\t\t\t\t\t\tdetail: { \n\t\t\t\t\t\t\t\tscanCode: sScanCode,\n\t\t\t\t\t\t\t\tqty: iSingleScanQty\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\toDomElement.dispatchEvent(oEvent);\n\t\t\t\t\tonScan._reinitialize(oDomElement);\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\t\n\t\t\t// If an error occurred (otherwise the method would return earlier) create an object for errordetection\n\t\t\toScanError.scanCode = sScanCode;\n\t\t\toScanError.scanDuration = iLastCharTime - iFirstCharTime;\n\t\t\toScanError.avgTimeByChar = oOptions.avgTimeByChar;\n\t\t\toScanError.minLength = oOptions.minLength;\n\t\t\t\n\t\t\toOptions.onScanError.call(oDomElement, oScanError);\n\t\t\t\n\t\t\toEvent = new CustomEvent(\n\t\t\t\t'scanError', \n\t\t\t\t{detail: oScanError}\n\t\t\t);\n\t\t\toDomElement.dispatchEvent(oEvent);\n\t\t\t\n\t\t\tonScan._reinitialize(oDomElement);\n\t\t\treturn false;\n\t    },\n\t\n\t    /**\n\t     * @private\n\t     * @param Object oDefaults\n\t     * @param Object oOptions\n\t     * @return Object\n\t     */\n\t\t_mergeOptions: function(oDefaults, oOptions){\n\t\t\tvar oExtended = {};\n\t\t\tvar prop;\n\t\t\tfor (prop in oDefaults){\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(oDefaults, prop)){\n\t\t\t\t\toExtended[prop] = oDefaults[prop];\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t\tfor (prop in oOptions){\n\t\t\t\tif (Object.prototype.hasOwnProperty.call(oOptions, prop)){\n\t\t\t\t\toExtended[prop] = oOptions[prop];\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t\treturn oExtended;\n\t\t},\n\t\n\t\t/**\n\t\t * @private\n\t\t * @param KeyboardEvent e\n\t\t * @return int\n\t\t * @see https://www.w3schools.com/jsref/event_key_keycode.asp\n\t\t */\n\t\t_getNormalizedKeyNum: function(e){\n\t\t\treturn e.which || e.keyCode;\n\t\t},\n\t\n\t\n\t\t/**\n\t\t * @private\n\t\t * @param KeyboardEvent e\n\t\t * @return void\n\t\t */\n\t\t_handleKeyDown: function(e){\n\t\t\tvar iKeyCode = onScan._getNormalizedKeyNum(e);\n\t\t\tvar oOptions = this.scannerDetectionData.options;\n\t\t\tvar oVars = this.scannerDetectionData.vars;\n\t\t\tvar bScanFinished = false;\n\t\t\t\n\t\t\tif (oOptions.onKeyDetect.call(this, iKeyCode, e) === false) {\n\t\t\t\treturn;\n\t\t\t}\t\t\n\t\t\t\n\t\t\tif (onScan._isFocusOnIgnoredElement(this)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\t\t\t\n\t        // If it's just the button of the scanner, ignore it and wait for the real input\n\t\t    if(oOptions.scanButtonKeyCode !== false && iKeyCode==oOptions.scanButtonKeyCode) {\n\t\t\t\t\n\t\t\t\t// if the button was first pressed, start a timeout for the callback, which gets interrupted if the scanbutton gets released\n\t\t\t\tif (!oVars.longPressed){\n\t\t\t\t\toVars.longPressTimer = setTimeout( oOptions.onScanButtonLongPress, oOptions.scanButtonLongPressTime, this);\n\t\t\t\t\toVars.longPressed = true;\n\t\t\t\t}\n\t\n\t\t\t\treturn;\n\t        }\n\t\t\t\n\t\t\tswitch(true){\n\t\t\t\t// If it's not the first character and we encounter a terminating character, trigger scan process\n\t\t\t\tcase (oVars.firstCharTime && oOptions.suffixKeyCodes.indexOf(iKeyCode)!==-1):\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\tbScanFinished=true;\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t// If it's the first character and we encountered one of the starting characters, don't process the scan\t\n\t\t\t\tcase (!oVars.firstCharTime && oOptions.prefixKeyCodes.indexOf(iKeyCode)!==-1):\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\tbScanFinished=false;\n\t\t\t\t\tbreak;\n\t\t\t\t\t\n\t\t\t\t// Otherwise, just add the character to the scan string we're building\t\n\t\t\t\tdefault:\n\t\t\t\t\tvar character = oOptions.keyCodeMapper.call(this, e);\n\t\t\t\t\tif (character === null){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\toVars.accumulatedString += character;\n\t\t\t\t\t\n\t\t\t\t\tif (oOptions.preventDefault) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t\tif (oOptions.stopPropagation) {\n\t\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tbScanFinished=false;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t        \n\t\t\tif(!oVars.firstCharTime){\n\t\t\t\toVars.firstCharTime=Date.now();\n\t\t\t}\n\t\t\t\n\t\t\toVars.lastCharTime=Date.now();\n\t\n\t\t\tif(oVars.testTimer){ \n\t\t\t\tclearTimeout(oVars.testTimer);\n\t\t\t}\n\t\t\t\n\t\t\tif(bScanFinished){\n\t\t\t\tonScan._validateScanCode(this, oVars.accumulatedString);\n\t\t\t\toVars.testTimer=false;\n\t\t\t} else {\n\t\t\t\toVars.testTimer=setTimeout(onScan._validateScanCode, oOptions.timeBeforeScanTest, this, oVars.accumulatedString);\n\t\t\t}\n\t\n\t\t\toOptions.onKeyProcess.call(this, character, e);\n\t\t\treturn;\n\t\t},\n\t\t\n\t\t/**\n\t\t * @private\n\t\t * @param Event e\n\t\t * @return void\n\t\t */\n\t\t_handlePaste: function(e){\n\t\n\t\t\tvar oOptions = this.scannerDetectionData.options;\n\t\t\tvar oVars = this.scannerDetectionData.vars;\n\t\t\tvar sPasteString = (event.clipboardData || window.clipboardData).getData('text');\n\t\t\t\n\t\t\t// if the focus is on an ignored element, abort\n\t\t\tif (onScan._isFocusOnIgnoredElement(this)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\te.preventDefault();\n\n\t\t\tif (oOptions.stopPropagation) {\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t}\n\t\t\t\t\t\t\n\t\t\toOptions.onPaste.call(this, sPasteString, event);\n\t\t\t\n\t\t\toVars.firstCharTime = 0;\n\t\t\toVars.lastCharTime = 0;\n\t\t\t\n\t\t\t// validate the string\n\t\t\tonScan._validateScanCode(this, sPasteString);\n\t\t\treturn;\n\t\t},\n\t\t\n\t\t/**\n\t\t * @private\n\t\t * @param KeyboardEvent e\n\t\t * @return void\n\t\t */\n\t\t_handleKeyUp: function(e){\n\t\t\t// if the focus is on an ignored element, abort\n\t\t\tif (onScan._isFocusOnIgnoredElement(this)){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tvar iKeyCode = onScan._getNormalizedKeyNum(e);\n\t\t\t\n\t\t\t// if hardware key is not being pressed anymore stop the timeout and reset\n\t\t\tif (iKeyCode == this.scannerDetectionData.options.scanButtonKeyCode){\n\t\t\t\tclearTimeout(this.scannerDetectionData.vars.longPressTimer);\n\t\t\t\tthis.scannerDetectionData.vars.longPressed = false;\n\t\t\t}\n\t\t\treturn;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Returns TRUE the scanner is currently in the middle of a scan sequence.\n\t\t * \n\t\t * @param DomElement\n\t\t * @return boolean\n\t\t */\n\t\tisScanInProgressFor: function(oDomElement) {\n\t\t\treturn oDomElement.scannerDetectionData.vars.firstCharTime > 0;\n\t\t},\n\t\t\n\t\t/**\n\t\t * Returns TRUE if onScan is attached to the given DOM element and FALSE otherwise.\n\t\t * \n\t\t * @param DomElement\n\t\t * @return boolean\n\t\t */\n\t\tisAttachedTo: function(oDomElement) {\n\t\t\treturn (oDomElement.scannerDetectionData !== undefined);\n\t\t}\n\t};\n\t\n\treturn onScan;\n})));", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Barcode = function Barcode(data, options) {\n\t_classCallCheck(this, Barcode);\n\n\tthis.data = data;\n\tthis.text = options.text || data;\n\tthis.options = options;\n};\n\nexports.default = Barcode;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.CODE39 = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Barcode2 = require(\"../Barcode.js\");\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding documentation:\n// https://en.wikipedia.org/wiki/Code_39#Encoding\n\nvar CODE39 = function (_Barcode) {\n\t_inherits(CODE39, _Barcode);\n\n\tfunction CODE39(data, options) {\n\t\t_classCallCheck(this, CODE39);\n\n\t\tdata = data.toUpperCase();\n\n\t\t// Calculate mod43 checksum if enabled\n\t\tif (options.mod43) {\n\t\t\tdata += getCharacter(mod43checksum(data));\n\t\t}\n\n\t\treturn _possibleConstructorReturn(this, (CODE39.__proto__ || Object.getPrototypeOf(CODE39)).call(this, data, options));\n\t}\n\n\t_createClass(CODE39, [{\n\t\tkey: \"encode\",\n\t\tvalue: function encode() {\n\t\t\t// First character is always a *\n\t\t\tvar result = getEncoding(\"*\");\n\n\t\t\t// Take every character and add the binary representation to the result\n\t\t\tfor (var i = 0; i < this.data.length; i++) {\n\t\t\t\tresult += getEncoding(this.data[i]) + \"0\";\n\t\t\t}\n\n\t\t\t// Last character is always a *\n\t\t\tresult += getEncoding(\"*\");\n\n\t\t\treturn {\n\t\t\t\tdata: result,\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: \"valid\",\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^[0-9A-Z\\-\\.\\ \\$\\/\\+\\%]+$/) !== -1;\n\t\t}\n\t}]);\n\n\treturn CODE39;\n}(_Barcode3.default);\n\n// All characters. The position in the array is the (checksum) value\n\n\nvar characters = [\"0\", \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\", \"K\", \"L\", \"M\", \"N\", \"O\", \"P\", \"Q\", \"R\", \"S\", \"T\", \"U\", \"V\", \"W\", \"X\", \"Y\", \"Z\", \"-\", \".\", \" \", \"$\", \"/\", \"+\", \"%\", \"*\"];\n\n// The decimal representation of the characters, is converted to the\n// corresponding binary with the getEncoding function\nvar encodings = [20957, 29783, 23639, 30485, 20951, 29813, 23669, 20855, 29789, 23645, 29975, 23831, 30533, 22295, 30149, 24005, 21623, 29981, 23837, 22301, 30023, 23879, 30545, 22343, 30161, 24017, 21959, 30065, 23921, 22385, 29015, 18263, 29141, 17879, 29045, 18293, 17783, 29021, 18269, 17477, 17489, 17681, 20753, 35770];\n\n// Get the binary representation of a character by converting the encodings\n// from decimal to binary\nfunction getEncoding(character) {\n\treturn getBinary(characterValue(character));\n}\n\nfunction getBinary(characterValue) {\n\treturn encodings[characterValue].toString(2);\n}\n\nfunction getCharacter(characterValue) {\n\treturn characters[characterValue];\n}\n\nfunction characterValue(character) {\n\treturn characters.indexOf(character);\n}\n\nfunction mod43checksum(data) {\n\tvar checksum = 0;\n\tfor (var i = 0; i < data.length; i++) {\n\t\tchecksum += characterValue(data[i]);\n\t}\n\n\tchecksum = checksum % 43;\n\treturn checksum;\n}\n\nexports.CODE39 = CODE39;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _SET_BY_CODE;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n// constants for internal usage\nvar SET_A = exports.SET_A = 0;\nvar SET_B = exports.SET_B = 1;\nvar SET_C = exports.SET_C = 2;\n\n// Special characters\nvar SHIFT = exports.SHIFT = 98;\nvar START_A = exports.START_A = 103;\nvar START_B = exports.START_B = 104;\nvar START_C = exports.START_C = 105;\nvar MODULO = exports.MODULO = 103;\nvar STOP = exports.STOP = 106;\nvar FNC1 = exports.FNC1 = 207;\n\n// Get set by start code\nvar SET_BY_CODE = exports.SET_BY_CODE = (_SET_BY_CODE = {}, _defineProperty(_SET_BY_CODE, START_A, SET_A), _defineProperty(_SET_BY_CODE, START_B, SET_B), _defineProperty(_SET_BY_CODE, START_C, SET_C), _SET_BY_CODE);\n\n// Get next set by code\nvar SWAP = exports.SWAP = {\n\t101: SET_A,\n\t100: SET_B,\n\t99: SET_C\n};\n\nvar A_START_CHAR = exports.A_START_CHAR = String.fromCharCode(208); // START_A + 105\nvar B_START_CHAR = exports.B_START_CHAR = String.fromCharCode(209); // START_B + 105\nvar C_START_CHAR = exports.C_START_CHAR = String.fromCharCode(210); // START_C + 105\n\n// 128A (Code Set A)\n// ASCII characters 00 to 95 (0\u20139, A\u2013Z and control codes), special characters, and FNC 1\u20134\nvar A_CHARS = exports.A_CHARS = \"[\\x00-\\x5F\\xC8-\\xCF]\";\n\n// 128B (Code Set B)\n// ASCII characters 32 to 127 (0\u20139, A\u2013Z, a\u2013z), special characters, and FNC 1\u20134\nvar B_CHARS = exports.B_CHARS = \"[\\x20-\\x7F\\xC8-\\xCF]\";\n\n// 128C (Code Set C)\n// 00\u201399 (encodes two digits with a single code point) and FNC1\nvar C_CHARS = exports.C_CHARS = \"(\\xCF*[0-9]{2}\\xCF*)\";\n\n// CODE128 includes 107 symbols:\n// 103 data symbols, 3 start symbols (A, B and C), and 1 stop symbol (the last one)\n// Each symbol consist of three black bars (1) and three white spaces (0).\nvar BARS = exports.BARS = [11011001100, 11001101100, 11001100110, 10010011000, 10010001100, 10001001100, 10011001000, 10011000100, 10001100100, 11001001000, 11001000100, 11000100100, 10110011100, 10011011100, 10011001110, 10111001100, 10011101100, 10011100110, 11001110010, 11001011100, 11001001110, 11011100100, 11001110100, 11101101110, 11101001100, 11100101100, 11100100110, 11101100100, 11100110100, 11100110010, 11011011000, 11011000110, 11000110110, 10100011000, 10001011000, 10001000110, 10110001000, 10001101000, 10001100010, 11010001000, 11000101000, 11000100010, 10110111000, 10110001110, 10001101110, 10111011000, 10111000110, 10001110110, 11101110110, 11010001110, 11000101110, 11011101000, 11011100010, 11011101110, 11101011000, 11101000110, 11100010110, 11101101000, 11101100010, 11100011010, 11101111010, 11001000010, 11110001010, 10100110000, 10100001100, 10010110000, 10010000110, 10000101100, 10000100110, 10110010000, 10110000100, 10011010000, 10011000010, 10000110100, 10000110010, 11000010010, 11001010000, 11110111010, 11000010100, 10001111010, 10100111100, 10010111100, 10010011110, 10111100100, 10011110100, 10011110010, 11110100100, 11110010100, 11110010010, 11011011110, 11011110110, 11110110110, 10101111000, 10100011110, 10001011110, 10111101000, 10111100010, 11110101000, 11110100010, 10111011110, 10111101110, 11101011110, 11110101110, 11010000100, 11010010000, 11010011100, 1100011101011];", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Barcode2 = require('../Barcode.js');\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// This is the master class,\n// it does require the start code to be included in the string\nvar CODE128 = function (_Barcode) {\n\t_inherits(CODE128, _Barcode);\n\n\tfunction CODE128(data, options) {\n\t\t_classCallCheck(this, CODE128);\n\n\t\t// Get array of ascii codes from data\n\t\tvar _this = _possibleConstructorReturn(this, (CODE128.__proto__ || Object.getPrototypeOf(CODE128)).call(this, data.substring(1), options));\n\n\t\t_this.bytes = data.split('').map(function (char) {\n\t\t\treturn char.charCodeAt(0);\n\t\t});\n\t\treturn _this;\n\t}\n\n\t_createClass(CODE128, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\t// ASCII value ranges 0-127, 200-211\n\t\t\treturn (/^[\\x00-\\x7F\\xC8-\\xD3]+$/.test(this.data)\n\t\t\t);\n\t\t}\n\n\t\t// The public encoding function\n\n\t}, {\n\t\tkey: 'encode',\n\t\tvalue: function encode() {\n\t\t\tvar bytes = this.bytes;\n\t\t\t// Remove the start code from the bytes and set its index\n\t\t\tvar startIndex = bytes.shift() - 105;\n\t\t\t// Get start set by index\n\t\t\tvar startSet = _constants.SET_BY_CODE[startIndex];\n\n\t\t\tif (startSet === undefined) {\n\t\t\t\tthrow new RangeError('The encoding does not start with a start character.');\n\t\t\t}\n\n\t\t\tif (this.shouldEncodeAsEan128() === true) {\n\t\t\t\tbytes.unshift(_constants.FNC1);\n\t\t\t}\n\n\t\t\t// Start encode with the right type\n\t\t\tvar encodingResult = CODE128.next(bytes, 1, startSet);\n\n\t\t\treturn {\n\t\t\t\ttext: this.text === this.data ? this.text.replace(/[^\\x20-\\x7E]/g, '') : this.text,\n\t\t\t\tdata:\n\t\t\t\t// Add the start bits\n\t\t\t\tCODE128.getBar(startIndex) +\n\t\t\t\t// Add the encoded bits\n\t\t\t\tencodingResult.result +\n\t\t\t\t// Add the checksum\n\t\t\t\tCODE128.getBar((encodingResult.checksum + startIndex) % _constants.MODULO) +\n\t\t\t\t// Add the end bits\n\t\t\t\tCODE128.getBar(_constants.STOP)\n\t\t\t};\n\t\t}\n\n\t\t// GS1-128/EAN-128\n\n\t}, {\n\t\tkey: 'shouldEncodeAsEan128',\n\t\tvalue: function shouldEncodeAsEan128() {\n\t\t\tvar isEAN128 = this.options.ean128 || false;\n\t\t\tif (typeof isEAN128 === 'string') {\n\t\t\t\tisEAN128 = isEAN128.toLowerCase() === 'true';\n\t\t\t}\n\t\t\treturn isEAN128;\n\t\t}\n\n\t\t// Get a bar symbol by index\n\n\t}], [{\n\t\tkey: 'getBar',\n\t\tvalue: function getBar(index) {\n\t\t\treturn _constants.BARS[index] ? _constants.BARS[index].toString() : '';\n\t\t}\n\n\t\t// Correct an index by a set and shift it from the bytes array\n\n\t}, {\n\t\tkey: 'correctIndex',\n\t\tvalue: function correctIndex(bytes, set) {\n\t\t\tif (set === _constants.SET_A) {\n\t\t\t\tvar charCode = bytes.shift();\n\t\t\t\treturn charCode < 32 ? charCode + 64 : charCode - 32;\n\t\t\t} else if (set === _constants.SET_B) {\n\t\t\t\treturn bytes.shift() - 32;\n\t\t\t} else {\n\t\t\t\treturn (bytes.shift() - 48) * 10 + bytes.shift() - 48;\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'next',\n\t\tvalue: function next(bytes, pos, set) {\n\t\t\tif (!bytes.length) {\n\t\t\t\treturn { result: '', checksum: 0 };\n\t\t\t}\n\n\t\t\tvar nextCode = void 0,\n\t\t\t    index = void 0;\n\n\t\t\t// Special characters\n\t\t\tif (bytes[0] >= 200) {\n\t\t\t\tindex = bytes.shift() - 105;\n\t\t\t\tvar nextSet = _constants.SWAP[index];\n\n\t\t\t\t// Swap to other set\n\t\t\t\tif (nextSet !== undefined) {\n\t\t\t\t\tnextCode = CODE128.next(bytes, pos + 1, nextSet);\n\t\t\t\t}\n\t\t\t\t// Continue on current set but encode a special character\n\t\t\t\telse {\n\t\t\t\t\t\t// Shift\n\t\t\t\t\t\tif ((set === _constants.SET_A || set === _constants.SET_B) && index === _constants.SHIFT) {\n\t\t\t\t\t\t\t// Convert the next character so that is encoded correctly\n\t\t\t\t\t\t\tbytes[0] = set === _constants.SET_A ? bytes[0] > 95 ? bytes[0] - 96 : bytes[0] : bytes[0] < 32 ? bytes[0] + 96 : bytes[0];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnextCode = CODE128.next(bytes, pos + 1, set);\n\t\t\t\t\t}\n\t\t\t}\n\t\t\t// Continue encoding\n\t\t\telse {\n\t\t\t\t\tindex = CODE128.correctIndex(bytes, set);\n\t\t\t\t\tnextCode = CODE128.next(bytes, pos + 1, set);\n\t\t\t\t}\n\n\t\t\t// Get the correct binary encoding and calculate the weight\n\t\t\tvar enc = CODE128.getBar(index);\n\t\t\tvar weight = index * pos;\n\n\t\t\treturn {\n\t\t\t\tresult: enc + nextCode.result,\n\t\t\t\tchecksum: weight + nextCode.checksum\n\t\t\t};\n\t\t}\n\t}]);\n\n\treturn CODE128;\n}(_Barcode3.default);\n\nexports.default = CODE128;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _constants = require('./constants');\n\n// Match Set functions\nvar matchSetALength = function matchSetALength(string) {\n\treturn string.match(new RegExp('^' + _constants.A_CHARS + '*'))[0].length;\n};\nvar matchSetBLength = function matchSetBLength(string) {\n\treturn string.match(new RegExp('^' + _constants.B_CHARS + '*'))[0].length;\n};\nvar matchSetC = function matchSetC(string) {\n\treturn string.match(new RegExp('^' + _constants.C_CHARS + '*'))[0];\n};\n\n// CODE128A or CODE128B\nfunction autoSelectFromAB(string, isA) {\n\tvar ranges = isA ? _constants.A_CHARS : _constants.B_CHARS;\n\tvar untilC = string.match(new RegExp('^(' + ranges + '+?)(([0-9]{2}){2,})([^0-9]|$)'));\n\n\tif (untilC) {\n\t\treturn untilC[1] + String.fromCharCode(204) + autoSelectFromC(string.substring(untilC[1].length));\n\t}\n\n\tvar chars = string.match(new RegExp('^' + ranges + '+'))[0];\n\n\tif (chars.length === string.length) {\n\t\treturn string;\n\t}\n\n\treturn chars + String.fromCharCode(isA ? 205 : 206) + autoSelectFromAB(string.substring(chars.length), !isA);\n}\n\n// CODE128C\nfunction autoSelectFromC(string) {\n\tvar cMatch = matchSetC(string);\n\tvar length = cMatch.length;\n\n\tif (length === string.length) {\n\t\treturn string;\n\t}\n\n\tstring = string.substring(length);\n\n\t// Select A/B depending on the longest match\n\tvar isA = matchSetALength(string) >= matchSetBLength(string);\n\treturn cMatch + String.fromCharCode(isA ? 206 : 205) + autoSelectFromAB(string, isA);\n}\n\n// Detect Code Set (A, B or C) and format the string\n\nexports.default = function (string) {\n\tvar newString = void 0;\n\tvar cLength = matchSetC(string).length;\n\n\t// Select 128C if the string start with enough digits\n\tif (cLength >= 2) {\n\t\tnewString = _constants.C_START_CHAR + autoSelectFromC(string);\n\t} else {\n\t\t// Select A/B depending on the longest match\n\t\tvar isA = matchSetALength(string) > matchSetBLength(string);\n\t\tnewString = (isA ? _constants.A_START_CHAR : _constants.B_START_CHAR) + autoSelectFromAB(string, isA);\n\t}\n\n\treturn newString.replace(/[\\xCD\\xCE]([^])[\\xCD\\xCE]/, // Any sequence between 205 and 206 characters\n\tfunction (match, char) {\n\t\treturn String.fromCharCode(203) + char;\n\t});\n};", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _CODE2 = require('./CODE128');\n\nvar _CODE3 = _interopRequireDefault(_CODE2);\n\nvar _auto = require('./auto');\n\nvar _auto2 = _interopRequireDefault(_auto);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CODE128AUTO = function (_CODE) {\n\t_inherits(CODE128AUTO, _CODE);\n\n\tfunction CODE128AUTO(data, options) {\n\t\t_classCallCheck(this, CODE128AUTO);\n\n\t\t// ASCII value ranges 0-127, 200-211\n\t\tif (/^[\\x00-\\x7F\\xC8-\\xD3]+$/.test(data)) {\n\t\t\tvar _this = _possibleConstructorReturn(this, (CODE128AUTO.__proto__ || Object.getPrototypeOf(CODE128AUTO)).call(this, (0, _auto2.default)(data), options));\n\t\t} else {\n\t\t\tvar _this = _possibleConstructorReturn(this, (CODE128AUTO.__proto__ || Object.getPrototypeOf(CODE128AUTO)).call(this, data, options));\n\t\t}\n\t\treturn _possibleConstructorReturn(_this);\n\t}\n\n\treturn CODE128AUTO;\n}(_CODE3.default);\n\nexports.default = CODE128AUTO;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _CODE2 = require('./CODE128.js');\n\nvar _CODE3 = _interopRequireDefault(_CODE2);\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CODE128A = function (_CODE) {\n\t_inherits(CODE128A, _CODE);\n\n\tfunction CODE128A(string, options) {\n\t\t_classCallCheck(this, CODE128A);\n\n\t\treturn _possibleConstructorReturn(this, (CODE128A.__proto__ || Object.getPrototypeOf(CODE128A)).call(this, _constants.A_START_CHAR + string, options));\n\t}\n\n\t_createClass(CODE128A, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn new RegExp('^' + _constants.A_CHARS + '+$').test(this.data);\n\t\t}\n\t}]);\n\n\treturn CODE128A;\n}(_CODE3.default);\n\nexports.default = CODE128A;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _CODE2 = require('./CODE128.js');\n\nvar _CODE3 = _interopRequireDefault(_CODE2);\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CODE128B = function (_CODE) {\n\t_inherits(CODE128B, _CODE);\n\n\tfunction CODE128B(string, options) {\n\t\t_classCallCheck(this, CODE128B);\n\n\t\treturn _possibleConstructorReturn(this, (CODE128B.__proto__ || Object.getPrototypeOf(CODE128B)).call(this, _constants.B_START_CHAR + string, options));\n\t}\n\n\t_createClass(CODE128B, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn new RegExp('^' + _constants.B_CHARS + '+$').test(this.data);\n\t\t}\n\t}]);\n\n\treturn CODE128B;\n}(_CODE3.default);\n\nexports.default = CODE128B;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _CODE2 = require('./CODE128.js');\n\nvar _CODE3 = _interopRequireDefault(_CODE2);\n\nvar _constants = require('./constants');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar CODE128C = function (_CODE) {\n\t_inherits(CODE128C, _CODE);\n\n\tfunction CODE128C(string, options) {\n\t\t_classCallCheck(this, CODE128C);\n\n\t\treturn _possibleConstructorReturn(this, (CODE128C.__proto__ || Object.getPrototypeOf(CODE128C)).call(this, _constants.C_START_CHAR + string, options));\n\t}\n\n\t_createClass(CODE128C, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn new RegExp('^' + _constants.C_CHARS + '+$').test(this.data);\n\t\t}\n\t}]);\n\n\treturn CODE128C;\n}(_CODE3.default);\n\nexports.default = CODE128C;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CODE128C = exports.CODE128B = exports.CODE128A = exports.CODE128 = undefined;\n\nvar _CODE128_AUTO = require('./CODE128_AUTO.js');\n\nvar _CODE128_AUTO2 = _interopRequireDefault(_CODE128_AUTO);\n\nvar _CODE128A = require('./CODE128A.js');\n\nvar _CODE128A2 = _interopRequireDefault(_CODE128A);\n\nvar _CODE128B = require('./CODE128B.js');\n\nvar _CODE128B2 = _interopRequireDefault(_CODE128B);\n\nvar _CODE128C = require('./CODE128C.js');\n\nvar _CODE128C2 = _interopRequireDefault(_CODE128C);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.CODE128 = _CODE128_AUTO2.default;\nexports.CODE128A = _CODE128A2.default;\nexports.CODE128B = _CODE128B2.default;\nexports.CODE128C = _CODE128C2.default;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n// Standard start end and middle bits\nvar SIDE_BIN = exports.SIDE_BIN = '101';\nvar MIDDLE_BIN = exports.MIDDLE_BIN = '01010';\n\nvar BINARIES = exports.BINARIES = {\n\t'L': [// The L (left) type of encoding\n\t'0001101', '0011001', '0010011', '0111101', '0100011', '0110001', '0101111', '0111011', '0110111', '0001011'],\n\t'G': [// The G type of encoding\n\t'0100111', '0110011', '0011011', '0100001', '0011101', '0111001', '0000101', '0010001', '0001001', '0010111'],\n\t'R': [// The R (right) type of encoding\n\t'1110010', '1100110', '1101100', '1000010', '1011100', '1001110', '1010000', '1000100', '1001000', '1110100'],\n\t'O': [// The O (odd) encoding for UPC-E\n\t'0001101', '0011001', '0010011', '0111101', '0100011', '0110001', '0101111', '0111011', '0110111', '0001011'],\n\t'E': [// The E (even) encoding for UPC-E\n\t'0100111', '0110011', '0011011', '0100001', '0011101', '0111001', '0000101', '0010001', '0001001', '0010111']\n};\n\n// Define the EAN-2 structure\nvar EAN2_STRUCTURE = exports.EAN2_STRUCTURE = ['LL', 'LG', 'GL', 'GG'];\n\n// Define the EAN-5 structure\nvar EAN5_STRUCTURE = exports.EAN5_STRUCTURE = ['GGLLL', 'GLGLL', 'GLLGL', 'GLLLG', 'LGGLL', 'LLGGL', 'LLLGG', 'LGLGL', 'LGLLG', 'LLGLG'];\n\n// Define the EAN-13 structure\nvar EAN13_STRUCTURE = exports.EAN13_STRUCTURE = ['LLLLLL', 'LLGLGG', 'LLGGLG', 'LLGGGL', 'LGLLGG', 'LGGLLG', 'LGGGLL', 'LGLGLG', 'LGLGGL', 'LGGLGL'];", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _constants = require('./constants');\n\n// Encode data string\nvar encode = function encode(data, structure, separator) {\n\tvar encoded = data.split('').map(function (val, idx) {\n\t\treturn _constants.BINARIES[structure[idx]];\n\t}).map(function (val, idx) {\n\t\treturn val ? val[data[idx]] : '';\n\t});\n\n\tif (separator) {\n\t\tvar last = data.length - 1;\n\t\tencoded = encoded.map(function (val, idx) {\n\t\t\treturn idx < last ? val + separator : val;\n\t\t});\n\t}\n\n\treturn encoded.join('');\n};\n\nexports.default = encode;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _constants = require('./constants');\n\nvar _encoder = require('./encoder');\n\nvar _encoder2 = _interopRequireDefault(_encoder);\n\nvar _Barcode2 = require('../Barcode');\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// Base class for EAN8 & EAN13\nvar EAN = function (_Barcode) {\n\t_inherits(EAN, _Barcode);\n\n\tfunction EAN(data, options) {\n\t\t_classCallCheck(this, EAN);\n\n\t\t// Make sure the font is not bigger than the space between the guard bars\n\t\tvar _this = _possibleConstructorReturn(this, (EAN.__proto__ || Object.getPrototypeOf(EAN)).call(this, data, options));\n\n\t\t_this.fontSize = !options.flat && options.fontSize > options.width * 10 ? options.width * 10 : options.fontSize;\n\n\t\t// Make the guard bars go down half the way of the text\n\t\t_this.guardHeight = options.height + _this.fontSize / 2 + options.textMargin;\n\t\treturn _this;\n\t}\n\n\t_createClass(EAN, [{\n\t\tkey: 'encode',\n\t\tvalue: function encode() {\n\t\t\treturn this.options.flat ? this.encodeFlat() : this.encodeGuarded();\n\t\t}\n\t}, {\n\t\tkey: 'leftText',\n\t\tvalue: function leftText(from, to) {\n\t\t\treturn this.text.substr(from, to);\n\t\t}\n\t}, {\n\t\tkey: 'leftEncode',\n\t\tvalue: function leftEncode(data, structure) {\n\t\t\treturn (0, _encoder2.default)(data, structure);\n\t\t}\n\t}, {\n\t\tkey: 'rightText',\n\t\tvalue: function rightText(from, to) {\n\t\t\treturn this.text.substr(from, to);\n\t\t}\n\t}, {\n\t\tkey: 'rightEncode',\n\t\tvalue: function rightEncode(data, structure) {\n\t\t\treturn (0, _encoder2.default)(data, structure);\n\t\t}\n\t}, {\n\t\tkey: 'encodeGuarded',\n\t\tvalue: function encodeGuarded() {\n\t\t\tvar textOptions = { fontSize: this.fontSize };\n\t\t\tvar guardOptions = { height: this.guardHeight };\n\n\t\t\treturn [{ data: _constants.SIDE_BIN, options: guardOptions }, { data: this.leftEncode(), text: this.leftText(), options: textOptions }, { data: _constants.MIDDLE_BIN, options: guardOptions }, { data: this.rightEncode(), text: this.rightText(), options: textOptions }, { data: _constants.SIDE_BIN, options: guardOptions }];\n\t\t}\n\t}, {\n\t\tkey: 'encodeFlat',\n\t\tvalue: function encodeFlat() {\n\t\t\tvar data = [_constants.SIDE_BIN, this.leftEncode(), _constants.MIDDLE_BIN, this.rightEncode(), _constants.SIDE_BIN];\n\n\t\t\treturn {\n\t\t\t\tdata: data.join(''),\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\t}]);\n\n\treturn EAN;\n}(_Barcode3.default);\n\nexports.default = EAN;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _constants = require('./constants');\n\nvar _EAN2 = require('./EAN');\n\nvar _EAN3 = _interopRequireDefault(_EAN2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding documentation:\n// https://en.wikipedia.org/wiki/International_Article_Number_(EAN)#Binary_encoding_of_data_digits_into_EAN-13_barcode\n\n// Calculate the checksum digit\n// https://en.wikipedia.org/wiki/International_Article_Number_(EAN)#Calculation_of_checksum_digit\nvar checksum = function checksum(number) {\n\tvar res = number.substr(0, 12).split('').map(function (n) {\n\t\treturn +n;\n\t}).reduce(function (sum, a, idx) {\n\t\treturn idx % 2 ? sum + a * 3 : sum + a;\n\t}, 0);\n\n\treturn (10 - res % 10) % 10;\n};\n\nvar EAN13 = function (_EAN) {\n\t_inherits(EAN13, _EAN);\n\n\tfunction EAN13(data, options) {\n\t\t_classCallCheck(this, EAN13);\n\n\t\t// Add checksum if it does not exist\n\t\tif (data.search(/^[0-9]{12}$/) !== -1) {\n\t\t\tdata += checksum(data);\n\t\t}\n\n\t\t// Adds a last character to the end of the barcode\n\t\tvar _this = _possibleConstructorReturn(this, (EAN13.__proto__ || Object.getPrototypeOf(EAN13)).call(this, data, options));\n\n\t\t_this.lastChar = options.lastChar;\n\t\treturn _this;\n\t}\n\n\t_createClass(EAN13, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^[0-9]{13}$/) !== -1 && +this.data[12] === checksum(this.data);\n\t\t}\n\t}, {\n\t\tkey: 'leftText',\n\t\tvalue: function leftText() {\n\t\t\treturn _get(EAN13.prototype.__proto__ || Object.getPrototypeOf(EAN13.prototype), 'leftText', this).call(this, 1, 6);\n\t\t}\n\t}, {\n\t\tkey: 'leftEncode',\n\t\tvalue: function leftEncode() {\n\t\t\tvar data = this.data.substr(1, 6);\n\t\t\tvar structure = _constants.EAN13_STRUCTURE[this.data[0]];\n\t\t\treturn _get(EAN13.prototype.__proto__ || Object.getPrototypeOf(EAN13.prototype), 'leftEncode', this).call(this, data, structure);\n\t\t}\n\t}, {\n\t\tkey: 'rightText',\n\t\tvalue: function rightText() {\n\t\t\treturn _get(EAN13.prototype.__proto__ || Object.getPrototypeOf(EAN13.prototype), 'rightText', this).call(this, 7, 6);\n\t\t}\n\t}, {\n\t\tkey: 'rightEncode',\n\t\tvalue: function rightEncode() {\n\t\t\tvar data = this.data.substr(7, 6);\n\t\t\treturn _get(EAN13.prototype.__proto__ || Object.getPrototypeOf(EAN13.prototype), 'rightEncode', this).call(this, data, 'RRRRRR');\n\t\t}\n\n\t\t// The \"standard\" way of printing EAN13 barcodes with guard bars\n\n\t}, {\n\t\tkey: 'encodeGuarded',\n\t\tvalue: function encodeGuarded() {\n\t\t\tvar data = _get(EAN13.prototype.__proto__ || Object.getPrototypeOf(EAN13.prototype), 'encodeGuarded', this).call(this);\n\n\t\t\t// Extend data with left digit & last character\n\t\t\tif (this.options.displayValue) {\n\t\t\t\tdata.unshift({\n\t\t\t\t\tdata: '000000000000',\n\t\t\t\t\ttext: this.text.substr(0, 1),\n\t\t\t\t\toptions: { textAlign: 'left', fontSize: this.fontSize }\n\t\t\t\t});\n\n\t\t\t\tif (this.options.lastChar) {\n\t\t\t\t\tdata.push({\n\t\t\t\t\t\tdata: '00'\n\t\t\t\t\t});\n\t\t\t\t\tdata.push({\n\t\t\t\t\t\tdata: '00000',\n\t\t\t\t\t\ttext: this.options.lastChar,\n\t\t\t\t\t\toptions: { fontSize: this.fontSize }\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t}\n\t}]);\n\n\treturn EAN13;\n}(_EAN3.default);\n\nexports.default = EAN13;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if (\"value\" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };\n\nvar _EAN2 = require('./EAN');\n\nvar _EAN3 = _interopRequireDefault(_EAN2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding documentation:\n// http://www.barcodeisland.com/ean8.phtml\n\n// Calculate the checksum digit\nvar checksum = function checksum(number) {\n\tvar res = number.substr(0, 7).split('').map(function (n) {\n\t\treturn +n;\n\t}).reduce(function (sum, a, idx) {\n\t\treturn idx % 2 ? sum + a : sum + a * 3;\n\t}, 0);\n\n\treturn (10 - res % 10) % 10;\n};\n\nvar EAN8 = function (_EAN) {\n\t_inherits(EAN8, _EAN);\n\n\tfunction EAN8(data, options) {\n\t\t_classCallCheck(this, EAN8);\n\n\t\t// Add checksum if it does not exist\n\t\tif (data.search(/^[0-9]{7}$/) !== -1) {\n\t\t\tdata += checksum(data);\n\t\t}\n\n\t\treturn _possibleConstructorReturn(this, (EAN8.__proto__ || Object.getPrototypeOf(EAN8)).call(this, data, options));\n\t}\n\n\t_createClass(EAN8, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^[0-9]{8}$/) !== -1 && +this.data[7] === checksum(this.data);\n\t\t}\n\t}, {\n\t\tkey: 'leftText',\n\t\tvalue: function leftText() {\n\t\t\treturn _get(EAN8.prototype.__proto__ || Object.getPrototypeOf(EAN8.prototype), 'leftText', this).call(this, 0, 4);\n\t\t}\n\t}, {\n\t\tkey: 'leftEncode',\n\t\tvalue: function leftEncode() {\n\t\t\tvar data = this.data.substr(0, 4);\n\t\t\treturn _get(EAN8.prototype.__proto__ || Object.getPrototypeOf(EAN8.prototype), 'leftEncode', this).call(this, data, 'LLLL');\n\t\t}\n\t}, {\n\t\tkey: 'rightText',\n\t\tvalue: function rightText() {\n\t\t\treturn _get(EAN8.prototype.__proto__ || Object.getPrototypeOf(EAN8.prototype), 'rightText', this).call(this, 4, 4);\n\t\t}\n\t}, {\n\t\tkey: 'rightEncode',\n\t\tvalue: function rightEncode() {\n\t\t\tvar data = this.data.substr(4, 4);\n\t\t\treturn _get(EAN8.prototype.__proto__ || Object.getPrototypeOf(EAN8.prototype), 'rightEncode', this).call(this, data, 'RRRR');\n\t\t}\n\t}]);\n\n\treturn EAN8;\n}(_EAN3.default);\n\nexports.default = EAN8;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _constants = require('./constants');\n\nvar _encoder = require('./encoder');\n\nvar _encoder2 = _interopRequireDefault(_encoder);\n\nvar _Barcode2 = require('../Barcode');\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding documentation:\n// https://en.wikipedia.org/wiki/EAN_5#Encoding\n\nvar checksum = function checksum(data) {\n\tvar result = data.split('').map(function (n) {\n\t\treturn +n;\n\t}).reduce(function (sum, a, idx) {\n\t\treturn idx % 2 ? sum + a * 9 : sum + a * 3;\n\t}, 0);\n\treturn result % 10;\n};\n\nvar EAN5 = function (_Barcode) {\n\t_inherits(EAN5, _Barcode);\n\n\tfunction EAN5(data, options) {\n\t\t_classCallCheck(this, EAN5);\n\n\t\treturn _possibleConstructorReturn(this, (EAN5.__proto__ || Object.getPrototypeOf(EAN5)).call(this, data, options));\n\t}\n\n\t_createClass(EAN5, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^[0-9]{5}$/) !== -1;\n\t\t}\n\t}, {\n\t\tkey: 'encode',\n\t\tvalue: function encode() {\n\t\t\tvar structure = _constants.EAN5_STRUCTURE[checksum(this.data)];\n\t\t\treturn {\n\t\t\t\tdata: '1011' + (0, _encoder2.default)(this.data, structure, '01'),\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\t}]);\n\n\treturn EAN5;\n}(_Barcode3.default);\n\nexports.default = EAN5;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _constants = require('./constants');\n\nvar _encoder = require('./encoder');\n\nvar _encoder2 = _interopRequireDefault(_encoder);\n\nvar _Barcode2 = require('../Barcode');\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding documentation:\n// https://en.wikipedia.org/wiki/EAN_2#Encoding\n\nvar EAN2 = function (_Barcode) {\n\t_inherits(EAN2, _Barcode);\n\n\tfunction EAN2(data, options) {\n\t\t_classCallCheck(this, EAN2);\n\n\t\treturn _possibleConstructorReturn(this, (EAN2.__proto__ || Object.getPrototypeOf(EAN2)).call(this, data, options));\n\t}\n\n\t_createClass(EAN2, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^[0-9]{2}$/) !== -1;\n\t\t}\n\t}, {\n\t\tkey: 'encode',\n\t\tvalue: function encode() {\n\t\t\t// Choose the structure based on the number mod 4\n\t\t\tvar structure = _constants.EAN2_STRUCTURE[parseInt(this.data) % 4];\n\t\t\treturn {\n\t\t\t\t// Start bits + Encode the two digits with 01 in between\n\t\t\t\tdata: '1011' + (0, _encoder2.default)(this.data, structure, '01'),\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\t}]);\n\n\treturn EAN2;\n}(_Barcode3.default);\n\nexports.default = EAN2;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nexports.checksum = checksum;\n\nvar _encoder = require(\"./encoder\");\n\nvar _encoder2 = _interopRequireDefault(_encoder);\n\nvar _Barcode2 = require(\"../Barcode.js\");\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding documentation:\n// https://en.wikipedia.org/wiki/Universal_Product_Code#Encoding\n\nvar UPC = function (_Barcode) {\n\t_inherits(UPC, _Barcode);\n\n\tfunction UPC(data, options) {\n\t\t_classCallCheck(this, UPC);\n\n\t\t// Add checksum if it does not exist\n\t\tif (data.search(/^[0-9]{11}$/) !== -1) {\n\t\t\tdata += checksum(data);\n\t\t}\n\n\t\tvar _this = _possibleConstructorReturn(this, (UPC.__proto__ || Object.getPrototypeOf(UPC)).call(this, data, options));\n\n\t\t_this.displayValue = options.displayValue;\n\n\t\t// Make sure the font is not bigger than the space between the guard bars\n\t\tif (options.fontSize > options.width * 10) {\n\t\t\t_this.fontSize = options.width * 10;\n\t\t} else {\n\t\t\t_this.fontSize = options.fontSize;\n\t\t}\n\n\t\t// Make the guard bars go down half the way of the text\n\t\t_this.guardHeight = options.height + _this.fontSize / 2 + options.textMargin;\n\t\treturn _this;\n\t}\n\n\t_createClass(UPC, [{\n\t\tkey: \"valid\",\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^[0-9]{12}$/) !== -1 && this.data[11] == checksum(this.data);\n\t\t}\n\t}, {\n\t\tkey: \"encode\",\n\t\tvalue: function encode() {\n\t\t\tif (this.options.flat) {\n\t\t\t\treturn this.flatEncoding();\n\t\t\t} else {\n\t\t\t\treturn this.guardedEncoding();\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"flatEncoding\",\n\t\tvalue: function flatEncoding() {\n\t\t\tvar result = \"\";\n\n\t\t\tresult += \"101\";\n\t\t\tresult += (0, _encoder2.default)(this.data.substr(0, 6), \"LLLLLL\");\n\t\t\tresult += \"01010\";\n\t\t\tresult += (0, _encoder2.default)(this.data.substr(6, 6), \"RRRRRR\");\n\t\t\tresult += \"101\";\n\n\t\t\treturn {\n\t\t\t\tdata: result,\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: \"guardedEncoding\",\n\t\tvalue: function guardedEncoding() {\n\t\t\tvar result = [];\n\n\t\t\t// Add the first digit\n\t\t\tif (this.displayValue) {\n\t\t\t\tresult.push({\n\t\t\t\t\tdata: \"00000000\",\n\t\t\t\t\ttext: this.text.substr(0, 1),\n\t\t\t\t\toptions: { textAlign: \"left\", fontSize: this.fontSize }\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Add the guard bars\n\t\t\tresult.push({\n\t\t\t\tdata: \"101\" + (0, _encoder2.default)(this.data[0], \"L\"),\n\t\t\t\toptions: { height: this.guardHeight }\n\t\t\t});\n\n\t\t\t// Add the left side\n\t\t\tresult.push({\n\t\t\t\tdata: (0, _encoder2.default)(this.data.substr(1, 5), \"LLLLL\"),\n\t\t\t\ttext: this.text.substr(1, 5),\n\t\t\t\toptions: { fontSize: this.fontSize }\n\t\t\t});\n\n\t\t\t// Add the middle bits\n\t\t\tresult.push({\n\t\t\t\tdata: \"01010\",\n\t\t\t\toptions: { height: this.guardHeight }\n\t\t\t});\n\n\t\t\t// Add the right side\n\t\t\tresult.push({\n\t\t\t\tdata: (0, _encoder2.default)(this.data.substr(6, 5), \"RRRRR\"),\n\t\t\t\ttext: this.text.substr(6, 5),\n\t\t\t\toptions: { fontSize: this.fontSize }\n\t\t\t});\n\n\t\t\t// Add the end bits\n\t\t\tresult.push({\n\t\t\t\tdata: (0, _encoder2.default)(this.data[11], \"R\") + \"101\",\n\t\t\t\toptions: { height: this.guardHeight }\n\t\t\t});\n\n\t\t\t// Add the last digit\n\t\t\tif (this.displayValue) {\n\t\t\t\tresult.push({\n\t\t\t\t\tdata: \"00000000\",\n\t\t\t\t\ttext: this.text.substr(11, 1),\n\t\t\t\t\toptions: { textAlign: \"right\", fontSize: this.fontSize }\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\t}]);\n\n\treturn UPC;\n}(_Barcode3.default);\n\n// Calulate the checksum digit\n// https://en.wikipedia.org/wiki/International_Article_Number_(EAN)#Calculation_of_checksum_digit\n\n\nfunction checksum(number) {\n\tvar result = 0;\n\n\tvar i;\n\tfor (i = 1; i < 11; i += 2) {\n\t\tresult += parseInt(number[i]);\n\t}\n\tfor (i = 0; i < 11; i += 2) {\n\t\tresult += parseInt(number[i]) * 3;\n\t}\n\n\treturn (10 - result % 10) % 10;\n}\n\nexports.default = UPC;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _encoder = require('./encoder');\n\nvar _encoder2 = _interopRequireDefault(_encoder);\n\nvar _Barcode2 = require('../Barcode.js');\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nvar _UPC = require('./UPC.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding documentation:\n// https://en.wikipedia.org/wiki/Universal_Product_Code#Encoding\n//\n// UPC-E documentation:\n// https://en.wikipedia.org/wiki/Universal_Product_Code#UPC-E\n\nvar EXPANSIONS = [\"XX00000XXX\", \"XX10000XXX\", \"XX20000XXX\", \"XXX00000XX\", \"XXXX00000X\", \"XXXXX00005\", \"XXXXX00006\", \"XXXXX00007\", \"XXXXX00008\", \"XXXXX00009\"];\n\nvar PARITIES = [[\"EEEOOO\", \"OOOEEE\"], [\"EEOEOO\", \"OOEOEE\"], [\"EEOOEO\", \"OOEEOE\"], [\"EEOOOE\", \"OOEEEO\"], [\"EOEEOO\", \"OEOOEE\"], [\"EOOEEO\", \"OEEOOE\"], [\"EOOOEE\", \"OEEEOO\"], [\"EOEOEO\", \"OEOEOE\"], [\"EOEOOE\", \"OEOEEO\"], [\"EOOEOE\", \"OEEOEO\"]];\n\nvar UPCE = function (_Barcode) {\n\t_inherits(UPCE, _Barcode);\n\n\tfunction UPCE(data, options) {\n\t\t_classCallCheck(this, UPCE);\n\n\t\tvar _this = _possibleConstructorReturn(this, (UPCE.__proto__ || Object.getPrototypeOf(UPCE)).call(this, data, options));\n\t\t// Code may be 6 or 8 digits;\n\t\t// A 7 digit code is ambiguous as to whether the extra digit\n\t\t// is a UPC-A check or number system digit.\n\n\n\t\t_this.isValid = false;\n\t\tif (data.search(/^[0-9]{6}$/) !== -1) {\n\t\t\t_this.middleDigits = data;\n\t\t\t_this.upcA = expandToUPCA(data, \"0\");\n\t\t\t_this.text = options.text || '' + _this.upcA[0] + data + _this.upcA[_this.upcA.length - 1];\n\t\t\t_this.isValid = true;\n\t\t} else if (data.search(/^[01][0-9]{7}$/) !== -1) {\n\t\t\t_this.middleDigits = data.substring(1, data.length - 1);\n\t\t\t_this.upcA = expandToUPCA(_this.middleDigits, data[0]);\n\n\t\t\tif (_this.upcA[_this.upcA.length - 1] === data[data.length - 1]) {\n\t\t\t\t_this.isValid = true;\n\t\t\t} else {\n\t\t\t\t// checksum mismatch\n\t\t\t\treturn _possibleConstructorReturn(_this);\n\t\t\t}\n\t\t} else {\n\t\t\treturn _possibleConstructorReturn(_this);\n\t\t}\n\n\t\t_this.displayValue = options.displayValue;\n\n\t\t// Make sure the font is not bigger than the space between the guard bars\n\t\tif (options.fontSize > options.width * 10) {\n\t\t\t_this.fontSize = options.width * 10;\n\t\t} else {\n\t\t\t_this.fontSize = options.fontSize;\n\t\t}\n\n\t\t// Make the guard bars go down half the way of the text\n\t\t_this.guardHeight = options.height + _this.fontSize / 2 + options.textMargin;\n\t\treturn _this;\n\t}\n\n\t_createClass(UPCE, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn this.isValid;\n\t\t}\n\t}, {\n\t\tkey: 'encode',\n\t\tvalue: function encode() {\n\t\t\tif (this.options.flat) {\n\t\t\t\treturn this.flatEncoding();\n\t\t\t} else {\n\t\t\t\treturn this.guardedEncoding();\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: 'flatEncoding',\n\t\tvalue: function flatEncoding() {\n\t\t\tvar result = \"\";\n\n\t\t\tresult += \"101\";\n\t\t\tresult += this.encodeMiddleDigits();\n\t\t\tresult += \"010101\";\n\n\t\t\treturn {\n\t\t\t\tdata: result,\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: 'guardedEncoding',\n\t\tvalue: function guardedEncoding() {\n\t\t\tvar result = [];\n\n\t\t\t// Add the UPC-A number system digit beneath the quiet zone\n\t\t\tif (this.displayValue) {\n\t\t\t\tresult.push({\n\t\t\t\t\tdata: \"00000000\",\n\t\t\t\t\ttext: this.text[0],\n\t\t\t\t\toptions: { textAlign: \"left\", fontSize: this.fontSize }\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Add the guard bars\n\t\t\tresult.push({\n\t\t\t\tdata: \"101\",\n\t\t\t\toptions: { height: this.guardHeight }\n\t\t\t});\n\n\t\t\t// Add the 6 UPC-E digits\n\t\t\tresult.push({\n\t\t\t\tdata: this.encodeMiddleDigits(),\n\t\t\t\ttext: this.text.substring(1, 7),\n\t\t\t\toptions: { fontSize: this.fontSize }\n\t\t\t});\n\n\t\t\t// Add the end bits\n\t\t\tresult.push({\n\t\t\t\tdata: \"010101\",\n\t\t\t\toptions: { height: this.guardHeight }\n\t\t\t});\n\n\t\t\t// Add the UPC-A check digit beneath the quiet zone\n\t\t\tif (this.displayValue) {\n\t\t\t\tresult.push({\n\t\t\t\t\tdata: \"00000000\",\n\t\t\t\t\ttext: this.text[7],\n\t\t\t\t\toptions: { textAlign: \"right\", fontSize: this.fontSize }\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\t}, {\n\t\tkey: 'encodeMiddleDigits',\n\t\tvalue: function encodeMiddleDigits() {\n\t\t\tvar numberSystem = this.upcA[0];\n\t\t\tvar checkDigit = this.upcA[this.upcA.length - 1];\n\t\t\tvar parity = PARITIES[parseInt(checkDigit)][parseInt(numberSystem)];\n\t\t\treturn (0, _encoder2.default)(this.middleDigits, parity);\n\t\t}\n\t}]);\n\n\treturn UPCE;\n}(_Barcode3.default);\n\nfunction expandToUPCA(middleDigits, numberSystem) {\n\tvar lastUpcE = parseInt(middleDigits[middleDigits.length - 1]);\n\tvar expansion = EXPANSIONS[lastUpcE];\n\n\tvar result = \"\";\n\tvar digitIndex = 0;\n\tfor (var i = 0; i < expansion.length; i++) {\n\t\tvar c = expansion[i];\n\t\tif (c === 'X') {\n\t\t\tresult += middleDigits[digitIndex++];\n\t\t} else {\n\t\t\tresult += c;\n\t\t}\n\t}\n\n\tresult = '' + numberSystem + result;\n\treturn '' + result + (0, _UPC.checksum)(result);\n}\n\nexports.default = UPCE;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UPCE = exports.UPC = exports.EAN2 = exports.EAN5 = exports.EAN8 = exports.EAN13 = undefined;\n\nvar _EAN = require('./EAN13.js');\n\nvar _EAN2 = _interopRequireDefault(_EAN);\n\nvar _EAN3 = require('./EAN8.js');\n\nvar _EAN4 = _interopRequireDefault(_EAN3);\n\nvar _EAN5 = require('./EAN5.js');\n\nvar _EAN6 = _interopRequireDefault(_EAN5);\n\nvar _EAN7 = require('./EAN2.js');\n\nvar _EAN8 = _interopRequireDefault(_EAN7);\n\nvar _UPC = require('./UPC.js');\n\nvar _UPC2 = _interopRequireDefault(_UPC);\n\nvar _UPCE = require('./UPCE.js');\n\nvar _UPCE2 = _interopRequireDefault(_UPCE);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.EAN13 = _EAN2.default;\nexports.EAN8 = _EAN4.default;\nexports.EAN5 = _EAN6.default;\nexports.EAN2 = _EAN8.default;\nexports.UPC = _UPC2.default;\nexports.UPCE = _UPCE2.default;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nvar START_BIN = exports.START_BIN = '1010';\nvar END_BIN = exports.END_BIN = '11101';\n\nvar BINARIES = exports.BINARIES = ['00110', '10001', '01001', '11000', '00101', '10100', '01100', '00011', '10010', '01010'];", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _constants = require('./constants');\n\nvar _Barcode2 = require('../Barcode');\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ITF = function (_Barcode) {\n\t_inherits(ITF, _Barcode);\n\n\tfunction ITF() {\n\t\t_classCallCheck(this, ITF);\n\n\t\treturn _possibleConstructorReturn(this, (ITF.__proto__ || Object.getPrototypeOf(ITF)).apply(this, arguments));\n\t}\n\n\t_createClass(ITF, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^([0-9]{2})+$/) !== -1;\n\t\t}\n\t}, {\n\t\tkey: 'encode',\n\t\tvalue: function encode() {\n\t\t\tvar _this2 = this;\n\n\t\t\t// Calculate all the digit pairs\n\t\t\tvar encoded = this.data.match(/.{2}/g).map(function (pair) {\n\t\t\t\treturn _this2.encodePair(pair);\n\t\t\t}).join('');\n\n\t\t\treturn {\n\t\t\t\tdata: _constants.START_BIN + encoded + _constants.END_BIN,\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\n\t\t// Calculate the data of a number pair\n\n\t}, {\n\t\tkey: 'encodePair',\n\t\tvalue: function encodePair(pair) {\n\t\t\tvar second = _constants.BINARIES[pair[1]];\n\n\t\t\treturn _constants.BINARIES[pair[0]].split('').map(function (first, idx) {\n\t\t\t\treturn (first === '1' ? '111' : '1') + (second[idx] === '1' ? '000' : '0');\n\t\t\t}).join('');\n\t\t}\n\t}]);\n\n\treturn ITF;\n}(_Barcode3.default);\n\nexports.default = ITF;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _ITF2 = require('./ITF');\n\nvar _ITF3 = _interopRequireDefault(_ITF2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// Calculate the checksum digit\nvar checksum = function checksum(data) {\n\tvar res = data.substr(0, 13).split('').map(function (num) {\n\t\treturn parseInt(num, 10);\n\t}).reduce(function (sum, n, idx) {\n\t\treturn sum + n * (3 - idx % 2 * 2);\n\t}, 0);\n\n\treturn Math.ceil(res / 10) * 10 - res;\n};\n\nvar ITF14 = function (_ITF) {\n\t_inherits(ITF14, _ITF);\n\n\tfunction ITF14(data, options) {\n\t\t_classCallCheck(this, ITF14);\n\n\t\t// Add checksum if it does not exist\n\t\tif (data.search(/^[0-9]{13}$/) !== -1) {\n\t\t\tdata += checksum(data);\n\t\t}\n\t\treturn _possibleConstructorReturn(this, (ITF14.__proto__ || Object.getPrototypeOf(ITF14)).call(this, data, options));\n\t}\n\n\t_createClass(ITF14, [{\n\t\tkey: 'valid',\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^[0-9]{14}$/) !== -1 && +this.data[13] === checksum(this.data);\n\t\t}\n\t}]);\n\n\treturn ITF14;\n}(_ITF3.default);\n\nexports.default = ITF14;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ITF14 = exports.ITF = undefined;\n\nvar _ITF = require('./ITF');\n\nvar _ITF2 = _interopRequireDefault(_ITF);\n\nvar _ITF3 = require('./ITF14');\n\nvar _ITF4 = _interopRequireDefault(_ITF3);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.ITF = _ITF2.default;\nexports.ITF14 = _ITF4.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Barcode2 = require(\"../Barcode.js\");\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding documentation\n// https://en.wikipedia.org/wiki/MSI_Barcode#Character_set_and_binary_lookup\n\nvar MSI = function (_Barcode) {\n\t_inherits(MSI, _Barcode);\n\n\tfunction MSI(data, options) {\n\t\t_classCallCheck(this, MSI);\n\n\t\treturn _possibleConstructorReturn(this, (MSI.__proto__ || Object.getPrototypeOf(MSI)).call(this, data, options));\n\t}\n\n\t_createClass(MSI, [{\n\t\tkey: \"encode\",\n\t\tvalue: function encode() {\n\t\t\t// Start bits\n\t\t\tvar ret = \"110\";\n\n\t\t\tfor (var i = 0; i < this.data.length; i++) {\n\t\t\t\t// Convert the character to binary (always 4 binary digits)\n\t\t\t\tvar digit = parseInt(this.data[i]);\n\t\t\t\tvar bin = digit.toString(2);\n\t\t\t\tbin = addZeroes(bin, 4 - bin.length);\n\n\t\t\t\t// Add 100 for every zero and 110 for every 1\n\t\t\t\tfor (var b = 0; b < bin.length; b++) {\n\t\t\t\t\tret += bin[b] == \"0\" ? \"100\" : \"110\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// End bits\n\t\t\tret += \"1001\";\n\n\t\t\treturn {\n\t\t\t\tdata: ret,\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: \"valid\",\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^[0-9]+$/) !== -1;\n\t\t}\n\t}]);\n\n\treturn MSI;\n}(_Barcode3.default);\n\nfunction addZeroes(number, n) {\n\tfor (var i = 0; i < n; i++) {\n\t\tnumber = \"0\" + number;\n\t}\n\treturn number;\n}\n\nexports.default = MSI;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.mod10 = mod10;\nexports.mod11 = mod11;\nfunction mod10(number) {\n\tvar sum = 0;\n\tfor (var i = 0; i < number.length; i++) {\n\t\tvar n = parseInt(number[i]);\n\t\tif ((i + number.length) % 2 === 0) {\n\t\t\tsum += n;\n\t\t} else {\n\t\t\tsum += n * 2 % 10 + Math.floor(n * 2 / 10);\n\t\t}\n\t}\n\treturn (10 - sum % 10) % 10;\n}\n\nfunction mod11(number) {\n\tvar sum = 0;\n\tvar weights = [2, 3, 4, 5, 6, 7];\n\tfor (var i = 0; i < number.length; i++) {\n\t\tvar n = parseInt(number[number.length - 1 - i]);\n\t\tsum += weights[i % weights.length] * n;\n\t}\n\treturn (11 - sum % 11) % 11;\n}", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _MSI2 = require('./MSI.js');\n\nvar _MSI3 = _interopRequireDefault(_MSI2);\n\nvar _checksums = require('./checksums.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar MSI10 = function (_MSI) {\n\t_inherits(MSI10, _MSI);\n\n\tfunction MSI10(data, options) {\n\t\t_classCallCheck(this, MSI10);\n\n\t\treturn _possibleConstructorReturn(this, (MSI10.__proto__ || Object.getPrototypeOf(MSI10)).call(this, data + (0, _checksums.mod10)(data), options));\n\t}\n\n\treturn MSI10;\n}(_MSI3.default);\n\nexports.default = MSI10;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _MSI2 = require('./MSI.js');\n\nvar _MSI3 = _interopRequireDefault(_MSI2);\n\nvar _checksums = require('./checksums.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar MSI11 = function (_MSI) {\n\t_inherits(MSI11, _MSI);\n\n\tfunction MSI11(data, options) {\n\t\t_classCallCheck(this, MSI11);\n\n\t\treturn _possibleConstructorReturn(this, (MSI11.__proto__ || Object.getPrototypeOf(MSI11)).call(this, data + (0, _checksums.mod11)(data), options));\n\t}\n\n\treturn MSI11;\n}(_MSI3.default);\n\nexports.default = MSI11;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _MSI2 = require('./MSI.js');\n\nvar _MSI3 = _interopRequireDefault(_MSI2);\n\nvar _checksums = require('./checksums.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar MSI1010 = function (_MSI) {\n\t_inherits(MSI1010, _MSI);\n\n\tfunction MSI1010(data, options) {\n\t\t_classCallCheck(this, MSI1010);\n\n\t\tdata += (0, _checksums.mod10)(data);\n\t\tdata += (0, _checksums.mod10)(data);\n\t\treturn _possibleConstructorReturn(this, (MSI1010.__proto__ || Object.getPrototypeOf(MSI1010)).call(this, data, options));\n\t}\n\n\treturn MSI1010;\n}(_MSI3.default);\n\nexports.default = MSI1010;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _MSI2 = require('./MSI.js');\n\nvar _MSI3 = _interopRequireDefault(_MSI2);\n\nvar _checksums = require('./checksums.js');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar MSI1110 = function (_MSI) {\n\t_inherits(MSI1110, _MSI);\n\n\tfunction MSI1110(data, options) {\n\t\t_classCallCheck(this, MSI1110);\n\n\t\tdata += (0, _checksums.mod11)(data);\n\t\tdata += (0, _checksums.mod10)(data);\n\t\treturn _possibleConstructorReturn(this, (MSI1110.__proto__ || Object.getPrototypeOf(MSI1110)).call(this, data, options));\n\t}\n\n\treturn MSI1110;\n}(_MSI3.default);\n\nexports.default = MSI1110;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.MSI1110 = exports.MSI1010 = exports.MSI11 = exports.MSI10 = exports.MSI = undefined;\n\nvar _MSI = require('./MSI.js');\n\nvar _MSI2 = _interopRequireDefault(_MSI);\n\nvar _MSI3 = require('./MSI10.js');\n\nvar _MSI4 = _interopRequireDefault(_MSI3);\n\nvar _MSI5 = require('./MSI11.js');\n\nvar _MSI6 = _interopRequireDefault(_MSI5);\n\nvar _MSI7 = require('./MSI1010.js');\n\nvar _MSI8 = _interopRequireDefault(_MSI7);\n\nvar _MSI9 = require('./MSI1110.js');\n\nvar _MSI10 = _interopRequireDefault(_MSI9);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.MSI = _MSI2.default;\nexports.MSI10 = _MSI4.default;\nexports.MSI11 = _MSI6.default;\nexports.MSI1010 = _MSI8.default;\nexports.MSI1110 = _MSI10.default;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.pharmacode = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Barcode2 = require(\"../Barcode.js\");\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding documentation\n// http://www.gomaro.ch/ftproot/Laetus_PHARMA-CODE.pdf\n\nvar pharmacode = function (_Barcode) {\n\t_inherits(pharmacode, _Barcode);\n\n\tfunction pharmacode(data, options) {\n\t\t_classCallCheck(this, pharmacode);\n\n\t\tvar _this = _possibleConstructorReturn(this, (pharmacode.__proto__ || Object.getPrototypeOf(pharmacode)).call(this, data, options));\n\n\t\t_this.number = parseInt(data, 10);\n\t\treturn _this;\n\t}\n\n\t_createClass(pharmacode, [{\n\t\tkey: \"encode\",\n\t\tvalue: function encode() {\n\t\t\tvar z = this.number;\n\t\t\tvar result = \"\";\n\n\t\t\t// http://i.imgur.com/RMm4UDJ.png\n\t\t\t// (source: http://www.gomaro.ch/ftproot/Laetus_PHARMA-CODE.pdf, page: 34)\n\t\t\twhile (!isNaN(z) && z != 0) {\n\t\t\t\tif (z % 2 === 0) {\n\t\t\t\t\t// Even\n\t\t\t\t\tresult = \"11100\" + result;\n\t\t\t\t\tz = (z - 2) / 2;\n\t\t\t\t} else {\n\t\t\t\t\t// Odd\n\t\t\t\t\tresult = \"100\" + result;\n\t\t\t\t\tz = (z - 1) / 2;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove the two last zeroes\n\t\t\tresult = result.slice(0, -2);\n\n\t\t\treturn {\n\t\t\t\tdata: result,\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: \"valid\",\n\t\tvalue: function valid() {\n\t\t\treturn this.number >= 3 && this.number <= 131070;\n\t\t}\n\t}]);\n\n\treturn pharmacode;\n}(_Barcode3.default);\n\nexports.pharmacode = pharmacode;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.codabar = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Barcode2 = require(\"../Barcode.js\");\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } // Encoding specification:\n// http://www.barcodeisland.com/codabar.phtml\n\nvar codabar = function (_Barcode) {\n\t_inherits(codabar, _Barcode);\n\n\tfunction codabar(data, options) {\n\t\t_classCallCheck(this, codabar);\n\n\t\tif (data.search(/^[0-9\\-\\$\\:\\.\\+\\/]+$/) === 0) {\n\t\t\tdata = \"A\" + data + \"A\";\n\t\t}\n\n\t\tvar _this = _possibleConstructorReturn(this, (codabar.__proto__ || Object.getPrototypeOf(codabar)).call(this, data.toUpperCase(), options));\n\n\t\t_this.text = _this.options.text || _this.text.replace(/[A-D]/g, '');\n\t\treturn _this;\n\t}\n\n\t_createClass(codabar, [{\n\t\tkey: \"valid\",\n\t\tvalue: function valid() {\n\t\t\treturn this.data.search(/^[A-D][0-9\\-\\$\\:\\.\\+\\/]+[A-D]$/) !== -1;\n\t\t}\n\t}, {\n\t\tkey: \"encode\",\n\t\tvalue: function encode() {\n\t\t\tvar result = [];\n\t\t\tvar encodings = this.getEncodings();\n\t\t\tfor (var i = 0; i < this.data.length; i++) {\n\t\t\t\tresult.push(encodings[this.data.charAt(i)]);\n\t\t\t\t// for all characters except the last, append a narrow-space (\"0\")\n\t\t\t\tif (i !== this.data.length - 1) {\n\t\t\t\t\tresult.push(\"0\");\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\ttext: this.text,\n\t\t\t\tdata: result.join('')\n\t\t\t};\n\t\t}\n\t}, {\n\t\tkey: \"getEncodings\",\n\t\tvalue: function getEncodings() {\n\t\t\treturn {\n\t\t\t\t\"0\": \"101010011\",\n\t\t\t\t\"1\": \"101011001\",\n\t\t\t\t\"2\": \"101001011\",\n\t\t\t\t\"3\": \"110010101\",\n\t\t\t\t\"4\": \"101101001\",\n\t\t\t\t\"5\": \"110101001\",\n\t\t\t\t\"6\": \"100101011\",\n\t\t\t\t\"7\": \"100101101\",\n\t\t\t\t\"8\": \"100110101\",\n\t\t\t\t\"9\": \"110100101\",\n\t\t\t\t\"-\": \"101001101\",\n\t\t\t\t\"$\": \"101100101\",\n\t\t\t\t\":\": \"1101011011\",\n\t\t\t\t\"/\": \"1101101011\",\n\t\t\t\t\".\": \"1101101101\",\n\t\t\t\t\"+\": \"1011011011\",\n\t\t\t\t\"A\": \"1011001001\",\n\t\t\t\t\"B\": \"1001001011\",\n\t\t\t\t\"C\": \"1010010011\",\n\t\t\t\t\"D\": \"1010011001\"\n\t\t\t};\n\t\t}\n\t}]);\n\n\treturn codabar;\n}(_Barcode3.default);\n\nexports.codabar = codabar;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.GenericBarcode = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _Barcode2 = require(\"../Barcode.js\");\n\nvar _Barcode3 = _interopRequireDefault(_Barcode2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar GenericBarcode = function (_Barcode) {\n\t_inherits(GenericBarcode, _Barcode);\n\n\tfunction GenericBarcode(data, options) {\n\t\t_classCallCheck(this, GenericBarcode);\n\n\t\treturn _possibleConstructorReturn(this, (GenericBarcode.__proto__ || Object.getPrototypeOf(GenericBarcode)).call(this, data, options)); // Sets this.data and this.text\n\t}\n\n\t// Return the corresponding binary numbers for the data provided\n\n\n\t_createClass(GenericBarcode, [{\n\t\tkey: \"encode\",\n\t\tvalue: function encode() {\n\t\t\treturn {\n\t\t\t\tdata: \"10101010101010101010101010101010101010101\",\n\t\t\t\ttext: this.text\n\t\t\t};\n\t\t}\n\n\t\t// Resturn true/false if the string provided is valid for this encoder\n\n\t}, {\n\t\tkey: \"valid\",\n\t\tvalue: function valid() {\n\t\t\treturn true;\n\t\t}\n\t}]);\n\n\treturn GenericBarcode;\n}(_Barcode3.default);\n\nexports.GenericBarcode = GenericBarcode;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _CODE = require('./CODE39/');\n\nvar _CODE2 = require('./CODE128/');\n\nvar _EAN_UPC = require('./EAN_UPC/');\n\nvar _ITF = require('./ITF/');\n\nvar _MSI = require('./MSI/');\n\nvar _pharmacode = require('./pharmacode/');\n\nvar _codabar = require('./codabar');\n\nvar _GenericBarcode = require('./GenericBarcode/');\n\nexports.default = {\n\tCODE39: _CODE.CODE39,\n\tCODE128: _CODE2.CODE128, CODE128A: _CODE2.CODE128A, CODE128B: _CODE2.CODE128B, CODE128C: _CODE2.CODE128C,\n\tEAN13: _EAN_UPC.EAN13, EAN8: _EAN_UPC.EAN8, EAN5: _EAN_UPC.EAN5, EAN2: _EAN_UPC.EAN2, UPC: _EAN_UPC.UPC, UPCE: _EAN_UPC.UPCE,\n\tITF14: _ITF.ITF14,\n\tITF: _ITF.ITF,\n\tMSI: _MSI.MSI, MSI10: _MSI.MSI10, MSI11: _MSI.MSI11, MSI1010: _MSI.MSI1010, MSI1110: _MSI.MSI1110,\n\tpharmacode: _pharmacode.pharmacode,\n\tcodabar: _codabar.codabar,\n\tGenericBarcode: _GenericBarcode.GenericBarcode\n};", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.default = function (old, replaceObj) {\n  return _extends({}, old, replaceObj);\n};", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.default = linearizeEncodings;\n\n// Encodings can be nestled like [[1-1, 1-2], 2, [3-1, 3-2]\n// Convert to [1-1, 1-2, 2, 3-1, 3-2]\n\nfunction linearizeEncodings(encodings) {\n\tvar linearEncodings = [];\n\tfunction nextLevel(encoded) {\n\t\tif (Array.isArray(encoded)) {\n\t\t\tfor (var i = 0; i < encoded.length; i++) {\n\t\t\t\tnextLevel(encoded[i]);\n\t\t\t}\n\t\t} else {\n\t\t\tencoded.text = encoded.text || \"\";\n\t\t\tencoded.data = encoded.data || \"\";\n\t\t\tlinearEncodings.push(encoded);\n\t\t}\n\t}\n\tnextLevel(encodings);\n\n\treturn linearEncodings;\n}", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.default = fixOptions;\n\n\nfunction fixOptions(options) {\n\t// Fix the margins\n\toptions.marginTop = options.marginTop || options.margin;\n\toptions.marginBottom = options.marginBottom || options.margin;\n\toptions.marginRight = options.marginRight || options.margin;\n\toptions.marginLeft = options.marginLeft || options.margin;\n\n\treturn options;\n}", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.default = optionsFromStrings;\n\n// Convert string to integers/booleans where it should be\n\nfunction optionsFromStrings(options) {\n\tvar intOptions = [\"width\", \"height\", \"textMargin\", \"fontSize\", \"margin\", \"marginTop\", \"marginBottom\", \"marginLeft\", \"marginRight\"];\n\n\tfor (var intOption in intOptions) {\n\t\tif (intOptions.hasOwnProperty(intOption)) {\n\t\t\tintOption = intOptions[intOption];\n\t\t\tif (typeof options[intOption] === \"string\") {\n\t\t\t\toptions[intOption] = parseInt(options[intOption], 10);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (typeof options[\"displayValue\"] === \"string\") {\n\t\toptions[\"displayValue\"] = options[\"displayValue\"] != \"false\";\n\t}\n\n\treturn options;\n}", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nvar defaults = {\n\twidth: 2,\n\theight: 100,\n\tformat: \"auto\",\n\tdisplayValue: true,\n\tfontOptions: \"\",\n\tfont: \"monospace\",\n\ttext: undefined,\n\ttextAlign: \"center\",\n\ttextPosition: \"bottom\",\n\ttextMargin: 2,\n\tfontSize: 20,\n\tbackground: \"#ffffff\",\n\tlineColor: \"#000000\",\n\tmargin: 10,\n\tmarginTop: undefined,\n\tmarginBottom: undefined,\n\tmarginLeft: undefined,\n\tmarginRight: undefined,\n\tvalid: function valid() {}\n};\n\nexports.default = defaults;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _optionsFromStrings = require(\"./optionsFromStrings.js\");\n\nvar _optionsFromStrings2 = _interopRequireDefault(_optionsFromStrings);\n\nvar _defaults = require(\"../options/defaults.js\");\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getOptionsFromElement(element) {\n\tvar options = {};\n\tfor (var property in _defaults2.default) {\n\t\tif (_defaults2.default.hasOwnProperty(property)) {\n\t\t\t// jsbarcode-*\n\t\t\tif (element.hasAttribute(\"jsbarcode-\" + property.toLowerCase())) {\n\t\t\t\toptions[property] = element.getAttribute(\"jsbarcode-\" + property.toLowerCase());\n\t\t\t}\n\n\t\t\t// data-*\n\t\t\tif (element.hasAttribute(\"data-\" + property.toLowerCase())) {\n\t\t\t\toptions[property] = element.getAttribute(\"data-\" + property.toLowerCase());\n\t\t\t}\n\t\t}\n\t}\n\n\toptions[\"value\"] = element.getAttribute(\"jsbarcode-value\") || element.getAttribute(\"data-value\");\n\n\t// Since all atributes are string they need to be converted to integers\n\toptions = (0, _optionsFromStrings2.default)(options);\n\n\treturn options;\n}\n\nexports.default = getOptionsFromElement;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\nexports.getTotalWidthOfEncodings = exports.calculateEncodingAttributes = exports.getBarcodePadding = exports.getEncodingHeight = exports.getMaximumHeightOfEncodings = undefined;\n\nvar _merge = require(\"../help/merge.js\");\n\nvar _merge2 = _interopRequireDefault(_merge);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getEncodingHeight(encoding, options) {\n\treturn options.height + (options.displayValue && encoding.text.length > 0 ? options.fontSize + options.textMargin : 0) + options.marginTop + options.marginBottom;\n}\n\nfunction getBarcodePadding(textWidth, barcodeWidth, options) {\n\tif (options.displayValue && barcodeWidth < textWidth) {\n\t\tif (options.textAlign == \"center\") {\n\t\t\treturn Math.floor((textWidth - barcodeWidth) / 2);\n\t\t} else if (options.textAlign == \"left\") {\n\t\t\treturn 0;\n\t\t} else if (options.textAlign == \"right\") {\n\t\t\treturn Math.floor(textWidth - barcodeWidth);\n\t\t}\n\t}\n\treturn 0;\n}\n\nfunction calculateEncodingAttributes(encodings, barcodeOptions, context) {\n\tfor (var i = 0; i < encodings.length; i++) {\n\t\tvar encoding = encodings[i];\n\t\tvar options = (0, _merge2.default)(barcodeOptions, encoding.options);\n\n\t\t// Calculate the width of the encoding\n\t\tvar textWidth;\n\t\tif (options.displayValue) {\n\t\t\ttextWidth = messureText(encoding.text, options, context);\n\t\t} else {\n\t\t\ttextWidth = 0;\n\t\t}\n\n\t\tvar barcodeWidth = encoding.data.length * options.width;\n\t\tencoding.width = Math.ceil(Math.max(textWidth, barcodeWidth));\n\n\t\tencoding.height = getEncodingHeight(encoding, options);\n\n\t\tencoding.barcodePadding = getBarcodePadding(textWidth, barcodeWidth, options);\n\t}\n}\n\nfunction getTotalWidthOfEncodings(encodings) {\n\tvar totalWidth = 0;\n\tfor (var i = 0; i < encodings.length; i++) {\n\t\ttotalWidth += encodings[i].width;\n\t}\n\treturn totalWidth;\n}\n\nfunction getMaximumHeightOfEncodings(encodings) {\n\tvar maxHeight = 0;\n\tfor (var i = 0; i < encodings.length; i++) {\n\t\tif (encodings[i].height > maxHeight) {\n\t\t\tmaxHeight = encodings[i].height;\n\t\t}\n\t}\n\treturn maxHeight;\n}\n\nfunction messureText(string, options, context) {\n\tvar ctx;\n\n\tif (context) {\n\t\tctx = context;\n\t} else if (typeof document !== \"undefined\") {\n\t\tctx = document.createElement(\"canvas\").getContext(\"2d\");\n\t} else {\n\t\t// If the text cannot be messured we will return 0.\n\t\t// This will make some barcode with big text render incorrectly\n\t\treturn 0;\n\t}\n\tctx.font = options.fontOptions + \" \" + options.fontSize + \"px \" + options.font;\n\n\t// Calculate the width of the encoding\n\tvar measureTextResult = ctx.measureText(string);\n\tif (!measureTextResult) {\n\t\t// Some implementations don't implement measureText and return undefined.\n\t\t// If the text cannot be measured we will return 0.\n\t\t// This will make some barcode with big text render incorrectly\n\t\treturn 0;\n\t}\n\tvar size = measureTextResult.width;\n\treturn size;\n}\n\nexports.getMaximumHeightOfEncodings = getMaximumHeightOfEncodings;\nexports.getEncodingHeight = getEncodingHeight;\nexports.getBarcodePadding = getBarcodePadding;\nexports.calculateEncodingAttributes = calculateEncodingAttributes;\nexports.getTotalWidthOfEncodings = getTotalWidthOfEncodings;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _merge = require(\"../help/merge.js\");\n\nvar _merge2 = _interopRequireDefault(_merge);\n\nvar _shared = require(\"./shared.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar CanvasRenderer = function () {\n\tfunction CanvasRenderer(canvas, encodings, options) {\n\t\t_classCallCheck(this, CanvasRenderer);\n\n\t\tthis.canvas = canvas;\n\t\tthis.encodings = encodings;\n\t\tthis.options = options;\n\t}\n\n\t_createClass(CanvasRenderer, [{\n\t\tkey: \"render\",\n\t\tvalue: function render() {\n\t\t\t// Abort if the browser does not support HTML5 canvas\n\t\t\tif (!this.canvas.getContext) {\n\t\t\t\tthrow new Error('The browser does not support canvas.');\n\t\t\t}\n\n\t\t\tthis.prepareCanvas();\n\t\t\tfor (var i = 0; i < this.encodings.length; i++) {\n\t\t\t\tvar encodingOptions = (0, _merge2.default)(this.options, this.encodings[i].options);\n\n\t\t\t\tthis.drawCanvasBarcode(encodingOptions, this.encodings[i]);\n\t\t\t\tthis.drawCanvasText(encodingOptions, this.encodings[i]);\n\n\t\t\t\tthis.moveCanvasDrawing(this.encodings[i]);\n\t\t\t}\n\n\t\t\tthis.restoreCanvas();\n\t\t}\n\t}, {\n\t\tkey: \"prepareCanvas\",\n\t\tvalue: function prepareCanvas() {\n\t\t\t// Get the canvas context\n\t\t\tvar ctx = this.canvas.getContext(\"2d\");\n\n\t\t\tctx.save();\n\n\t\t\t(0, _shared.calculateEncodingAttributes)(this.encodings, this.options, ctx);\n\t\t\tvar totalWidth = (0, _shared.getTotalWidthOfEncodings)(this.encodings);\n\t\t\tvar maxHeight = (0, _shared.getMaximumHeightOfEncodings)(this.encodings);\n\n\t\t\tthis.canvas.width = totalWidth + this.options.marginLeft + this.options.marginRight;\n\n\t\t\tthis.canvas.height = maxHeight;\n\n\t\t\t// Paint the canvas\n\t\t\tctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t\t\tif (this.options.background) {\n\t\t\t\tctx.fillStyle = this.options.background;\n\t\t\t\tctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\t\t\t}\n\n\t\t\tctx.translate(this.options.marginLeft, 0);\n\t\t}\n\t}, {\n\t\tkey: \"drawCanvasBarcode\",\n\t\tvalue: function drawCanvasBarcode(options, encoding) {\n\t\t\t// Get the canvas context\n\t\t\tvar ctx = this.canvas.getContext(\"2d\");\n\n\t\t\tvar binary = encoding.data;\n\n\t\t\t// Creates the barcode out of the encoded binary\n\t\t\tvar yFrom;\n\t\t\tif (options.textPosition == \"top\") {\n\t\t\t\tyFrom = options.marginTop + options.fontSize + options.textMargin;\n\t\t\t} else {\n\t\t\t\tyFrom = options.marginTop;\n\t\t\t}\n\n\t\t\tctx.fillStyle = options.lineColor;\n\n\t\t\tfor (var b = 0; b < binary.length; b++) {\n\t\t\t\tvar x = b * options.width + encoding.barcodePadding;\n\n\t\t\t\tif (binary[b] === \"1\") {\n\t\t\t\t\tctx.fillRect(x, yFrom, options.width, options.height);\n\t\t\t\t} else if (binary[b]) {\n\t\t\t\t\tctx.fillRect(x, yFrom, options.width, options.height * binary[b]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"drawCanvasText\",\n\t\tvalue: function drawCanvasText(options, encoding) {\n\t\t\t// Get the canvas context\n\t\t\tvar ctx = this.canvas.getContext(\"2d\");\n\n\t\t\tvar font = options.fontOptions + \" \" + options.fontSize + \"px \" + options.font;\n\n\t\t\t// Draw the text if displayValue is set\n\t\t\tif (options.displayValue) {\n\t\t\t\tvar x, y;\n\n\t\t\t\tif (options.textPosition == \"top\") {\n\t\t\t\t\ty = options.marginTop + options.fontSize - options.textMargin;\n\t\t\t\t} else {\n\t\t\t\t\ty = options.height + options.textMargin + options.marginTop + options.fontSize;\n\t\t\t\t}\n\n\t\t\t\tctx.font = font;\n\n\t\t\t\t// Draw the text in the correct X depending on the textAlign option\n\t\t\t\tif (options.textAlign == \"left\" || encoding.barcodePadding > 0) {\n\t\t\t\t\tx = 0;\n\t\t\t\t\tctx.textAlign = 'left';\n\t\t\t\t} else if (options.textAlign == \"right\") {\n\t\t\t\t\tx = encoding.width - 1;\n\t\t\t\t\tctx.textAlign = 'right';\n\t\t\t\t}\n\t\t\t\t// In all other cases, center the text\n\t\t\t\telse {\n\t\t\t\t\t\tx = encoding.width / 2;\n\t\t\t\t\t\tctx.textAlign = 'center';\n\t\t\t\t\t}\n\n\t\t\t\tctx.fillText(encoding.text, x, y);\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"moveCanvasDrawing\",\n\t\tvalue: function moveCanvasDrawing(encoding) {\n\t\t\tvar ctx = this.canvas.getContext(\"2d\");\n\n\t\t\tctx.translate(encoding.width, 0);\n\t\t}\n\t}, {\n\t\tkey: \"restoreCanvas\",\n\t\tvalue: function restoreCanvas() {\n\t\t\t// Get the canvas context\n\t\t\tvar ctx = this.canvas.getContext(\"2d\");\n\n\t\t\tctx.restore();\n\t\t}\n\t}]);\n\n\treturn CanvasRenderer;\n}();\n\nexports.default = CanvasRenderer;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _merge = require(\"../help/merge.js\");\n\nvar _merge2 = _interopRequireDefault(_merge);\n\nvar _shared = require(\"./shared.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar svgns = \"http://www.w3.org/2000/svg\";\n\nvar SVGRenderer = function () {\n\tfunction SVGRenderer(svg, encodings, options) {\n\t\t_classCallCheck(this, SVGRenderer);\n\n\t\tthis.svg = svg;\n\t\tthis.encodings = encodings;\n\t\tthis.options = options;\n\t\tthis.document = options.xmlDocument || document;\n\t}\n\n\t_createClass(SVGRenderer, [{\n\t\tkey: \"render\",\n\t\tvalue: function render() {\n\t\t\tvar currentX = this.options.marginLeft;\n\n\t\t\tthis.prepareSVG();\n\t\t\tfor (var i = 0; i < this.encodings.length; i++) {\n\t\t\t\tvar encoding = this.encodings[i];\n\t\t\t\tvar encodingOptions = (0, _merge2.default)(this.options, encoding.options);\n\n\t\t\t\tvar group = this.createGroup(currentX, encodingOptions.marginTop, this.svg);\n\n\t\t\t\tthis.setGroupOptions(group, encodingOptions);\n\n\t\t\t\tthis.drawSvgBarcode(group, encodingOptions, encoding);\n\t\t\t\tthis.drawSVGText(group, encodingOptions, encoding);\n\n\t\t\t\tcurrentX += encoding.width;\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"prepareSVG\",\n\t\tvalue: function prepareSVG() {\n\t\t\t// Clear the SVG\n\t\t\twhile (this.svg.firstChild) {\n\t\t\t\tthis.svg.removeChild(this.svg.firstChild);\n\t\t\t}\n\n\t\t\t(0, _shared.calculateEncodingAttributes)(this.encodings, this.options);\n\t\t\tvar totalWidth = (0, _shared.getTotalWidthOfEncodings)(this.encodings);\n\t\t\tvar maxHeight = (0, _shared.getMaximumHeightOfEncodings)(this.encodings);\n\n\t\t\tvar width = totalWidth + this.options.marginLeft + this.options.marginRight;\n\t\t\tthis.setSvgAttributes(width, maxHeight);\n\n\t\t\tif (this.options.background) {\n\t\t\t\tthis.drawRect(0, 0, width, maxHeight, this.svg).setAttribute(\"style\", \"fill:\" + this.options.background + \";\");\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"drawSvgBarcode\",\n\t\tvalue: function drawSvgBarcode(parent, options, encoding) {\n\t\t\tvar binary = encoding.data;\n\n\t\t\t// Creates the barcode out of the encoded binary\n\t\t\tvar yFrom;\n\t\t\tif (options.textPosition == \"top\") {\n\t\t\t\tyFrom = options.fontSize + options.textMargin;\n\t\t\t} else {\n\t\t\t\tyFrom = 0;\n\t\t\t}\n\n\t\t\tvar barWidth = 0;\n\t\t\tvar x = 0;\n\t\t\tfor (var b = 0; b < binary.length; b++) {\n\t\t\t\tx = b * options.width + encoding.barcodePadding;\n\n\t\t\t\tif (binary[b] === \"1\") {\n\t\t\t\t\tbarWidth++;\n\t\t\t\t} else if (barWidth > 0) {\n\t\t\t\t\tthis.drawRect(x - options.width * barWidth, yFrom, options.width * barWidth, options.height, parent);\n\t\t\t\t\tbarWidth = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Last draw is needed since the barcode ends with 1\n\t\t\tif (barWidth > 0) {\n\t\t\t\tthis.drawRect(x - options.width * (barWidth - 1), yFrom, options.width * barWidth, options.height, parent);\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"drawSVGText\",\n\t\tvalue: function drawSVGText(parent, options, encoding) {\n\t\t\tvar textElem = this.document.createElementNS(svgns, 'text');\n\n\t\t\t// Draw the text if displayValue is set\n\t\t\tif (options.displayValue) {\n\t\t\t\tvar x, y;\n\n\t\t\t\ttextElem.setAttribute(\"style\", \"font:\" + options.fontOptions + \" \" + options.fontSize + \"px \" + options.font);\n\n\t\t\t\tif (options.textPosition == \"top\") {\n\t\t\t\t\ty = options.fontSize - options.textMargin;\n\t\t\t\t} else {\n\t\t\t\t\ty = options.height + options.textMargin + options.fontSize;\n\t\t\t\t}\n\n\t\t\t\t// Draw the text in the correct X depending on the textAlign option\n\t\t\t\tif (options.textAlign == \"left\" || encoding.barcodePadding > 0) {\n\t\t\t\t\tx = 0;\n\t\t\t\t\ttextElem.setAttribute(\"text-anchor\", \"start\");\n\t\t\t\t} else if (options.textAlign == \"right\") {\n\t\t\t\t\tx = encoding.width - 1;\n\t\t\t\t\ttextElem.setAttribute(\"text-anchor\", \"end\");\n\t\t\t\t}\n\t\t\t\t// In all other cases, center the text\n\t\t\t\telse {\n\t\t\t\t\t\tx = encoding.width / 2;\n\t\t\t\t\t\ttextElem.setAttribute(\"text-anchor\", \"middle\");\n\t\t\t\t\t}\n\n\t\t\t\ttextElem.setAttribute(\"x\", x);\n\t\t\t\ttextElem.setAttribute(\"y\", y);\n\n\t\t\t\ttextElem.appendChild(this.document.createTextNode(encoding.text));\n\n\t\t\t\tparent.appendChild(textElem);\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: \"setSvgAttributes\",\n\t\tvalue: function setSvgAttributes(width, height) {\n\t\t\tvar svg = this.svg;\n\t\t\tsvg.setAttribute(\"width\", width + \"px\");\n\t\t\tsvg.setAttribute(\"height\", height + \"px\");\n\t\t\tsvg.setAttribute(\"x\", \"0px\");\n\t\t\tsvg.setAttribute(\"y\", \"0px\");\n\t\t\tsvg.setAttribute(\"viewBox\", \"0 0 \" + width + \" \" + height);\n\n\t\t\tsvg.setAttribute(\"xmlns\", svgns);\n\t\t\tsvg.setAttribute(\"version\", \"1.1\");\n\n\t\t\tsvg.setAttribute(\"style\", \"transform: translate(0,0)\");\n\t\t}\n\t}, {\n\t\tkey: \"createGroup\",\n\t\tvalue: function createGroup(x, y, parent) {\n\t\t\tvar group = this.document.createElementNS(svgns, 'g');\n\t\t\tgroup.setAttribute(\"transform\", \"translate(\" + x + \", \" + y + \")\");\n\n\t\t\tparent.appendChild(group);\n\n\t\t\treturn group;\n\t\t}\n\t}, {\n\t\tkey: \"setGroupOptions\",\n\t\tvalue: function setGroupOptions(group, options) {\n\t\t\tgroup.setAttribute(\"style\", \"fill:\" + options.lineColor + \";\");\n\t\t}\n\t}, {\n\t\tkey: \"drawRect\",\n\t\tvalue: function drawRect(x, y, width, height, parent) {\n\t\t\tvar rect = this.document.createElementNS(svgns, 'rect');\n\n\t\t\trect.setAttribute(\"x\", x);\n\t\t\trect.setAttribute(\"y\", y);\n\t\t\trect.setAttribute(\"width\", width);\n\t\t\trect.setAttribute(\"height\", height);\n\n\t\t\tparent.appendChild(rect);\n\n\t\t\treturn rect;\n\t\t}\n\t}]);\n\n\treturn SVGRenderer;\n}();\n\nexports.default = SVGRenderer;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ObjectRenderer = function () {\n\tfunction ObjectRenderer(object, encodings, options) {\n\t\t_classCallCheck(this, ObjectRenderer);\n\n\t\tthis.object = object;\n\t\tthis.encodings = encodings;\n\t\tthis.options = options;\n\t}\n\n\t_createClass(ObjectRenderer, [{\n\t\tkey: \"render\",\n\t\tvalue: function render() {\n\t\t\tthis.object.encodings = this.encodings;\n\t\t}\n\t}]);\n\n\treturn ObjectRenderer;\n}();\n\nexports.default = ObjectRenderer;", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _canvas = require('./canvas.js');\n\nvar _canvas2 = _interopRequireDefault(_canvas);\n\nvar _svg = require('./svg.js');\n\nvar _svg2 = _interopRequireDefault(_svg);\n\nvar _object = require('./object.js');\n\nvar _object2 = _interopRequireDefault(_object);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = { CanvasRenderer: _canvas2.default, SVGRenderer: _svg2.default, ObjectRenderer: _object2.default };", "'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar InvalidInputException = function (_Error) {\n\t_inherits(InvalidInputException, _Error);\n\n\tfunction InvalidInputException(symbology, input) {\n\t\t_classCallCheck(this, InvalidInputException);\n\n\t\tvar _this = _possibleConstructorReturn(this, (InvalidInputException.__proto__ || Object.getPrototypeOf(InvalidInputException)).call(this));\n\n\t\t_this.name = \"InvalidInputException\";\n\n\t\t_this.symbology = symbology;\n\t\t_this.input = input;\n\n\t\t_this.message = '\"' + _this.input + '\" is not a valid input for ' + _this.symbology;\n\t\treturn _this;\n\t}\n\n\treturn InvalidInputException;\n}(Error);\n\nvar InvalidElementException = function (_Error2) {\n\t_inherits(InvalidElementException, _Error2);\n\n\tfunction InvalidElementException() {\n\t\t_classCallCheck(this, InvalidElementException);\n\n\t\tvar _this2 = _possibleConstructorReturn(this, (InvalidElementException.__proto__ || Object.getPrototypeOf(InvalidElementException)).call(this));\n\n\t\t_this2.name = \"InvalidElementException\";\n\t\t_this2.message = \"Not supported type to render on\";\n\t\treturn _this2;\n\t}\n\n\treturn InvalidElementException;\n}(Error);\n\nvar NoElementException = function (_Error3) {\n\t_inherits(NoElementException, _Error3);\n\n\tfunction NoElementException() {\n\t\t_classCallCheck(this, NoElementException);\n\n\t\tvar _this3 = _possibleConstructorReturn(this, (NoElementException.__proto__ || Object.getPrototypeOf(NoElementException)).call(this));\n\n\t\t_this3.name = \"NoElementException\";\n\t\t_this3.message = \"No element to render on.\";\n\t\treturn _this3;\n\t}\n\n\treturn NoElementException;\n}(Error);\n\nexports.InvalidInputException = InvalidInputException;\nexports.InvalidElementException = InvalidElementException;\nexports.NoElementException = NoElementException;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /* global HTMLImageElement */\n/* global HTMLCanvasElement */\n/* global SVGElement */\n\nvar _getOptionsFromElement = require(\"./getOptionsFromElement.js\");\n\nvar _getOptionsFromElement2 = _interopRequireDefault(_getOptionsFromElement);\n\nvar _renderers = require(\"../renderers\");\n\nvar _renderers2 = _interopRequireDefault(_renderers);\n\nvar _exceptions = require(\"../exceptions/exceptions.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// Takes an element and returns an object with information about how\n// it should be rendered\n// This could also return an array with these objects\n// {\n//   element: The element that the renderer should draw on\n//   renderer: The name of the renderer\n//   afterRender (optional): If something has to done after the renderer\n//     completed, calls afterRender (function)\n//   options (optional): Options that can be defined in the element\n// }\n\nfunction getRenderProperties(element) {\n\t// If the element is a string, query select call again\n\tif (typeof element === \"string\") {\n\t\treturn querySelectedRenderProperties(element);\n\t}\n\t// If element is array. Recursivly call with every object in the array\n\telse if (Array.isArray(element)) {\n\t\t\tvar returnArray = [];\n\t\t\tfor (var i = 0; i < element.length; i++) {\n\t\t\t\treturnArray.push(getRenderProperties(element[i]));\n\t\t\t}\n\t\t\treturn returnArray;\n\t\t}\n\t\t// If element, render on canvas and set the uri as src\n\t\telse if (typeof HTMLCanvasElement !== 'undefined' && element instanceof HTMLImageElement) {\n\t\t\t\treturn newCanvasRenderProperties(element);\n\t\t\t}\n\t\t\t// If SVG\n\t\t\telse if (element && element.nodeName && element.nodeName.toLowerCase() === 'svg' || typeof SVGElement !== 'undefined' && element instanceof SVGElement) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\telement: element,\n\t\t\t\t\t\toptions: (0, _getOptionsFromElement2.default)(element),\n\t\t\t\t\t\trenderer: _renderers2.default.SVGRenderer\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t// If canvas (in browser)\n\t\t\t\telse if (typeof HTMLCanvasElement !== 'undefined' && element instanceof HTMLCanvasElement) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\telement: element,\n\t\t\t\t\t\t\toptions: (0, _getOptionsFromElement2.default)(element),\n\t\t\t\t\t\t\trenderer: _renderers2.default.CanvasRenderer\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\t// If canvas (in node)\n\t\t\t\t\telse if (element && element.getContext) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\telement: element,\n\t\t\t\t\t\t\t\trenderer: _renderers2.default.CanvasRenderer\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else if (element && (typeof element === \"undefined\" ? \"undefined\" : _typeof(element)) === 'object' && !element.nodeName) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\telement: element,\n\t\t\t\t\t\t\t\trenderer: _renderers2.default.ObjectRenderer\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new _exceptions.InvalidElementException();\n\t\t\t\t\t\t}\n}\n\nfunction querySelectedRenderProperties(string) {\n\tvar selector = document.querySelectorAll(string);\n\tif (selector.length === 0) {\n\t\treturn undefined;\n\t} else {\n\t\tvar returnArray = [];\n\t\tfor (var i = 0; i < selector.length; i++) {\n\t\t\treturnArray.push(getRenderProperties(selector[i]));\n\t\t}\n\t\treturn returnArray;\n\t}\n}\n\nfunction newCanvasRenderProperties(imgElement) {\n\tvar canvas = document.createElement('canvas');\n\treturn {\n\t\telement: canvas,\n\t\toptions: (0, _getOptionsFromElement2.default)(imgElement),\n\t\trenderer: _renderers2.default.CanvasRenderer,\n\t\tafterRender: function afterRender() {\n\t\t\timgElement.setAttribute(\"src\", canvas.toDataURL());\n\t\t}\n\t};\n}\n\nexports.default = getRenderProperties;", "\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n/*eslint no-console: 0 */\n\nvar ErrorHandler = function () {\n\tfunction ErrorHandler(api) {\n\t\t_classCallCheck(this, ErrorHandler);\n\n\t\tthis.api = api;\n\t}\n\n\t_createClass(ErrorHandler, [{\n\t\tkey: \"handleCatch\",\n\t\tvalue: function handleCatch(e) {\n\t\t\t// If babel supported extending of Error in a correct way instanceof would be used here\n\t\t\tif (e.name === \"InvalidInputException\") {\n\t\t\t\tif (this.api._options.valid !== this.api._defaults.valid) {\n\t\t\t\t\tthis.api._options.valid(false);\n\t\t\t\t} else {\n\t\t\t\t\tthrow e.message;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthrow e;\n\t\t\t}\n\n\t\t\tthis.api.render = function () {};\n\t\t}\n\t}, {\n\t\tkey: \"wrapBarcodeCall\",\n\t\tvalue: function wrapBarcodeCall(func) {\n\t\t\ttry {\n\t\t\t\tvar result = func.apply(undefined, arguments);\n\t\t\t\tthis.api._options.valid(true);\n\t\t\t\treturn result;\n\t\t\t} catch (e) {\n\t\t\t\tthis.handleCatch(e);\n\n\t\t\t\treturn this.api;\n\t\t\t}\n\t\t}\n\t}]);\n\n\treturn ErrorHandler;\n}();\n\nexports.default = ErrorHandler;", "'use strict';\n\nvar _barcodes = require('./barcodes/');\n\nvar _barcodes2 = _interopRequireDefault(_barcodes);\n\nvar _merge = require('./help/merge.js');\n\nvar _merge2 = _interopRequireDefault(_merge);\n\nvar _linearizeEncodings = require('./help/linearizeEncodings.js');\n\nvar _linearizeEncodings2 = _interopRequireDefault(_linearizeEncodings);\n\nvar _fixOptions = require('./help/fixOptions.js');\n\nvar _fixOptions2 = _interopRequireDefault(_fixOptions);\n\nvar _getRenderProperties = require('./help/getRenderProperties.js');\n\nvar _getRenderProperties2 = _interopRequireDefault(_getRenderProperties);\n\nvar _optionsFromStrings = require('./help/optionsFromStrings.js');\n\nvar _optionsFromStrings2 = _interopRequireDefault(_optionsFromStrings);\n\nvar _ErrorHandler = require('./exceptions/ErrorHandler.js');\n\nvar _ErrorHandler2 = _interopRequireDefault(_ErrorHandler);\n\nvar _exceptions = require('./exceptions/exceptions.js');\n\nvar _defaults = require('./options/defaults.js');\n\nvar _defaults2 = _interopRequireDefault(_defaults);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// The protype of the object returned from the JsBarcode() call\n\n\n// Help functions\nvar API = function API() {};\n\n// The first call of the library API\n// Will return an object with all barcodes calls and the data that is used\n// by the renderers\n\n\n// Default values\n\n\n// Exceptions\n// Import all the barcodes\nvar JsBarcode = function JsBarcode(element, text, options) {\n\tvar api = new API();\n\n\tif (typeof element === \"undefined\") {\n\t\tthrow Error(\"No element to render on was provided.\");\n\t}\n\n\t// Variables that will be pased through the API calls\n\tapi._renderProperties = (0, _getRenderProperties2.default)(element);\n\tapi._encodings = [];\n\tapi._options = _defaults2.default;\n\tapi._errorHandler = new _ErrorHandler2.default(api);\n\n\t// If text is set, use the simple syntax (render the barcode directly)\n\tif (typeof text !== \"undefined\") {\n\t\toptions = options || {};\n\n\t\tif (!options.format) {\n\t\t\toptions.format = autoSelectBarcode();\n\t\t}\n\n\t\tapi.options(options)[options.format](text, options).render();\n\t}\n\n\treturn api;\n};\n\n// To make tests work TODO: remove\nJsBarcode.getModule = function (name) {\n\treturn _barcodes2.default[name];\n};\n\n// Register all barcodes\nfor (var name in _barcodes2.default) {\n\tif (_barcodes2.default.hasOwnProperty(name)) {\n\t\t// Security check if the propery is a prototype property\n\t\tregisterBarcode(_barcodes2.default, name);\n\t}\n}\nfunction registerBarcode(barcodes, name) {\n\tAPI.prototype[name] = API.prototype[name.toUpperCase()] = API.prototype[name.toLowerCase()] = function (text, options) {\n\t\tvar api = this;\n\t\treturn api._errorHandler.wrapBarcodeCall(function () {\n\t\t\t// Ensure text is options.text\n\t\t\toptions.text = typeof options.text === 'undefined' ? undefined : '' + options.text;\n\n\t\t\tvar newOptions = (0, _merge2.default)(api._options, options);\n\t\t\tnewOptions = (0, _optionsFromStrings2.default)(newOptions);\n\t\t\tvar Encoder = barcodes[name];\n\t\t\tvar encoded = encode(text, Encoder, newOptions);\n\t\t\tapi._encodings.push(encoded);\n\n\t\t\treturn api;\n\t\t});\n\t};\n}\n\n// encode() handles the Encoder call and builds the binary string to be rendered\nfunction encode(text, Encoder, options) {\n\t// Ensure that text is a string\n\ttext = \"\" + text;\n\n\tvar encoder = new Encoder(text, options);\n\n\t// If the input is not valid for the encoder, throw error.\n\t// If the valid callback option is set, call it instead of throwing error\n\tif (!encoder.valid()) {\n\t\tthrow new _exceptions.InvalidInputException(encoder.constructor.name, text);\n\t}\n\n\t// Make a request for the binary data (and other infromation) that should be rendered\n\tvar encoded = encoder.encode();\n\n\t// Encodings can be nestled like [[1-1, 1-2], 2, [3-1, 3-2]\n\t// Convert to [1-1, 1-2, 2, 3-1, 3-2]\n\tencoded = (0, _linearizeEncodings2.default)(encoded);\n\n\t// Merge\n\tfor (var i = 0; i < encoded.length; i++) {\n\t\tencoded[i].options = (0, _merge2.default)(options, encoded[i].options);\n\t}\n\n\treturn encoded;\n}\n\nfunction autoSelectBarcode() {\n\t// If CODE128 exists. Use it\n\tif (_barcodes2.default[\"CODE128\"]) {\n\t\treturn \"CODE128\";\n\t}\n\n\t// Else, take the first (probably only) barcode\n\treturn Object.keys(_barcodes2.default)[0];\n}\n\n// Sets global encoder options\n// Added to the api by the JsBarcode function\nAPI.prototype.options = function (options) {\n\tthis._options = (0, _merge2.default)(this._options, options);\n\treturn this;\n};\n\n// Will create a blank space (usually in between barcodes)\nAPI.prototype.blank = function (size) {\n\tvar zeroes = new Array(size + 1).join(\"0\");\n\tthis._encodings.push({ data: zeroes });\n\treturn this;\n};\n\n// Initialize JsBarcode on all HTML elements defined.\nAPI.prototype.init = function () {\n\t// Should do nothing if no elements where found\n\tif (!this._renderProperties) {\n\t\treturn;\n\t}\n\n\t// Make sure renderProperies is an array\n\tif (!Array.isArray(this._renderProperties)) {\n\t\tthis._renderProperties = [this._renderProperties];\n\t}\n\n\tvar renderProperty;\n\tfor (var i in this._renderProperties) {\n\t\trenderProperty = this._renderProperties[i];\n\t\tvar options = (0, _merge2.default)(this._options, renderProperty.options);\n\n\t\tif (options.format == \"auto\") {\n\t\t\toptions.format = autoSelectBarcode();\n\t\t}\n\n\t\tthis._errorHandler.wrapBarcodeCall(function () {\n\t\t\tvar text = options.value;\n\t\t\tvar Encoder = _barcodes2.default[options.format.toUpperCase()];\n\t\t\tvar encoded = encode(text, Encoder, options);\n\n\t\t\trender(renderProperty, encoded, options);\n\t\t});\n\t}\n};\n\n// The render API call. Calls the real render function.\nAPI.prototype.render = function () {\n\tif (!this._renderProperties) {\n\t\tthrow new _exceptions.NoElementException();\n\t}\n\n\tif (Array.isArray(this._renderProperties)) {\n\t\tfor (var i = 0; i < this._renderProperties.length; i++) {\n\t\t\trender(this._renderProperties[i], this._encodings, this._options);\n\t\t}\n\t} else {\n\t\trender(this._renderProperties, this._encodings, this._options);\n\t}\n\n\treturn this;\n};\n\nAPI.prototype._defaults = _defaults2.default;\n\n// Prepares the encodings and calls the renderer\nfunction render(renderProperties, encodings, options) {\n\tencodings = (0, _linearizeEncodings2.default)(encodings);\n\n\tfor (var i = 0; i < encodings.length; i++) {\n\t\tencodings[i].options = (0, _merge2.default)(options, encodings[i].options);\n\t\t(0, _fixOptions2.default)(encodings[i].options);\n\t}\n\n\t(0, _fixOptions2.default)(options);\n\n\tvar Renderer = renderProperties.renderer;\n\tvar renderer = new Renderer(renderProperties.element, encodings, options);\n\trenderer.render();\n\n\tif (renderProperties.afterRender) {\n\t\trenderProperties.afterRender();\n\t}\n}\n\n// Export to browser\nif (typeof window !== \"undefined\") {\n\twindow.JsBarcode = JsBarcode;\n}\n\n// Export to jQuery\n/*global jQuery */\nif (typeof jQuery !== 'undefined') {\n\tjQuery.fn.JsBarcode = function (content, options) {\n\t\tvar elementArray = [];\n\t\tjQuery(this).each(function () {\n\t\t\telementArray.push(this);\n\t\t});\n\t\treturn JsBarcode(elementArray, content, options);\n\t};\n}\n\n// Export to commonJS\nmodule.exports = JsBarcode;", "import onScan from \"onscan.js\";\ncustom_app.PointOfSale.ItemSelector = class {\n    constructor({ frm, wrapper, events, pos_profile, settings }) {\n        this.wrapper = wrapper;\n        this.events = events;\n        this.pos_profile = pos_profile;\n        this.hide_images = settings.hide_images;\n        this.auto_add_item = settings.auto_add_item_to_cart;\n\n        this.init_component();\n    }\n\n    init_component() {\n        this.prepare_dom();\n        this.make_search_bar();\n        this.load_items_data();\n        this.bind_events();\n        //Highlight\n        this.attach_shortcuts();\n        this.inject_css();\n        // this.filter_items({ uom: \"PC\"})\n\n\n    }\n\n    //For highlight items \n\n    inject_css() {\n        const css = `\n\t\t\t.highlight {\n\t\t\t\tbackground-color: #0289f7;\n                color: white;\n                font-weight: bold;\n\t\t\t}\n            .text{\n                font-size: 1em;\n                font-weight: semi-bold;\n            }\n            .text-description{\n                font-size: 1em;\n                font-weight: semi-bold;\n            }\n            .quantity-field{\n                width: 1rem;\n                height: 10rem;\n            }\n            .custom-quantity-field {\n                width: 200px; /* Adjust the width as needed */\n            }\n           \n\t\t`;\n\n\t\tconst style = document.createElement('style');\n\t\tstyle.type = 'text/css';\n\t\tif (style.styleSheet) {\n\t\t\tstyle.styleSheet.cssText = css;\n\t\t} else {\n\t\t\tstyle.appendChild(document.createTextNode(css));\n\t\t}\n\t\tdocument.head.appendChild(style);\n\t}\n\n\n    prepare_dom() {\n        const selectedWarehouse = localStorage.getItem('selected_warehouse');\n        this.wrapper.append(\n            `<section class=\"items-selector\" style=\"margin-top:0.3rem; grid-column: span 4 / span 4;\">\n\n                <div class=\"filter-section\" style=\"display: flex; align-items: center; gap: 10px;\">\n                    <div class=\"label\" style=\"flex: 1;\">\n                        ${__(\"All Items\")} ${selectedWarehouse ? selectedWarehouse : \"\"}\n                    </div>\n                    <div class=\"search-field\" style=\"flex: 2;\">\n                        <input type=\"text\" placeholder=\"Search by item code, serial number or barcode\" style=\"width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;\">\n                    </div>\n                    <div class=\"item-group-field\" style=\"flex: 1;\">\n                        <input type=\"text\" placeholder=\"Select item group\" style=\"width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px;\">\n                    </div>\n                  \n                </div>\n                <div class=\"table-responsive\">\n                    <table class=\"table items-table\">\n                        <thead style=\"position: sticky; top: 0; background-color: #fff; z-index: 1; font-size:11px;\">\n                            <tr>\n                                <th>Item Code</th>\n                                <th>Name</th>\n                                <th>Generic Name</th>\n                                <th>Vat Type</th>\n                                <th>Price</th>\n                                <th>UOM</th>\n                                <th>QOH</th>\n                            </tr>\n                        </thead>\n                        <tbody class=\"items-container\"></tbody>\n                    </table>\n                </div>\n            </section>\n            `\n        );\n    \n        this.$component = this.wrapper.find(\".items-selector\");\n        this.$items_container = this.$component.find(\".items-container\");\n    }\n    \n\n\n    async load_items_data() {\n        if (!this.item_group) {\n            const res = await frappe.db.get_value(\"Item Group\", { lft: 1, is_group: 1 }, \"name\");\n            this.parent_item_group = res.message.name;\n        }\n        if (!this.price_list) {\n            const res = await frappe.db.get_value(\"POS Profile\", this.pos_profile, \"selling_price_list\");\n            this.price_list = res.message.selling_price_list;\n        }\n    \n        // Set the UOM to PC\n        this.selected_uom = \"PC\";\n        if (this.item_uom) {\n            this.item_uom.set_value(\"PC\");\n            this.item_uom.refresh();\n        }\n    \n        // Retrieve and render items immediately after setting the values\n        const { message } = await this.get_items({});\n        this.render_item_list(message.items);\n    \n        // Trigger the filter function to apply the UOM filter\n        this.filter_items({ uom: this.selected_uom });\n    }\n\n    \n    get_items({ start = 0, page_length = 20, search_term = \"\" }) {\n        const doc = this.events.get_frm().doc;\n        const price_list = (doc && doc.selling_price_list) || this.price_list;\n        let { item_group, pos_profile } = this;\n\n        !item_group && (item_group = this.parent_item_group);\n\n        // Get the selected warehouse from local storage\n        const selected_warehouse = localStorage.getItem('selected_warehouse');\n\n\n        return frappe.call({\n            method: \"custom_app.customapp.page.packing_list.packing_list.get_items\",\n            freeze: true,\n            args: {\n                start,\n                page_length,\n                price_list,\n                item_group,\n                search_term,\n                pos_profile,\n                selected_warehouse  // Include selected warehouse in the request\n            },\n        });\n    }\n\n    //Camille\n    render_item_list(items) {\n        // Clear the current items in the container\n        this.$items_container.html(\"\");\n\n        // Filter items where the unit of measurement (UOM) is \"PC\"\n        // const filtered_items_pc_uom = items.filter(item => item.uom === \"PC\");\n        // console.log(\"Filtered Items (UOM = PC): \", filtered_items_pc_uom);\n\n        // Set the class property `items` to the filtered items\n        this.items = items;\n        // Log all filtered items to the console\n\n        items.forEach((item) => {\n            const item_html = this.get_item_html(item);\n            this.$items_container.append(item_html);\n        });\n\n        this.highlighted_row_index = 0;\n        this.highlight_row(this.highlighted_row_index);\n    }\n\n\n    get_item_html(item) {\n        const me = this;\n\n        const { item_code, item_image, serial_no, batch_no, barcode, actual_qty, uom, price_list_rate, description, latest_expiry_date, batch_number, custom_is_vatable, custom_generic_name, item_group} = item;\n        const precision = flt(price_list_rate, 2) % 1 != 0 ? 2 : 0;\n        let indicator_color;\n        let qty_to_display = actual_qty;\n\n        if (uom !== \"PC\") {\n            return \"\"; // Skip rendering if UOM is not 'PC'\n        }\n\n        // console.log(\"Actual QTY \", qty_to_display)\n\n        if (item.is_stock_item) {\n            indicator_color = actual_qty > 10 ? \"green\" : actual_qty <= 0 ? \"red\" : \"orange\";\n\n            // if (Math.round(qty_to_display) > 999) {\n            //     qty_to_display = Math.round(qty_to_display) / 1000;\n            //     qty_to_display = qty_to_display.toFixed(1) + \"K\";\n            // }\n\n        } else {\n            indicator_color = \"\";\n            qty_to_display = \"\";\n        }\n        const tax_rate = 0.12;\n\t\tconst no_vat = price_list_rate / (1 + tax_rate);\n\n\n        const item_description = description ? description : \"Description not available\";\n\n        return `<tr class=\"item-wrapper\" style=\"border-bottom: 1px solid #ddd; font-size: 12px;\" \n        onmouseover=\"this.style.backgroundColor='#0289f7'; this.style.color='white'; this.style.fontWeight='bold';\"\n        onmouseout=\"this.style.backgroundColor=''; this.style.color=''; this.style.fontWeight='';\"\n            data-item-code=\"${escape(item_code)}\" data-serial-no=\"${escape(serial_no)}\"\n            data-batch-no=\"${escape(batch_no)}\" data-uom=\"${escape(uom)}\"\n            data-rate=\"${escape(price_list_rate || 0)}\" data-description=\"${escape(item_description)}\" data-qty=\"${qty_to_display}\">\n            <td class=\"item-code\" style=\" width: 1rem;\">${item_code}</td> \n             <td class=\"item-name\" style=\"width: 15rem; white-space: normal; overflow: hidden; text-overflow: ellipsis;\">${item.item_name}</td>\n            <td class=\"item-name\" style=\"width: 8rem; white-space: normal; overflow: hidden; text-overflow: ellipsis;\">${custom_generic_name ? custom_generic_name : ''}</td>\n            <td class=\"item-vat\" style=\" width: 10%;\">${custom_is_vatable == 0 ? \"VAT-Exempt\" : \"VATable\"}</td>\n            <td class=\"item-rate\" style=\" width:8%;\">${format_currency(price_list_rate, item.currency)}</td>\n            <td class=\"item-uom\" style=\" width: 5%;\">${uom}</td>\n            <td class=\"item-qty\" style=\" width: 8%;\"><span class=\"indicator-pill whitespace-nowrap ${indicator_color}\">${actual_qty}</span></td>\n        </tr>`;\n    }\n\n    handle_broken_image($img) {\n        const item_abbr = $($img).attr(\"alt\");\n        $($img).parent().replaceWith(`<div class=\"item-display abbr\">${item_abbr}</div>`);\n    }\n\n    make_search_bar() {\n        const me = this;\n        const doc = me.events.get_frm().doc;\n        this.$component.find(\".search-field\").html(\"\");\n        this.$component.find(\".item-group-field\").html(\"\");\n        // this.$component.find(\".item-uoms\").html(\"\");\n        //branch field\n        // this.$component.find(\".branch-field\").html(\"\");\n\n    \tthis.search_field = frappe.ui.form.make_control({\n\t\t\tdf: {\n\t\t\t\tlabel: __(\"Search\"),\n\t\t\t\tfieldtype: \"Data\",\n\t\t\t\tplaceholder: __(\"Search by item code, serial number, barcode, generic name or description\"),\n\t\t\t},\n\t\t\tparent: this.$component.find(\".search-field\"),\n\t\t\trender_input: true,\n\t\t});\n\n\n\n        this.search_field.$input.on('input', () => {\n            let value = this.search_field.get_value().trim(); // Get and trim the input value\n        });\n\n        this.item_group_field = frappe.ui.form.make_control({\n            df: {\n                label: __(\"Item Group\"),\n                fieldtype: \"Link\",\n                options: \"Item Group\",\n                placeholder: __(\"Select item group\"),\n                onchange: function () {\n                    me.item_group = this.value;\n                    !me.item_group && (me.item_group = me.parent_item_group);\n                    me.filter_items();\n                },\n                get_query: function () {\n                    return {\n                        query: \"custom_app.customapp.page.packing_list.packing_list.item_group_query\",\n                        filters: {\n                            pos_profile: doc ? doc.pos_profile : \"\",\n                        },\n                    };\n                },\n            },\n            parent: this.$component.find(\".item-group-field\"),\n            render_input: true,\n        });\n\n\n        this.item_group_field.$input.on('input', () => {\n            let value = this.item_group_field.get_value().trim(); // Get and trim the input value\n\n        });\n\n        // this.item_uom = frappe.ui.form.make_control({\n        //     df: {\n        //         label: __(\"UOM\"),\n        //         fieldtype: \"Link\",\n        //         options: \"UOM\",\n        //         placeholder: __(\"Select UOM\"),\n        //         onchange: function () {\n        //             me.selected_uom = this.value;\n        //             me.filter_items({ uom: me.selected_uom });\n        //         },\n        //     },\n        //     parent: this.$component.find(\".item-uoms\"),\n        //     render_input: true,\n        // });\n\n        // this.item_uom.set_value(\"PC\");\n        // this.item_uom.refresh();\n\n        // this.item_uom.toggle_label(false);\n        this.search_field.toggle_label(false);\n        this.item_group_field.toggle_label(false);\n\n        this.attach_clear_btn();\n    }\n\n    attach_clear_btn() {\n\t\tthis.search_field.$wrapper.find(\".control-input\").append(\n\t\t\t`<span class=\"link-btn\" style=\"top: 2px;\">\n\t\t\t\t<a class=\"btn-open no-decoration\" title=\"${__(\"Clear\")}\">\n\t\t\t\t\t${frappe.utils.icon(\"close\", \"sm\")}\n\t\t\t\t</a>\n\t\t\t</span>`\n\t\t);\n\n\t\tthis.$clear_search_btn = this.search_field.$wrapper.find(\".link-btn\");\n\n\t\tthis.$clear_search_btn.on(\"click\", \"a\", () => {\n\t\t\tthis.set_search_value(\"\");\n\t\t\tthis.search_field.set_focus();\n            // this.load_items_data();\n\t\t});\n\t}\n\n    set_search_value(value) {\n        $(this.search_field.$input[0]).val(value).trigger(\"input\");\n    }\n\n\n    bind_events() {\n        const me = this;\n        window.onScan = onScan;\n\n        onScan.decodeKeyEvent = function (oEvent) {\n            var iCode = this._getNormalizedKeyNum(oEvent);\n            switch (true) {\n                case iCode >= 48 && iCode <= 90: // numbers and letters\n                case iCode >= 106 && iCode <= 111: // operations on numeric keypad (+, -, etc.)\n                case (iCode >= 160 && iCode <= 164) || iCode == 170: // ^ ! # $ *\n                case iCode >= 186 && iCode <= 194: // (; = , - . / `)\n                case iCode >= 219 && iCode <= 222: // ([ \\ ] ')\n                case iCode == 32: // spacebar\n                    if (oEvent.key !== undefined && oEvent.key !== \"\") {\n                        return oEvent.key;\n                    }\n                    var sDecoded = String.fromCharCode(iCode);\n                    switch (oEvent.shiftKey) {\n                        case false:\n                            sDecoded = sDecoded.toLowerCase();\n                            break;\n                        case true:\n                            sDecoded = sDecoded.toUpperCase();\n                            break;\n                    }\n                    return sDecoded;\n                case iCode >= 96 && iCode <= 105: // numbers on numeric keypad\n                    return 0 + (iCode - 96);\n            }\n            return \"\";\n        };\n\n        onScan.attachTo(document, {\n            onScan: (sScancode) => {\n                if (this.search_field && this.$component.is(\":visible\")) {\n                    this.search_field.set_focus();\n                    this.set_search_value(sScancode);\n                    this.barcode_scanned = true;\n                }\n            },\n        });\n\n    \n        let selectedUOM;\n        this.$component.on(\"click\", \".item-wrapper\", async function () {\n            const $item = $(this);\n            me.selectedItem = $item;\n            const item_code = unescape($item.attr(\"data-item-code\"));\n            const uom = unescape($item.attr(\"data-uom\"));\n            const rate = parseFloat(unescape($item.attr(\"data-rate\")));\n            const description = unescape($item.attr(\"data-description\"));\n            const qty = parseFloat(unescape($item.attr(\"data-qty\")));\n            const pos_profile = me.events.get_pos_profile();\n\n            // Debugging logs\n            // console.log(\"Item Clicked:\", item_code, uom, rate, description, qty);\n\n            frappe.call({\n                method: 'custom_app.customapp.page.packing_list.packing_list.get_item_uom_prices',\n                args: {\n                    item_code: item_code,\n                    pos_profile: pos_profile\n                },\n                callback: function (response) {\n                    if (response.message) {\n                        const uomPrices = response.message.uom_prices;\n                        // console.log(\"UOM Prices:\", uomPrices);\n\n                        const uomOptions = Object.keys(uomPrices).filter(uom => uom && uom !== \"null\").map(uom => ({\n                            label: uom,\n                            value: uom\n                        }));\n\n                        let defaultUOM = uom;\n                        if (!uomPrices.hasOwnProperty(defaultUOM)) {\n                            defaultUOM = uomOptions.length > 0 ? uomOptions[0].value : null;\n                            if (!defaultUOM) {\n                                frappe.msgprint(__('No valid UOMs found for this item.'));\n                                return;\n                            }\n                        }\n\n                        const defaultRate = uomPrices[defaultUOM];\n\n                        const dialog = new frappe.ui.Dialog({\n                            title: __(\"Item Details\"),\n                            fields: [\n                                {\n                                    fieldtype: \"HTML\",\n                                    title: __(\"Item Details\"),\n                                    options: `\n                                        <div class=\"row\">\n                                            <div class=\"col-lg\">\n                                                <div class=\"form-group\">\n                                                    <label class=\"control-label\">Item Code</label>\n                                                    <input class=\"form-control\" readonly data-fieldname=\"description\" type=\"text\" value=\"${item_code}\"/>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    `\n                                },\n                                {\n                                    fieldtype: \"HTML\",\n                                    title: __(\"Item Details\"),\n                                    options: `\n                                        <div class=\"row\">\n                                            <div class=\"col-lg\">\n                                                <div class=\"form-group\">\n                                                    <label class=\"control-label\">Item Description</label>\n                                                    <input class=\"form-control\" readonly data-fieldname=\"description\" type=\"text\" value=\"${description}\"/>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    `\n                                },\n                                {\n                                    fieldtype: \"HTML\",\n                                    label: __(\"Quantity\"),\n                                    options: `\n                                        <div class=\"row\">\n                                            <div class=\"col-lg\">\n                                                <div class=\"form-group\">\n                                                    <label class=\"control-label\">${__(\"Quantity\")}</label>\n                                                     <input class=\"form-control\" type=\"number\" data-fieldname=\"quantity\" required value=\"1\" min=\"1\" /> </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    `\n                                },\n                                {\n                                    fieldtype: 'Select',\n                                    label: __(\"UOM\"),\n                                    fieldname: 'uom',\n                                    options: uomOptions,\n                                    default: defaultUOM\n                                },\n                                {\n                                    fieldtype: \"HTML\",\n                                    label: __(\"Amount\"),\n                                    options: `\n                                        <div class=\"row\">\n                                            <div class=\"col-lg\">\n                                                <div class=\"form-group\">\n                                                    <label class=\"control-label\">Amount</label>\n                                                    <input class=\"form-control\" data-fieldname=\"total_amount\" value=\"${defaultRate.toFixed(2)}\" readonly />\n                                                </div>\n                                            </div>\n                                        </div>\n                                    `\n                                },\n                                        {\n                                    label: 'Branch Item INVTY',\n                                    fieldtype: 'Button',\n                                    btn_size: 'sm', // xs, sm, lg\n                                    click: function () {\n                                        // Step 1: Fetch the list of warehouses\n                                        let warehouses = [];\n                                        // const current_wareouse = // frappe.db.get_value(\"POS Profile\", this.pos_profile, warehouse)\n                                        // console.log(\"Current Warehouse: \", current_wareouse)\n\n                                        frappe.call({\n                                            method: \"frappe.client.get_list\",\n                                            args: {\n                                                doctype: \"Warehouse\",\n                                                fields: [\"name\", \"warehouse_type\", \"parent_warehouse\"],\n                                                limit_page_length: 0 // Fetch all items without limit\n                                            },\n                                            callback: function (response) {\n                                                warehouses = response.message;\n\n                                                // Step 2: Fetch item quantity for each warehouse\n                                                let warehouse_data_promises = warehouses.map(warehouse => {\n                                                    return new Promise((resolve, reject) => {\n                                                        frappe.call({\n                                                            method: \"custom_app.customapp.page.packing_list.packing_list.get_item_qty_per_warehouse\",\n                                                            args: {\n                                                                warehouse: warehouse.name,\n                                                                item_code: item_code // Replace with your item code variable\n                                                            },\n                                                            callback: function (response) {\n                                                                warehouse.actual_qty = response.message;\n                                                                resolve(warehouse);\n                                                            },\n                                                            error: function (error) {\n                                                                reject(error);\n                                                            }\n                                                        });\n                                                    });\n                                                });\n\n                                                Promise.all(warehouse_data_promises).then(warehouses_with_qty => {\n                                                    // Filter out warehouses with zero quantity\n                                                    warehouses_with_qty = warehouses_with_qty.filter(warehouse => warehouse.actual_qty > 0);\n                                                \n                                                    const dialog = new frappe.ui.Dialog({\n                                                        title: `${item_code} ${description}`,\n                                                        fields: [\n                                                            {\n                                                                fieldtype: 'HTML',\n                                                                fieldname: 'warehouse_table_html',\n                                                                options: renderWarehousesTable(warehouses_with_qty)\n                                                            }\n                                                        ],\n                                                        primary_action_label: __(\"Ok\"),\n                                                        primary_action: function () {\n                                                            dialog.hide();\n                                                        }\n                                                    });\n                                                \n                                                    // Show the dialog and adjust its width\n                                                    dialog.show();\n                                                \n                                                    // Adjust dialog width and enable scrolling for the table\n                                                    $(dialog.$wrapper).css({\n                                                        \"max-height\": \"80vh\", // Adjust max height as needed\n                                                        \"overflow-y\": \"auto\" // Enable vertical scrolling\n                                                    });\n                                                \n                                                    // Ensure the table within the dialog is scrollable\n                                                    $(dialog.fields_dict.warehouse_table_html.$wrapper).css({\n                                                        \"max-height\": \"60vh\", // Adjust table max height as needed\n                                                        \"overflow-y\": \"auto\" // Enable vertical scrolling for the table\n                                                    });\n                                                \n                                                }).catch(error => {\n                                                    console.error(\"Error fetching warehouse data:\", error);\n                                                });\n                                                \n                                                function renderWarehousesTable(data) {\n                                                    // Start building the HTML table\n                                                    let tableHtml = '<table class=\"table table-bordered\">';\n                                                    tableHtml += '<thead><tr>';\n                                                    tableHtml += '<th>Name</th>';\n                                                    tableHtml += '<th>Quantity</th>';\n                                                    tableHtml += '</tr></thead>';\n                                                    tableHtml += '<tbody>';\n                                                \n                                                    // Populate table rows with data\n                                                    data.forEach(row => {\n                                                        tableHtml += '<tr>';\n                                                        tableHtml += `<td>${row.name}</td>`;\n                                                        tableHtml += `<td>${row.actual_qty}</td>`;\n                                                        tableHtml += '</tr>';\n                                                    });\n                                                \n                                                    tableHtml += '</tbody>';\n                                                    tableHtml += '</table>';\n                                                \n                                                    return tableHtml;\n                                                }\n                                                \n                                            }\n                                        });\n                                    },\n                                }\n\n                            ],\n                            primary_action_label: __(\"Ok\"),\n                            primary_action: function () {\n                                const quantity = parseFloat(dialog.wrapper.find('input[data-fieldname=\"quantity\"]').val());\n                                const selectedUOM = dialog.wrapper.find('select[data-fieldname=\"uom\"]').val();\n                                const totalAmount = parseFloat(dialog.wrapper.find('input[data-fieldname=\"total_amount\"]').val());\n\n                                if (!quantity || quantity <= 0) {\n                                    frappe.msgprint(__(\"Please enter a valid quantity.\"));\n                                    return;\n                                }\n\n                                if (!me.selectedItem) {\n                                    frappe.msgprint(__(\"No item selected.\"));\n                                    return;\n                                }\n\n                                if (quantity > qty) {\n                                    frappe.msgprint(__(\"Entered Quantity Exceeded\"));\n                                    return;\n                                }\n\n                                frappe.call({\n                                    method: 'custom_app.customapp.page.packing_list.packing_list.get_item_uom_conversion',\n                                    args: {\n                                        item_code: item_code,\n                                        uom_code: selectedUOM\n                                    },\n                                    callback: function (response) {\n                                        if (response.message) {\n                                            let conversion_factor = response.message;\n        \n                                            // Adjust the quantity based on the conversion factor\n                                            const converted_quantity = quantity * conversion_factor;\n        \n                                            // Check if the converted quantity exceeds the available quantity\n                                            if (converted_quantity > qty) {\n                                                frappe.msgprint(__(\"Entered Quantity Exceeded\"));\n                                                return;\n                                            }\n\n                                            frappe.call({\n                                                method: \"custom_app.customapp.page.packing_list.packing_list.get_draft_pos_invoice_items\",\n                                                args: {\n                                                    pos_profile: pos_profile,// Replace with your actual pos_profile\n                                                    item_code: item_code // Replace with your actual item_code\n                                                },\n                                                callback: function (response) {\n                                                    if (response.message) {\n                                                        const { invoices, total_qty } = response.message;\n                                                        let item_total_qty = total_qty; // Use the total_qty from the response\n            \n                                                        // console.log(\"Draft POS Invoices with specified item:\", invoices);\n                                                        // console.log(`Total Quantity of Item (${item_code}): ${item_total_qty}`);\n            \n                                                        if ((item_total_qty + quantity) > qty) {\n                                                            const formatted_invoices = invoices.map(invoice => {\n                                                                const item_qty = invoice.items.reduce((total, item) => total + item.qty, 0);\n                                                                return {\n                                                                    name: invoice.name,\n                                                                    customer: invoice.customer, \n                                                                    item_qty: item_qty\n                                                                };\n                                                            });\n                                                        \n                                                            const invoice_dialog = new frappe.ui.Dialog({\n                                                                title: 'Items ordered by other customers',\n                                                                fields: [\n                                                                    {\n                                                                        fieldtype: 'HTML',\n                                                                        fieldname: 'invoices_table_html',\n                                                                        options: renderInvoicesTable(formatted_invoices)\n                                                                    }\n                                                                ],\n                                                                primary_action_label: __(\"Ok\"),\n                                                                primary_action: function () {\n                                                                    invoice_dialog.hide();\n                                                                }\n                                                            });\n\n                                                            invoice_dialog.$wrapper.on(\"keydown\", (e) => {\n                                                                if (e.key === \"Enter\") {\n                                                                    e.preventDefault(); // Prevent default action\n                                                                    invoice_dialog.get_primary_btn().trigger(\"click\"); // Trigger the primary action\n                                                                }\n                                                            });\n            \n                                                            function renderInvoicesTable(data) {\n                                                                // Start building the HTML table\n                                                                let tableHtml = '<table class=\"table table-bordered\">';\n                                                                tableHtml += '<thead><tr>';\n                                                                tableHtml += '<th>ID</th>';\n                                                                // tableHtml += '<th>Customer</th>';\n                                                                tableHtml += '<th>Quantity</th>';\n                                                                tableHtml += '</tr></thead>';\n                                                                tableHtml += '<tbody>';\n                                                            \n                                                                // Populate table rows with data\n                                                                data.forEach(row => {\n                                                                    tableHtml += '<tr>';\n                                                                    tableHtml += `<td>${row.name}</td>`;\n                                                                    // tableHtml += `<td>${row.customer}</td>`;\n                                                                    tableHtml += `<td>${row.item_qty}</td>`;\n                                                                    tableHtml += '</tr>';\n                                                                });\n                                                            \n                                                                tableHtml += '</tbody>';\n                                                                tableHtml += '</table>';\n                                                            \n                                                                return tableHtml;\n                                                            }\n                                                        \n                                                            invoice_dialog.show();\n                                                            return;\n                                                        }\n            \n                                                     \n            \n                                                        // Proceed with adding the item to the cart if conditions are not met\n                                                        me.selectedItem.find(\".item-uom\").text(selectedUOM);\n            \n                                                        const itemCode = unescape(me.selectedItem.attr(\"data-item-code\"));\n                                                        const batchNo = unescape(me.selectedItem.attr(\"data-batch-no\"));\n                                                        const serialNo = unescape(me.selectedItem.attr(\"data-serial-no\"));\n            \n                                                        me.events.item_selected({\n                                                            field: \"qty\",\n                                                            value: \"+\" + quantity,\n                                                            item: { item_code: itemCode, batch_no: batchNo, serial_no: serialNo, uom: selectedUOM, quantity, rate: totalAmount },\n                                                        });\n            \n                                                        me.search_field.set_focus();\n            \n                                                        dialog.hide();\n            \n            \n                                                        \n                                                    } else {\n                                                        console.log(\"No matching draft POS invoices found.\");\n                                                    }\n                                                },\n                                                error: function (error) {\n                                                    console.error(\"Error fetching draft POS invoices:\", error);\n                                                }\n                                            });\n\n\n                                            // me.selectedItem.find(\".item-uom\").text(selectedUOM);\n            \n                                            // const itemCode = unescape(me.selectedItem.attr(\"data-item-code\"));\n                                            // const batchNo = unescape(me.selectedItem.attr(\"data-batch-no\"));\n                                            // const serialNo = unescape(me.selectedItem.attr(\"data-serial-no\"));\n\n                                            // me.events.item_selected({\n                                            //     field: \"qty\",\n                                            //     value: \"+\" + quantity,\n                                            //     item: { item_code: itemCode, batch_no: batchNo, serial_no: serialNo, uom: selectedUOM, quantity, rate: totalAmount },\n                                            // });\n\n                                            // me.search_field.set_focus();\n\n                                            // dialog.hide();\n        \n                                        } else {\n                                            frappe.msgprint(__(\"Failed to fetch UOM conversion factor.\"));\n                                        }\n                                    }\n                                });\n                            }\n\n                        });\n\n                        dialog.on_page_show = function() {\n                            setTimeout(() => {\n                                const $quantityField = dialog.wrapper.find('input[data-fieldname=\"quantity\"]');\n                                $quantityField.focus();\n                                $quantityField.select(); // Selects the text inside the field for easy replacement\n                            }, 300); // Use a small delay to ensure the element is in the DOM\n                        };\n                        \n                        dialog.show();\n                    \n                        // Set the default UOM and amount fields\n                        dialog.wrapper.find('select[data-fieldname=\"uom\"]').val(defaultUOM);\n                        dialog.wrapper.find('input[data-fieldname=\"total_amount\"]').val(defaultRate.toFixed(2));\n                        \n\n                        dialog.wrapper.find('input[data-fieldname=\"quantity\"]').on('input', function () {\n                            const quantity = parseFloat($(this).val());\n                            const selectedUOM = dialog.wrapper.find('select[data-fieldname=\"uom\"]').val();\n                            const rate = uomPrices[selectedUOM];\n                            if (!isNaN(quantity)) {\n                                const totalAmount = (quantity * rate).toFixed(2);\n                                dialog.wrapper.find('input[data-fieldname=\"total_amount\"]').val(totalAmount);\n                            } else {\n                                dialog.wrapper.find('input[data-fieldname=\"total_amount\"]').val(rate.toFixed(2));\n                            }\n                        });\n\n                        dialog.wrapper.find('select[data-fieldname=\"uom\"]').on('change', function () {\n                            const selectedUOM = $(this).val();\n                            const rate = uomPrices[selectedUOM];\n                            const quantity = parseFloat(dialog.wrapper.find('input[data-fieldname=\"quantity\"]').val());\n                            if (!isNaN(quantity)) {\n                                const totalAmount = (quantity * rate).toFixed(2);\n                                dialog.wrapper.find('input[data-fieldname=\"total_amount\"]').val(totalAmount);\n                            } else {\n                                dialog.wrapper.find('input[data-fieldname=\"total_amount\"]').val(rate.toFixed(2));\n                            }\n                        });\n\n                        dialog.wrapper.find('input[data-fieldname=\"quantity\"]').on('keypress', function(e) {\n                            if (e.which === 13) { // Enter key pressed\n                                e.preventDefault();\n                                dialog.primary_action();\n                            }\n                        });\n                    }\n                }\n            });\n        });\n       \n        // this.$component.on(\"click\", \".item-wrapper\", function () {\n        // \tconst $item = $(this);\n        // \tconst item_code = unescape($item.attr(\"data-item-code\"));\n        // \tlet batch_no = unescape($item.attr(\"data-batch-no\"));\n        // \tlet serial_no = unescape($item.attr(\"data-serial-no\"));\n        // \tlet uom = unescape($item.attr(\"data-uom\"));\n        // \tlet rate = unescape($item.attr(\"data-rate\"));\n\n        // \t// escape(undefined) returns \"undefined\" then unescape returns \"undefined\"\n        // \tbatch_no = batch_no === \"undefined\" ? undefined : batch_no;\n        // \tserial_no = serial_no === \"undefined\" ? undefined : serial_no;\n        // \tuom = uom === \"undefined\" ? undefined : uom;\n        // \trate = rate === \"undefined\" ? undefined : rate;\n\n        // \tme.events.item_selected({\n        // \t\tfield: \"qty\",\n        // \t\tvalue: \"+1\",\n        // \t\titem: { item_code, batch_no, serial_no, uom, rate },\n        // \t});\n        // \tme.search_field.set_focus();\n        // });\n\n        this.search_field.$input.on(\"input\", (e) => {\n            clearTimeout(this.last_search);\n            this.last_search = setTimeout(() => {\n                const search_term = e.target.value;\n                this.filter_items({ search_term });\n            }, 300);\n\n            this.$clear_search_btn.toggle(Boolean(this.search_field.$input.val()));\n        });\n\n        this.search_field.$input.on(\"focus\", () => {\n            this.$clear_search_btn.toggle(Boolean(this.search_field.$input.val()));\n        });\n\n        this.$component.on(\"keydown\", (e) => {\n            const key = e.which || e.keyCode;\n            const isCtrlPressed = e.ctrlKey; \n            switch (key) {\n                case 38: // up arrow\n                    e.preventDefault();\n                    this.navigate_up();\n                    break;\n                case 40: // down arrow\n                    e.preventDefault();\n                    this.navigate_down();\n                    break;\n                case 9: // tab\n                    e.preventDefault();\n                    this.navigate_down();\n                    this.focus_next_field();\n                    break;\n                case 13: // enter\n                    if (isCtrlPressed) {\n                        // Handle Ctrl + Enter as a checkout shortcut\n                        break\n                    } else {\n                        // Regular Enter key behavior\n                        e.preventDefault();\n                        this.select_highlighted_item();\n                    }\n                    break;\n            }\n        });\n    }\n\n\n    attach_shortcuts() {\n        const ctrl_label = frappe.utils.is_mac() ? \"\u2318\" : \"Ctrl\";\n        this.search_field.parent.attr(\"title\", `${ctrl_label}+S`);\n        frappe.ui.keys.add_shortcut({\n            shortcut: \"ctrl+s\",\n            action: () => this.search_field.set_focus(),\n            condition: () => this.$component.is(\":visible\"),\n            description: __(\"Focus on search input\"),\n            ignore_inputs: true,\n            page: cur_page.page.page,\n        });\n        this.item_group_field.parent.attr(\"title\", `${ctrl_label}+G`);\n        frappe.ui.keys.add_shortcut({\n            shortcut: \"ctrl+g\",\n            action: () => this.item_group_field.set_focus(),\n            condition: () => this.$component.is(\":visible\"),\n            description: __(\"Focus on Item Group filter\"),\n            ignore_inputs: true,\n            page: cur_page.page.page,\n        });\n\n        document.addEventListener(\"keydown\", (e) => {\n            if (e.key === \"Enter\" && e.ctrlKey) {\n                e.preventDefault();\n                // Add your checkout logic here for Ctrl + Shift + Enter\n                console.log(\"Ctrl + Enter pressed for checkout\");\n                return false;\n            }\n        });\n\n\n        frappe.ui.keys.on(\"enter\", (e) => {\n\n            if (e.ctrlKey) return; // Skip handling if Shift + Enter is pressed\n        \n            const selector_is_visible = this.$component.is(\":visible\");\n            const dialog_is_open = document.querySelector(\".modal.show\");\n        \n            if (!selector_is_visible || this.search_field.get_value() === \"\") return;\n        \n            if (this.items.length == 0 && this.barcode_scanned) {\n                frappe.show_alert({\n                    message: __(\"No items found. Scan barcode again.\"),\n                    indicator: \"orange\",\n                });\n                frappe.utils.play_sound(\"error\");\n                this.barcode_scanned = false;\n                this.set_search_value(\"\");\n            }\n\n            \n\n            if (dialog_is_open && document.activeElement.tagName === \"SELECT\") {\n                // Trigger action to add the selected item to the cart\n                this.selectedItem.find(\".item-uom\").text(dialog.wrapper.find('select[data-fieldname=\"uom\"]').val());\n        \n                const itemCode = unescape(this.selectedItem.attr(\"data-item-code\"));\n                const batchNo = unescape(this.selectedItem.attr(\"data-batch-no\"));\n                const serialNo = unescape(this.selectedItem.attr(\"data-serial-no\"));\n        \n                this.events.item_selected({\n                    field: \"qty\",\n                    value: quantity,\n                    item: { item_code: itemCode, batch_no: batchNo, serial_no: serialNo, uom: selectedUOM, quantity, rate },\n                });\n        \n                this.search_field.set_focus();\n            }\n        });\n        \n        \n\n    }\n\n    // The rest of your class definition...\n\n\n    item_lookup_per_branch() {\n        const dialog = new frappe.ui.Dialog({\n            title: \"Hello\",\n\n            primary_action_label: __(\"Ok\"),\n            primary_action: function () {\n                dialog.hide();\n            }\n        })\n        dialog.show();\n    }\n\n\n    focus_next_field() {\n\n        const customerField = document.querySelector(\"_init_customer_selector\");\n        const doctorField = document.querySelector(\"init_doctor_selector\");\n\n        if (document.activeElement === this.search_field.$input[0]) {\n            customerField.focus();\n        } else if (document.activeElement === customerField) {\n            doctorField.focus();\n        }\n    }\n\n    navigate_up() {\n        if (this.highlighted_row_index > -1) {\n            this.highlighted_row_index--;\n            this.highlight_row(this.highlighted_row_index);\n        }\n    }\n\n    navigate_down() {\n        if (this.highlighted_row_index < this.items.length - 1) {\n            this.highlighted_row_index++;\n            this.highlight_row(this.highlighted_row_index);\n        }\n    }\n\n    highlight_row(index) {\n        // Ensure no highlight initially\n        if (index === -1) {\n            this.$items_container.find(\".item-wrapper\").removeClass(\"highlight\");\n            return;\n        }\n\n        // Remove highlight from all items\n        this.$items_container.find(\".item-wrapper\").removeClass(\"highlight\");\n\n        // Highlight the item at the current index\n        if (index >= 0 && index < this.items.length) {\n            this.$items_container.find(\".item-wrapper\").eq(index).addClass(\"highlight\");\n        }\n    }\n\n    select_highlighted_item() {\n        // Check if a click action is already in progress\n        if (this.isClicking) return;\n    \n        // Ensure highlighted_row_index is valid\n        if (this.highlighted_row_index === -1) {\n            frappe.msgprint({\n                title: __(\"No Item Highlighted\"),\n                indicator: \"orange\",\n                message: __(\"Please select an item to highlight before proceeding.\")\n            });\n            return;\n        }\n    \n        // Set the isClicking flag to true to indicate that a click action is in progress\n        this.isClicking = true;\n    \n        // Proceed to select the highlighted item\n        const highlightedItem = this.$items_container.find(\".item-wrapper\").eq(this.highlighted_row_index);\n        if (highlightedItem.length) {\n            highlightedItem.click(); // Simulate click action\n        }\n    \n        // Reset the isClicking flag after a short delay to allow for the click action to complete\n        setTimeout(() => {\n            this.isClicking = false;\n        }, 1000); // Adjust the delay (in milliseconds) as needed\n    }\n    \n    \n    \n\n\n\n    //end here\n\n    filter_items({ search_term = \"\", uom = \"PC\" } = {}) {\n        if (search_term) {\n            search_term = search_term.toLowerCase();\n\n            this.search_index = this.search_index || {};\n            if (this.search_index[search_term]) {\n                const items = this.search_index[search_term];\n                this.items = items;\n                if (uom) {\n                    this.items = this.items.filter(item => item.uom === uom);\n                }\n                this.render_item_list(this.items);\n                this.auto_add_item && this.items.length == 1 && this.add_filtered_item_to_cart();\n                return;\n            }\n        }\n\n        this.get_items({ search_term }).then(({ message }) => {\n            let { items, serial_no, batch_no, barcode } = message;\n            if (search_term && !barcode) {\n                this.search_index[search_term] = items;\n            }\n\n            // Filter by UOM if specified\n            if (uom) {\n                items = items.filter(item => item.uom === uom);\n            }\n\n            this.items = items;\n            this.render_item_list(items);\n            this.auto_add_item && this.items.length == 1 && this.add_filtered_item_to_cart();\n        });\n    }\n\n\n\n    add_filtered_item_to_cart() {\n        this.$items_container.find(\".item-wrapper\").click();\n        this.set_search_value(\"\");\n    }\n\n    resize_selector(minimize) {\n        if (minimize) {\n            this.$component.css({\n                \"opacity\": \"0\",               // Make the component invisible\n                \"pointer-events\": \"none\",     // Make the component non-interactive\n                \"grid-column\": \"span 1 / span 1\",\n                \"grid-template-columns\": \"repeat(13, minmax(0, 1fr))\"\n            });\n        } else {\n            this.$component.css({\n                \"opacity\": \"1\",               // Make the component visible\n                \"pointer-events\": \"auto\",     // Make the component interactive\n                \"grid-column\": \"span 4 / span 4\"\n            });\n\n            this.$component.find(\".filter-section\")\n                .css(\"grid-template-columns\", \"repeat(12, minmax(0, 1fr))\");\n\n            this.$component.find(\".search-field\").css(\"margin\", \"0px var(--margin-sm)\");\n\n            this.$items_container.css(\"grid-template-columns\", \"repeat(4, minmax(0, 1fr))\");\n        }\n    }\n\n    toggle_component(show) {\n        this.set_search_value(\"\");\n        this.$component.css(\"display\", show ? \"flex\" : \"none\");\n    }\n};", "custom_app.PointOfSale.ItemCart = class {\n\tconstructor({ wrapper, events, settings }) {\n\t\tthis.wrapper = wrapper;\n\t\tthis.events = events;\n\t\tthis.customer_info = undefined;\n\t\tthis.hide_images = settings.hide_images;\n\t\tthis.allowed_customer_groups = settings.customer_groups;\n\t\t// this.allowed_doctor_groups = settings.doctor_groups;\n\t\tthis.allow_rate_change = settings.allow_rate_change;\n\t\tthis.allow_discount_change = settings.allow_discount_change;\n\t\tthis.init_component();\n\t}\n\n\tinit_component() {\n\t\tthis.prepare_dom();\n\t\tthis.init_child_components();\n\t\tthis.bind_events();\n\t\tthis.attach_shortcuts();\n\t} \n\n\tprepare_dom() {\n\t\tthis.wrapper.append(`<section class=\"customer-cart-container\" style=\"margin-top:-1rem; grid-column: span 6/ span 6;\"></section>`);\n\n\t\tthis.$component = this.wrapper.find(\".customer-cart-container\");\n\t}\n\n\n\tinit_child_components() {\n\t\tthis.init_customer_selector();\n\t\t// this.init_doctor_selector();\n\t\tthis.init_cart_components();\n\t}\n\n\tinit_customer_selector() {\n\t\tthis.$component.append(`<div class=\"customer-section mb-2 mt-4\"></div>`);\n\n\t\tthis.$customer_section = this.$component.find(\".customer-section\");\n\t\tthis.make_customer_selector();\n\t}\n\n\n\t// init_doctor_selector() {\n\t// \tthis.$component.append(`<div class=\"doctor-section\" style=\"display: flex;\n\t// \tflex-direction: column;\n\t// \tpadding: var(--padding-md) var(--padding-lg);\n\t// \toverflow: visible; background-color: var(--fg-color);\n\t// \tbox-shadow: var(--shadow-base);\n\t// \tborder-radius: var(--border-radius-md);\n\t//   }; margin-top: 1em;\"></div>`);\n\t// \tthis.$doctor_section = this.$component.find(\".doctor-section\");\n\t// \tthis.make_doctor_selector();\n\t// }\n\n\n\treset_customer_selector() {\n\t\tconst frm = this.events.get_frm();\n\t\tfrm.set_value(\"customer\", \"\");\n\t\tthis.make_customer_selector();\n\t\tthis.customer_field.set_focus();\n\t}\n\n\t// reset_doctor_selector() {\n\t// \tconst frm = this.events.get_frm();\n\t// \tfrm.set_value(\"doctor\", \"\");\n\t// \tthis.make_doctor_selector();\n\t// \tthis.doctor_field.set_focus();\n\t// }\n\n\tinit_cart_components() {\n\t\tthis.$component.append(\n\t\t\t`<div class=\"cart-container\">\n\t\t\t\t<div class=\"abs-cart-container\">\n\t\t\t\t\t<div class=\"cart-label\" >${__(\"Item Cart\")}</div>\n\t\t\t\t\t<div class=\"cart-header\">\n\t\t\t\t\t\t<div class=\"name-header\">${__(\"Item\")}</div>\n\t\t\t\t\t\t<div class=\"qty-header\">${__(\"Vat Type\")}</div>\n\t\t\t\t\t\t<div class=\"qty-header\">${__(\"Price\")}</div>\n\t\t\t\t\t\t<div class=\"qty-header\" >${__(\"Disc %\")}</div>\n\t\t\t\t\t\t<div class=\"qty-header\">${__(\"Quantity\")}</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div class=\"rate-amount-header\">${__(\"Amount\")}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"cart-items-section\"></div>\n\t\t\t\t\t<div class=\"cart-totals-section\"></div>\n\t\t\t\t\t<div class=\"numpad-section\"></div>\n\t\t\t\t</div>\n\t\t\t</div>`\n\t\t);\n\t\tthis.$cart_container = this.$component.find(\".cart-container\");\n\n\t\tthis.make_cart_totals_section();\n\t\tthis.make_cart_items_section();\n\t\tthis.make_cart_numpad();\n\t}\n\n\tmake_cart_items_section() {\n\t\tthis.$cart_header = this.$component.find(\".cart-header\");\n\t\tthis.$cart_items_wrapper = this.$component.find(\".cart-items-section\");\n\t\t//this.load_stored_cart_items();\n\t\tthis.make_no_items_placeholder();\n\t}\n\n\tmake_no_items_placeholder() {\n\t\tthis.$cart_header.css(\"display\", \"none\");\n\t\tthis.$cart_items_wrapper.html(`<div class=\"no-item-wrapper\">${__(\"No items in cart\")}</div>`);\n\t}\n\n\n\tadd_keyboard_navigation() {\n\t\tthis.$component.on('keydown', '[tabindex=\"0\"]', (e) => {\n\t\t\tif (e.key === 'Enter') {\n\t\t\t\t$(e.target).trigger('click');\n\t\t\t}\n\t\t\tswitch (e.key) {\n\t\t\t\tcase 'ArrowUp':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.focusPreviousElement(e.target);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'ArrowDown':\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.focusNextElement(e.target);\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n\n\tfocusNextElement(current) {\n\t\tlet $next = $(current).nextAll('[tabindex=\"0\"]').first();\n\t\tif (!$next.length) {\n\t\t\t$next = this.$component.find('[tabindex=\"0\"]').first();\n\t\t}\n\t\t$next.focus();\n\t}\n\n\tfocusPreviousElement(current) {\n\t\tlet $prev = $(current).prevAll('[tabindex=\"0\"]').first();\n\t\tif (!$prev.length) {\n\t\t\t$prev = this.$component.find('[tabindex=\"0\"]').last();\n\t\t}\n\t\t$prev.focus();\n\t}\n\n\tget_cart_item(item_data) {\n\t\treturn this.$cart_items_wrapper.find(`[data-row-name=\"${escape(item_data.name)}\"]`);\n\t}\n\n\n\tget_discount_icon() {\n\t\treturn `<svg class=\"discount-icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t<path d=\"M19 15.6213C19 15.2235 19.158 14.842 19.4393 14.5607L20.9393 13.0607C21.5251 12.4749 21.5251 11.5251 20.9393 10.9393L19.4393 9.43934C19.158 9.15804 19 8.7765 19 8.37868V6.5C19 5.67157 18.3284 5 17.5 5H15.6213C15.2235 5 14.842 4.84196 14.5607 4.56066L13.0607 3.06066C12.4749 2.47487 11.5251 2.47487 10.9393 3.06066L9.43934 4.56066C9.15804 4.84196 8.7765 5 8.37868 5H6.5C5.67157 5 5 5.67157 5 6.5V8.37868C5 8.7765 4.84196 9.15804 4.56066 9.43934L3.06066 10.9393C2.47487 11.5251 2.47487 12.4749 3.06066 13.0607L4.56066 14.5607C4.84196 14.842 5 15.2235 5 15.6213V17.5C5 18.3284 5.67157 19 6.5 19H8.37868C8.7765 19 9.15804 19.158 9.43934 19.4393L10.9393 20.9393C11.5251 21.5251 12.4749 21.5251 13.0607 20.9393L14.5607 19.4393C14.842 19.158 15.2235 19 15.6213 19H17.5C18.3284 19 19 18.3284 19 17.5V15.6213Z\" stroke-miterlimit=\"10\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t<path d=\"M15 9L9 15\" stroke-miterlimit=\"10\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t<path d=\"M10.5 9.5C10.5 10.0523 10.0523 10.5 9.5 10.5C8.94772 10.5 8.5 10.0523 8.5 9.5C8.5 8.94772 8.94772 8.5 9.5 8.5C10.0523 8.5 10.5 8.94772 10.5 9.5Z\" fill=\"white\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t<path d=\"M15.5 14.5C15.5 15.0523 15.0523 15.5 14.5 15.5C13.9477 15.5 13.5 15.0523 13.5 14.5C13.5 13.9477 13.9477 13.5 14.5 13.5C15.0523 13.5 15.5 13.9477 15.5 14.5Z\" fill=\"white\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t</svg>`;\n\t}\n\n\tmake_cart_totals_section() {\n\t\tthis.$totals_section = this.$component.find(\".cart-totals-section\");\n\n\t\tthis.$totals_section.append(\n\t\t\t`\n\t\t\t<div class=\"item-qty-total-container\">\n\t\t\t\t<div class=\"item-qty-total-label\">${__(\"Total Items\")}</div>\n\t\t\t\t<div class=\"item-qty-total-value\">0.00</div>\n\t\t\t</div>\n\t\t\t<div class=\"vatable-sales-container\"></div>\n\t\t\t<div class=\"vat-exempt-container\"></div>\n\t\t\t<div class=\"zero-rated-container\"></div>\n\t\t\t\n\t\t\t\n\t\t\t<div class=\"ex-total-container\"></div>\n\t\t\t\t<div class=\"net-total-container\" style=\"line-height: 0rem; font-size:12px;\">\n\t\t\t\t<div class=\"net-total-label\">${__(\"Sub Total:\")}</div>\n\t\t\t\t<div class=\"net-total-value\" style=\"font-size:12px;\">0.00</div>\n\t\t\t</div>\n\n\t\t <div class=\"taxes-container\"></div>\n\t\t <div class=\"vat-container\"></div>\n\t\t<div class=\"total-vat-container\"></div>\n\t\t\t<div class=\"grand-total-container\" style=\"line-height: 0rem;\">\n\t\t\t\t<div>${__(\"Total\")}</div>\n\t\t\t\t<div>0.00</div>\n\t\t\t</div> \n\n\t\t\t<div class=\"checkout-btn\">${__(\"Order\")}</div>\n\t\t\t<div class=\"edit-cart-btn\">${__(\"Edit Cart\")}</div>`\n\t\t);\n\n\t\tthis.$add_discount_elem = this.$component.find(\".add-discount-wrapper\");\n\t}\n\n\tmake_cart_numpad() {\n\t\tthis.$numpad_section = this.$component.find(\".numpad-section\");\n\n\t\tthis.number_pad = new custom_app.PointOfSale.NumberPad({\n\t\t\twrapper: this.$numpad_section,\n\t\t\tevents: {\n\t\t\t\tnumpad_event: this.on_numpad_event.bind(this),\n\t\t\t},\n\t\t\tcols: 5,\n\t\t\tkeys: [\n\t\t\t\t// [1, 2, 3, \"Quantity\"],\n\t\t\t\t// [4, 5, 6, \"Discount\"],\n\t\t\t\t// [7, 8, 9, \"Rate\"],\n\t\t\t\t// [\".\", 0, \"Delete\", \"Remove\"],\n\t\t\t\t[\"Discount\", \"Quantity\",\"\", \"Remove\"],\n\t\t\t],\n\t\t\tcss_classes: [\n\t\t\t\t[\"\", \"\", \"\", \"col-span-2 remove-btn\"],\n\t\t\t\t[\"\", \"\", \"\", \"col-span-2\"],\n\t\t\t\t[\"\", \"\", \"\", \"col-span-2\"],\n\t\t\t\t[\"\", \"\", \"\", \"col-span-2\"],\n\t\t\t\t// [\"\", \"\", \"\", \"col-span-2 remove-btn\"],\n\t\t\t],\n\t\t\tfieldnames_map: { Quantity: \"qty\", Discount: \"discount_percentage\" },\n\t\t});\n\n\t\tthis.$numpad_section.prepend(\n\t\t\t`<div class=\"numpad-totals\">\n\t\t\t<span class=\"numpad-item-qty-total\"></span>\n\t\t\t\t<span class=\"numpad-net-total\"></span>\n\t\t\t\t<span class=\"numpad-grand-total\"></span>\n\t\t\t</div>`\n\t\t);\n\n\t\tthis.$numpad_section.append(\n\t\t\t`<div class=\"numpad-btn checkout-btn\" data-button-value=\"checkout\">${__(\"Order\")}</div>`\n\t\t);\n\t}\n\n\tbind_events() {\n\t\tconst me = this;\n\t\tthis.$customer_section.on(\"click\", \".reset-customer-btn\", function () {\n\t\t\tme.reset_customer_selector();\n\t\t});\n\n\t\tthis.$customer_section.on(\"click\", \".close-details-btn\", function () {\n\t\t\tme.toggle_customer_info(false);\n\t\t});\n\n\t\tthis.$customer_section.on(\"click\", \".customer-display\", function (e) {\n\t\t\tif ($(e.target).closest(\".reset-customer-btn\").length) return;\n\n\t\t\tconst show = me.$cart_container.is(\":visible\");\n\t\t\tme.toggle_customer_info(show);\n\t\t});\n\n\t\t//Doctors\n\n\t\t// this.$doctor_section.on(\"click\", \".reset-doctor-btn\", function () {\n\t\t// \tme.reset_doctor_selector();\n\t\t// });\n\n\t\t// this.$doctor_section.on(\"click\", \".close-details-btn\", function () {\n\t\t// \tme.toggle_doctor_info(false);\n\t\t// });\n\n\t\t// this.$doctor_section.on(\"click\", \".doctor-display\", function (e) {\n\t\t// \tif ($(e.target).closest(\".reset-doctor-btn\").length) return;\n\n\t\t// \tconst show = me.$cart_container.is(\":visible\");\n\t\t// \tme.toggle_doctor_info(show);\n\t\t// });\n\n\n\t\tthis.$cart_items_wrapper.on(\"click\", \".cart-item-wrapper\", function () {\n\t\t\tconst $cart_item = $(this);\n\t\t\tme.toggle_item_highlight(this);\n\t\t\tconst payment_section_hidden = !me.$totals_section.find(\".edit-cart-btn\").is(\":visible\");\n\t\t\tif (!payment_section_hidden) {\n\t\t\t\t// payment section is visible\n\t\t\t\t// edit cart first and then open item details section\n\t\t\t\tme.$totals_section.find(\".edit-cart-btn\").click();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst item_row_name = unescape($cart_item.attr(\"data-row-name\"));\n\t\t\tme.events.cart_item_clicked({ name: item_row_name });\n\t\t\tthis.numpad_value = \"\";\n\t\t});\n\n\n\n\t\tthis.$component.on(\"click\", \".checkout-btn\", async function () {\n\t\t\tif ($(this).attr(\"style\").indexOf(\"--blue-500\") == -1) return;\n\n\t\t\tawait me.events.checkout();\n\t\t\tme.toggle_checkout_btn(false);\n\n\t\t\tme.allow_discount_change && me.$add_discount_elem.removeClass(\"d-none\");\n\t\t});\n\n\t\tthis.$totals_section.on(\"click\", \".edit-cart-btn\", () => {\n\t\t\t// Destroy any previous instances of the dialog\n\t\t\t\n\t\t\tif (this.passwordDialog) {\n\t\t\t\tthis.passwordDialog.$wrapper.remove();\n\t\t\t\tdelete this.passwordDialog;\n\t\t\t}\n\t\t\n\t\t\t// Create and show the password dialog\n\t\t\tthis.passwordDialog = new frappe.ui.Dialog({\n\t\t\t\ttitle: __('Enter OIC Password'),\n\t\t\t\tfields: [\n\t\t\t\t\t{\n\t\t\t\t\t\tfieldtype: 'HTML',\n\t\t\t\t\t\tfieldname: 'password_html',\n\t\t\t\t\t\toptions: `\n\t\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t\t<label for=\"password_field\">${__('Password')}</label>\n\t\t\t\t\t\t\t\t<input type=\"password\" id=\"password_field\" class=\"form-control\" required>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t`\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tprimary_action_label: __('Ok'),\n\t\t\t\tprimary_action: () => {\n\t\t\t\t\t// Retrieve the password value from the HTML field\n\t\t\t\t\tlet password = document.getElementById('password_field').value;\n\t\t\n\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.confirm_user_password\",\n\t\t\t\t\t\targs: { password: password },\n\t\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\t\tif (r.message && r.message.name) {\n\t\t\t\t\t\t\t\t// OIC authentication successful, proceed with editing the cart\n\t\t\t\t\t\t\t\tthis.events.edit_cart();\n\t\t\t\t\t\t\t\tthis.toggle_checkout_btn(true);\n\t\t\t\t\t\t\t\tthis.passwordDialog.hide();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// Show alert for incorrect password or unauthorized user\n\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\tmessage: __('Incorrect password or user is not an OIC'),\n\t\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t\n\t\t\tthis.passwordDialog.show();\n\t\t\n\t\t\n\t\t\t// Ensure the password field gains focus every time the dialog is opened\n\t\t\tthis.passwordDialog.$wrapper.on('shown.bs.modal', function () {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tdocument.getElementById('password_field').focus();\n\t\t\t\t}, 100); // Slight delay to ensure field is rendered before focusing\n\t\t\t});\n\t\t});\n\t\t\n\n\t\tthis.$component.on(\"click\", \".add-discount-wrapper\", () => {\n\t\t\t// Check if OIC authentication is required\n\t\t\tif (!this.is_oic_authenticated) {\n\t\t\t\t// OIC authentication required, show password dialog\n\t\t\t\tconst passwordDialog = new frappe.ui.Dialog({\n\t\t\t\t\ttitle: __('Enter OIC Password'),\n\t\t\t\t\tfields: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfieldname: 'password',\n\t\t\t\t\t\t\tfieldtype: 'Password',\n\t\t\t\t\t\t\tlabel: __('Password'),\n\t\t\t\t\t\t\treqd: 1\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tprimary_action_label: __('Add Discount'),\n\t\t\t\t\tprimary_action: (values) => {\n\t\t\t\t\t\tlet password = values.password;\n\t\t\t\t\t\tlet role = \"oic\";\n\n\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\tmethod: \"custom_app.customapp.page.amesco_point_of_sale.amesco_point_of_sale.confirm_user_password\",\n\t\t\t\t\t\t\targs: { password: password, role: role },\n\t\t\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\t\t\tif (r.message) {\n\t\t\t\t\t\t\t\t\t// OIC authentication successful, proceed with editing the cart\n\t\t\t\t\t\t\t\t\tthis.is_oic_authenticated = true;\n\t\t\t\t\t\t\t\t\tthis.show_discount_control();\n\t\t\t\t\t\t\t\t\tpasswordDialog.hide();\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// Show alert for incorrect password or unauthorized user\n\t\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\t\tmessage: __('Incorrect password or user is not an OIC'),\n\t\t\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tpasswordDialog.show();\n\t\t\t} else {\n\t\t\t\t// OIC authenticated, proceed with showing the discount control\n\t\t\t\tconst can_edit_discount = this.$add_discount_elem.find(\".edit-discount-btn\").length;\n\t\t\t\tif (!this.discount_field || can_edit_discount) this.show_discount_control();\n\t\t\t}\n\t\t});\n\n\t\t// Event handler for editing the discount field\n\t\tthis.$add_discount_elem.find(\".edit-discount-btn\").on(\"click\", () => {\n\t\t\t// Reset OIC authentication flag and prompt for authentication\n\t\t\tthis.is_oic_authenticated = false;\n\t\t\tthis.$component.trigger(\"click\", \".add-discount-wrapper\");\n\t\t});\n\n\t\tfrappe.ui.form.on(\"POS Invoice\", \"paid_amount\", (frm) => {\n\t\t\t// called when discount is applied\n\t\t\tthis.update_totals_section(frm);\n\t\t});\n\t}\n\n\tattach_shortcuts() {\n\n\t\tdocument.addEventListener('keydown', function (event) {\n\t\t\t// List of key codes to prevent\n\t\t\tconst keysToPrevent = {\n\t\t\t\t// Prevent F5 (refresh)\n\t\t\t\t116: true,\n\t\t\t\t// Prevent Ctrl+R (refresh)\n\t\t\t\t'Ctrl+82': true,\n\t\t\t\t// Prevent Ctrl+Shift+R (refresh)\n\t\t\t\t'Ctrl+16+82': true,\n\t\t\t\t// Prevent Ctrl+S (save)\n\t\t\t\t'Ctrl+83': true,\n\t\t\t\t// Prevent Ctrl+P (print)\n\t\t\t\t'Ctrl+80': true,\n\t\t\t\t// Prevent Ctrl+W (close tab)\n\t\t\t\t'Ctrl+87': true,\n\t\t\t\t// Prevent Ctrl+Shift+I (Developer Tools)\n\t\t\t\t'Ctrl+Shift+73': true,\n\t\t\t\t// Prevent Ctrl+J (Downloads)\n\t\t\t\t'Ctrl+74': true,\n\t\t\t\t// Prevent Ctrl+E\n\t\t\t\t'Ctrl+69': true,\n\t\t\t\t// Prevent Ctrl+Q\n\t\t\t\t// 'Ctrl+18+81': true,\n\t\t\t};\n\n\t\t\t// Generate the key identifier\n\t\t\tconst key = (event.ctrlKey ? 'Ctrl+' : '') +\n\t\t\t\t(event.shiftKey ? 'Shift+' : '') +\n\t\t\t\t(event.altKey ? 'Alt+' : '') +\n\t\t\t\tevent.keyCode;\n\n\t\t\tif (keysToPrevent[key] || keysToPrevent[event.keyCode]) {\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t});\n\n\n\t\tfor (let row of this.number_pad.keys) {\n\t\t\tfor (let btn of row) {\n\t\t\t\tif (typeof btn !== \"string\") continue; // do not make shortcuts for numbers\n\n\t\t\t\tlet shortcut_key = `ctrl+${frappe.scrub(String(btn))[0]}`;\n\t\t\t\tif (btn === \"Delete\") shortcut_key = \"ctrl+backspace\";\n\t\t\t\tif (btn === \"Remove\") shortcut_key = \"ctrl+x\";\n\t\t\t\tif (btn === \"Quantity\") shortcut_key = \"ctrl+q\";\n\t\t\t\tif (btn === \"Rate\") shortcut_key = \"ctrl+a\";\n\t\t\t\tif (btn === \"Discount\") shortcut_key = \"ctrl+shift+d\";\n\t\t\t\tif (btn === \".\") shortcut_key = \"ctrl+>\";\n\n\t\t\t\t// to account for fieldname map\n\t\t\t\tconst fieldname = this.number_pad.fieldnames[btn]\n\t\t\t\t\t? this.number_pad.fieldnames[btn]\n\t\t\t\t\t: typeof btn === \"string\"\n\t\t\t\t\t\t? frappe.scrub(btn)\n\t\t\t\t\t\t: btn;\n\n\t\t\t\tlet shortcut_label = shortcut_key.split(\"+\").map(frappe.utils.to_title_case).join(\"+\");\n\t\t\t\tshortcut_label = frappe.utils.is_mac() ? shortcut_label.replace(\"Ctrl\", \"\u2318\") : shortcut_label;\n\t\t\t\tthis.$numpad_section\n\t\t\t\t\t.find(`.numpad-btn[data-button-value=\"${fieldname}\"]`)\n\t\t\t\t\t.attr(\"title\", shortcut_label);\n\n\t\t\t\tfrappe.ui.keys.on(`${shortcut_key}`, () => {\n\t\t\t\t\tconst cart_is_visible = this.$component.is(\":visible\");\n\t\t\t\t\tif (cart_is_visible && this.item_is_selected && this.$numpad_section.is(\":visible\")) {\n\t\t\t\t\t\tthis.$numpad_section.find(`.numpad-btn[data-button-value=\"${fieldname}\"]`).click();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\tconst ctrl_label = frappe.utils.is_mac() ? \"\u2318\" : \"Ctrl\";\n\t\tthis.$component.find(\".checkout-btn\").attr(\"title\", `${ctrl_label}+Enter`);\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: \"ctrl+enter\",\n\t\t\taction: () => this.$component.find(\".checkout-btn\").click(),\n\t\t\tcondition: () =>\n\t\t\t\tthis.$component.is(\":visible\") && !this.$totals_section.find(\".edit-cart-btn\").is(\":visible\"),\n\t\t\tdescription: __(\"Checkout Order / Submit Order / New Order\"),\n\t\t\tignore_inputs: true,\n\t\t\tpage: cur_page.page.page,\n\t\t});\n\n\n\t\tthis.$component.find(\".edit-cart-btn\").attr(\"title\", `${ctrl_label}+E`);\n\t\tfrappe.ui.keys.on(\"ctrl+e\", () => {\n\t\t\tconst item_cart_visible = this.$component.is(\":visible\");\n\t\t\tconst checkout_btn_invisible = !this.$totals_section.find(\".checkout-btn\").is(\"visible\");\n\t\t\tif (item_cart_visible && checkout_btn_invisible) {\n\t\t\t\tthis.$component.find(\".edit-cart-btn\").click();\n\t\t\t}\n\t\t});\n\t\tthis.$component.find(\".add-discount-wrapper\").attr(\"title\", `${ctrl_label}+D`);\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: \"ctrl+d\",\n\t\t\taction: () => this.$component.find(\".add-discount-wrapper\").click(),\n\t\t\tcondition: () => this.$add_discount_elem.is(\":visible\"),\n\t\t\tdescription: __(\"Add Order Discount\"),\n\t\t\tignore_inputs: true,\n\t\t\tpage: cur_page.page.page,\n\t\t});\n\t\tfrappe.ui.keys.on(\"escape\", () => {\n\t\t\tconst item_cart_visible = this.$component.is(\":visible\");\n\t\t\tif (item_cart_visible && this.discount_field && this.discount_field.parent.is(\":visible\")) {\n\t\t\t\tthis.discount_field.set_value(0);\n\t\t\t}\n\t\t});\n\n\t\t// this.doctor_field.parent.attr(\"title\", `${ctrl_label}+R`);\n\t\t// frappe.ui.keys.add_shortcut({\n\t\t// \tshortcut: \"ctrl+r\",\n\t\t// \taction: () => this.doctor_field.set_focus(),\n\t\t// \tcondition: () => this.$component.is(\":visible\"),\n\t\t// \tdescription: __(\"Doctor\"),\n\t\t// \tignore_inputs: true,\n\t\t// \tpage: cur_page.page.page,\n\t\t// });\n\n\t\tthis.customer_field.parent.attr(\"title\", `${ctrl_label}+M`);\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: \"ctrl+m\",\n\t\t\taction: () => this.customer_field.set_focus(),\n\t\t\tcondition: () => this.$component.is(\":visible\"),\n\t\t\tdescription: __(\"Customer\"),\n\t\t\tignore_inputs: true,\n\t\t\tpage: cur_page.page.page,\n\t\t});\n\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: 'ctrl+<', // Choose an appropriate shortcut key\n\t\t\taction: () => {\n\t\t\t\tthis.reset_customer_selector();\n\t\t\t},\n\t\t\tcondition: () => true, // Adjust this condition as needed\n\t\t\tdescription: __('Reset Customer Selector'),\n\t\t\tignore_inputs: true,\n\t\t\tpage: cur_page.page.page // Replace with your actual page context\n\t\t});\n\n\t}\n\n\ttoggle_item_highlight(item) {\n\t\tconst $cart_item = $(item);\n\t\tconst item_is_highlighted = $cart_item.attr(\"style\") == \"background-color:var(--gray-50);\";\n\n\t\tif (!item || item_is_highlighted) {\n\t\t\tthis.item_is_selected = false;\n\t\t\tthis.$cart_container.find(\".cart-item-wrapper\").css(\"background-color\", \"\");\n\t\t} else {\n\t\t\t$cart_item.css(\"background-color\", \"var(--control-bg)\");\n\t\t\tthis.item_is_selected = true;\n\t\t\tthis.$cart_container.find(\".cart-item-wrapper\").not(item).css(\"background-color\", \"\");\n\t\t}\n\t}\n\n\tmake_customer_selector() {\n\t\tthis.$customer_section.html(`\n\t\t\t<div class=\"customer-field\" tabindex=\"0\"></div>\n\t\t`);\n\t\tconst me = this;\n\t\tconst allowed_customer_group = this.allowed_customer_groups || [];\n\t\tlet filters = {};\n\t\tif (allowed_customer_group.length) {\n\t\t\tfilters = {\n\t\t\t\tcustomer_group: [\"in\", allowed_customer_group],\n\t\t\t};\n\t\t}\n\t\tthis.customer_field = frappe.ui.form.make_control({\n\t\t\tdf: {\n\t\t\t\tlabel: __(\"Customer\"),\n\t\t\t\tfieldtype: \"Link\",\n\t\t\t\toptions: \"Customer\",\n\t\t\t\tplaceholder: __(\"Search by customer name, phone, email.\"),\n\t\t\t\tget_query: function () {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tfilters: filters,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tonchange: function () {\n\t\t\t\t\tif (this.value) {\n\t\t\t\t\t\tconst frm = me.events.get_frm();\n\t\t\t\t\t\tfrappe.dom.freeze();\n\t\t\t\t\t\tfrappe.model.set_value(frm.doc.doctype, frm.doc.name, \"customer\", this.value);\n\t\t\t\t\t\tfrm.script_manager.trigger(\"customer\", frm.doc.doctype, frm.doc.name).then(() => {\n\t\t\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t\t\t() => me.fetch_customer_details(this.value),\n\t\t\t\t\t\t\t\t() => me.events.customer_details_updated(me.customer_info),\n\t\t\t\t\t\t\t\t() => me.update_customer_section(),\n\t\t\t\t\t\t\t\t() => frappe.dom.unfreeze(),\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\tparent: this.$customer_section.find(\".customer-field\"),\n\t\t\trender_input: true,\n\t\t});\n\t\tthis.customer_field.toggle_label(false);\n\t}\n\n\t// make_doctor_selector() {\n\t// \tthis.$doctor_section.html(`\n    //     <div class=\"doctor-field\"></div>\n    // `);\n\t// \tconst me = this;\n\t// \tconst allowed_doctor_group = this.allowed_doctor_groups || [];\n\t// \tlet filters = {};\n\t// \tif (allowed_doctor_group.length) {\n\t// \t\tfilters = {\n\t// \t\t\tdoctor_group: [\"in\", allowed_doctor_group],\n\t// \t\t};\n\t// \t}\n\n\t// \tthis.doctor_field = frappe.ui.form.make_control({\n\t// \t\tdf: {\n\t// \t\t\tlabel: __(\"Doctor\"),\n\t// \t\t\tfieldtype: \"Link\",\n\t// \t\t\toptions: \"Doctor\",\n\t// \t\t\tplaceholder: __(\"Doctor\"),\n\t// \t\t\tonchange: function () {\n\t// \t\t\t\tif (this.value) {\n\t// \t\t\t\t\tconst frm = me.events.get_frm();\n\t// \t\t\t\t\tfrappe.dom.freeze();\n\t// \t\t\t\t\tfrappe.model.set_value(frm.doc.doctype, frm.doc.name, \"custom_doctors_information\", this.value);\n\t// \t\t\t\t\tfrm.script_manager.trigger(\"custom_doctors_information\", frm.doc.doctype, frm.doc.name).then(() => {\n\t// \t\t\t\t\t\tfrappe.run_serially([\n\t// \t\t\t\t\t\t\t// () => me.fetch_customer_details(this.value),\n\t// \t\t\t\t\t\t\t// () => me.events.customer_details_updated(me.customer_info),\n\t// \t\t\t\t\t\t\t// () => me.update_customer_section(),\n\t// \t\t\t\t\t\t\t// () => me.update_totals_section(),\n\t// \t\t\t\t\t\t\t() => frappe.dom.unfreeze(),\n\t// \t\t\t\t\t\t]);\n\t// \t\t\t\t\t});\n\t// \t\t\t\t}\n\t// \t\t\t},\n\t// \t\t},\n\t// \t\tparent: this.$doctor_section.find(\".doctor-field\"),\n\t// \t\trender_input: true,\n\t// \t});\n\t// \tthis.doctor_field.toggle_label(false);\n\n\t// \t// Add shortcut key to focus on doctor field\n\t// \t$(document).on('keydown', function (event) {\n\t// \t\t// Use Alt + D as shortcut (you can change this key combination as needed)\n\t// \t\tif (event.altKey && event.key === 'd') {\n\t// \t\t\tme.doctor_field.$input.focus();\n\t// \t\t}\n\t// \t});\n\t// }\n\n\n\tfetch_customer_details(customer) {\n\t\tif (customer) {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tfrappe.db\n\t\t\t\t\t.get_value(\"Customer\", customer, [\"email_id\", \"customer_name\", \"mobile_no\" , \"image\", \"loyalty_program\",\n\t\t\t\t\t\t\"custom_osca_id\", \"custom_pwd_id\", \"customer_group\"])\n\t\t\t\t\t.then(({ message }) => {\n\t\t\t\t\t\tconst { loyalty_program } = message;\n\t\t\t\t\t\t// if loyalty program then fetch loyalty points too\n\t\t\t\t\t\tif (loyalty_program) {\n\t\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\t\tmethod: \"erpnext.accounts.doctype.loyalty_program.loyalty_program.get_loyalty_program_details_with_points\",\n\t\t\t\t\t\t\t\targs: { customer, loyalty_program, silent: true },\n\t\t\t\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\t\t\t\tconst { loyalty_points, conversion_factor } = r.message;\n\t\t\t\t\t\t\t\t\tif (!r.exc) {\n\t\t\t\t\t\t\t\t\t\tthis.customer_info = {\n\t\t\t\t\t\t\t\t\t\t\t...message,\n\t\t\t\t\t\t\t\t\t\t\tcustomer,\n\t\t\t\t\t\t\t\t\t\t\tloyalty_points,\n\t\t\t\t\t\t\t\t\t\t\tconversion_factor,\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.customer_info = { ...message, customer };\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tthis.customer_info = {};\n\t\t\t\tresolve();\n\t\t\t});\n\t\t}\n\t}\n\n\n\tfetch_doctor_details(doctor) {\n\t\tif (doctor) {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tfrappe.db\n\t\t\t\t\t.get_value(\"Doctor\", doctor, [\"first_name\", \"last_name\", \"prc_number\", \"image\"])\n\t\t\t\t\t.then(({ message }) => {\n\t\t\t\t\t\t// const { loyalty_program } = message;\n\t\t\t\t\t\t// if loyalty program then fetch loyalty points too\n\t\t\t\t\t\tthis.doctor_info = { ...message, doctor };\n\t\t\t\t\t\tconsole.log(this.doctor_info);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tthis.doctor_info = {};\n\t\t\t\tresolve();\n\t\t\t});\n\t\t}\n\t}\n\n\tshow_discount_control() {\n\t\tthis.$add_discount_elem.css({ padding: \"0px\", border: \"none\" });\n\t\tthis.$add_discount_elem.html(`<div class=\"add-discount-field\"></div>`);\n\t\tconst me = this;\n\t\tconst frm = me.events.get_frm();\n\t\tlet discount = frm.doc.additional_discount_percentage;\n\n\t\tthis.discount_field = frappe.ui.form.make_control({\n\t\t\tdf: {\n\t\t\t\tlabel: __(\"Discount\"),\n\t\t\t\tfieldtype: \"Data\",\n\t\t\t\tplaceholder: discount ? discount + \"%\" : __(\"Enter discount percentage.\"),\n\t\t\t\tinput_class: \"input-xs\",\n\t\t\t\tonchange: function () {\n\t\t\t\t\tif (flt(this.value) != 0) {\n\t\t\t\t\t\tfrappe.model.set_value(\n\t\t\t\t\t\t\tfrm.doc.doctype,\n\t\t\t\t\t\t\tfrm.doc.name,\n\t\t\t\t\t\t\t\"additional_discount_percentage\",\n\t\t\t\t\t\t\tflt(this.value)\n\t\t\t\t\t\t);\n\t\t\t\t\t\tme.hide_discount_control(this.value);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfrappe.model.set_value(\n\t\t\t\t\t\t\tfrm.doc.doctype,\n\t\t\t\t\t\t\tfrm.doc.name,\n\t\t\t\t\t\t\t\"additional_discount_percentage\",\n\t\t\t\t\t\t\t0\n\t\t\t\t\t\t);\n\t\t\t\t\t\tme.$add_discount_elem.css({\n\t\t\t\t\t\t\tborder: \"1px dashed var(--gray-500)\",\n\t\t\t\t\t\t\tpadding: \"var(--padding-sm) var(--padding-md)\",\n\t\t\t\t\t\t});\n\t\t\t\t\t\tme.$add_discount_elem.html(`${me.get_discount_icon()} ${__(\"Add Discount\")}`);\n\t\t\t\t\t\tme.discount_field = undefined;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\tparent: this.$add_discount_elem.find(\".add-discount-field\"),\n\t\t\trender_input: true,\n\t\t});\n\t\tthis.discount_field.toggle_label(false);\n\t\tthis.discount_field.set_focus();\n\t}\n\n\thide_discount_control(discount) {\n\t\tif (!discount) {\n\t\t\tthis.$add_discount_elem.css({ padding: \"0px\", border: \"none\" });\n\t\t\tthis.$add_discount_elem.html(`<div class=\"add-discount-field\"></div>`);\n\t\t} else {\n\t\t\tthis.$add_discount_elem.css({\n\t\t\t\tborder: \"1px dashed var(--dark-green-500)\",\n\t\t\t\tpadding: \"var(--padding-sm) var(--padding-md)\",\n\t\t\t});\n\t\t\tthis.$add_discount_elem.html(\n\t\t\t\t`<div class=\"edit-discount-btn\">\n\t\t\t\t\t${this.get_discount_icon()} ${__(\"Additional\")}&nbsp;${String(discount).bold()}% ${__(\"discount applied\")}\n\t\t\t\t</div>`\n\t\t\t);\n\t\t}\n\t}\n\n\tupdate_customer_section() {\n\t\tconst me = this;\n\t\tconst { customer, email_id = \"\", mobile_no = \"\", image, customer_name = \"\", customer_group = \"\" } = this.customer_info || {};\n\n\t\tif (customer) {\n\t\t\tthis.$customer_section.html(\n\t\t\t\t`<div class=\"customer-details\">\n\t\t\t\t\t<div class=\"customer-display\">\n\t\t\t\t\t\t${this.get_customer_image()}\n\t\t\t\t\t\t<div class=\"customer-name-desc\">\n\t\t\t\t\t\t\t<div class=\"customer-name\"> ${customer_name} -  ${customer_group} </div>\n\t\t\t\t\t\t\t${get_customer_description()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`\n\t\t\t);\n\t\t} else {\n\t\t\t// reset customer selector\n\t\t\tthis.reset_customer_selector();\n\t\t}\n\n\t\tfunction get_customer_description() {\n\t\t\tif (!email_id && !mobile_no) {\n\t\t\t\treturn `<div class=\"customer-desc\">${__(\"Click to add email / phone\")}</div>`;\n\t\t\t} else if (email_id && !mobile_no) {\n\t\t\t\treturn `<div class=\"customer-desc\">${email_id}</div>`;\n\t\t\t} else if (mobile_no && !email_id) {\n\t\t\t\treturn `<div class=\"customer-desc\">${mobile_no}</div>`;\n\t\t\t} else {\n\t\t\t\treturn `<div class=\"customer-desc\">${email_id} - ${mobile_no}</div>`;\n\t\t\t}\n\t\t}\n\n\n\t}\n\n\t//doctor\n\n\tupdate_doctor_section() {\n\t\tconst me = this;\n\t\tconst { doctor, first_name = \"\", last_name = \"\", prc_number = \"\", image } = this.doctor_info || {};\n\n\t\tif (doctor) {\n\t\t\tthis.$doctor_section.html(\n\t\t\t\t`<div class=\"doctor-details\">\n\t\t\t\t\t<div class=\"doctor-display\">\n\t\t\t\t\t\t${this.get_doctor_image()}\n\t\t\t\t\t\t<div class=\"doctor-name-desc\">\n\t\t\t\t\t\t\t<div class=\"doctor-name\">${doctor}</div>\n\t\t\t\t\t\t\t${get_doctor_description()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"reset-doctors-btn\" data-doctors=\"${escape(doctors)}\">\n\t\t\t\t\t\t\t<svg width=\"32\" height=\"32\" viewBox=\"0 0 14 14\" fill=\"none\">\n\t\t\t\t\t\t\t\t<path d=\"M4.93764 4.93759L7.00003 6.99998M9.06243 9.06238L7.00003 6.99998M7.00003 6.99998L4.93764 9.06238L9.06243 4.93759\" stroke=\"#8D99A6\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>`\n\t\t\t);\n\t\t} else {\n\t\t\t// reset doctor selector\n\t\t\tthis.reset_doctor_selector();\n\t\t}\n\n\t\tfunction get_doctor_description() {\n\t\t\tif (!email_id && !mobile_no) {\n\t\t\t\treturn `<div class=\"doctor-desc\">${__(\"Click to add email / phone\")}</div>`;\n\t\t\t} else if (email_id && !mobile_no) {\n\t\t\t\treturn `<div class=\"doctor-desc\">${email_id}</div>`;\n\t\t\t} else if (mobile_no && !email_id) {\n\t\t\t\treturn `<div class=\"doctor-desc\">${mobile_no}</div>`;\n\t\t\t} else {\n\t\t\t\treturn `<div class=\"doctorvv-desc\">${email_id} - ${mobile_no}</div>`;\n\t\t\t}\n\t\t}\n\n\t}\n\n\tget_customer_image() {\n\t\tconst { customer, image } = this.customer_info || {};\n\t\tif (image) {\n\t\t\treturn `<div class=\"customer-image\"><img src=\"${image}\" alt=\"${image}\"\"></div>`;\n\t\t} else {\n\t\t\treturn `<div class=\"customer-image customer-abbr\">${frappe.get_abbr(customer)}</div>`;\n\t\t}\n\t}\n\n\tget_doctor_image() {\n\t\tconst { doctor, image } = this.doctor_info || {};\n\t\tif (image) {\n\t\t\treturn `<div class=\"doctor-image\"><img src=\"${image}\" alt=\"${image}\"\"></div>`;\n\t\t} else {\n\t\t\treturn `<div class=\"doctor-image doctor-abbr\">${frappe.get_abbr(doctor)}</div>`;\n\t\t}\n\t}\n\n\tupdate_totals_section(frm) {\n\t\tif (!frm) frm = this.events.get_frm();\n\t\t// console.log(frm.doc);\n\t\t\n\t\tthis.render_vatable_sales(frm.doc.custom_vatable_sales);\n\t\tthis.render_vat_exempt_sales(frm.doc.custom_vat_exempt_sales);\n\t\tthis.render_zero_rated_sales(frm.doc.custom_zero_rated_sales);\n\t\t// this.render_vat(frm.doc.custom_vat_amount)\n\t\t// this.render_ex_total(frm.doc.custom_ex_total)\n\t\tthis.render_net_total(frm.doc.net_total);\n\t\tthis.render_total_item_qty(frm.doc.items);\n\n\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t? frm.doc.grand_total\n\t\t\t: frm.doc.rounded_total;\n\t\t\t\n\t\tthis.render_grand_total(grand_total);\n\t\t// this.render_taxes(frm.doc.taxes);\n\t\tthis.render_total_vat(frm.doc.total_taxes_and_charges);\n\t}\n\n\trender_net_total(value) {\n\t\tconst currency = this.events.get_frm().doc.currency;\n\t\tthis.$totals_section\n\t\t\t.find(\".net-total-container\")\n\t\t\t.html(`<div style=\"font-size:12px;\">${__(\"Sub Total\")}</div> <div>${format_currency(value, currency)}</div>`);\n\n\t\tthis.$numpad_section\n\t\t\t.find(\".numpad-net-total\")\n\t\t\t.html(`<div>${__(\"Sub Total\")}: <span>${format_currency(value, currency)}</span></div>`);\n\t}\n\n\trender_vatable_sales(value) {\n\t\tconst currency = this.events.get_frm().doc.currency;\n\t\tthis.$totals_section\n\t\t\t.find(\".vatable-sales-container\")\n\t\t\t.html(`\n\t\t\t\t<div style=\"display: flex; align-items: center; width: 100%; font-size:12px;\">\n\t\t\t\t\t<span style=\"flex: 1;\">\n\t\t\t\t\t\t${__(\"VATable Sales\")}: \n\t\t\t\t\t</span>\n\t\t\t\t\t<span style=\"flex-shrink: 0;  \">${format_currency(value, currency)}</span>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`);\n\t}\n\t\n\n\trender_vat_exempt_sales(value) {\n\t\tconst currency = this.events.get_frm().doc.currency;\n\t\tthis.$totals_section\n\t\t\t.find(\".vat-exempt-container\")\n\t\t\t.html(`\n\t\t\t\t<div style=\"display: flex; align-items: center; width: 100%; font-size:12px;\">\n\t\t\t\t\t<span style=\"flex: 1;\">\n\t\t\t\t\t\t${__(\"VAT-Exempt Sales\")}: \n\t\t\t\t\t</span>\n\t\t\t\t\t<span style=\"flex-shrink: 0;\">${format_currency(value, currency)}</span>\n\t\t\t\t</div>\n\t\t\t`);\n\t}\n\n\trender_zero_rated_sales(value) {\n\t\tconst currency = this.events.get_frm().doc.currency;\n\t\tthis.$totals_section\n\t\t\t.find(\".zero-rated-container\")\n\t\t\t.html(`\n\t\t\t\t<div style=\"display: flex; align-items: center; width: 100%; font-size:12px;\">\n\t\t\t\t\t<span style=\"flex: 1;\">\n\t\t\t\t\t\t${__(\"Zero Rated Sales\")}: \n\t\t\t\t\t</span>\n\t\t\t\t\t<span style=\"flex-shrink: 0;\">${format_currency(value, currency)}</span>\n\t\t\t\t</div>\n\t\t\t`);\n\t}\n\n\trender_vat(value) {\n\t\tconst currency = this.events.get_frm().doc.currency;\n\t\tthis.$totals_section\n\t\t\t.find(\".vat-container\")\n\t\t\t.html(`\n\t\t\t\t<div style=\"display: flex; align-items: center; width: 100%; font-size:12px;\">\n\t\t\t\t\t<span style=\"flex: 1;\">\n\t\t\t\t\t\t${__(\"VAT 12%\")}:\n\t\t\t\t\t</span>\n\t\t\t\t\t<span style=\"flex-shrink: 0;\">${format_currency(value, currency)}</span>\n\t\t\t\t</div>\n\t\t\t`);\n\t}\n\n\trender_total_vat(value) {\n\t\tconst currency = this.events.get_frm().doc.currency;\n\t\tthis.$totals_section\n\t\t\t.find(\".total-vat-container\")\n\t\t\t.html(`\n\t\t\t\t<div style=\"display: flex; justify-content: space-between; font-size:12px;\">\n\t\t\t\t\t<span style=\"flex: 1;\">${__(\"Total VAT\")}: </span>\n\t\t\t\t\t<span style=\"flex-shrink: 0;\">${format_currency(value, currency)}</span>\n\t\t\t\t</div>\n\t\t\t`);\n\t}\n\n\trender_ex_total(value) {\n\t\tconst currency = this.events.get_frm().doc.currency;\n\t\tthis.$totals_section\n\t\t\t.find(\".ex-total-container\")\n\t\t\t.html(`\n\t\t\t\t<div style=\"display: flex; align-items: center; width: 100%; font-size:10px;>\n\t\t\t\t\t<span style=\"flex: 1;\">\n\t\t\t\t\t\t${__(\"Ex Total\")}: \n\t\t\t\t\t</span>\n\t\t\t\t\t<span style=\"flex-shrink: 0;\">${format_currency(value, currency)}</span>\n\t\t\t\t</div>\n\t\t\t`);\n\t}\n\n\n\trender_total_item_qty(items) {\n\t\tvar total_item_qty = 0;\n\t\titems.map((item) => {\n\t\t\ttotal_item_qty = total_item_qty + item.qty;\n\t\t});\n\n\t\tthis.$totals_section\n\t\t\t.find(\".item-qty-total-container\")\n\t\t\t.html(`<div>${__(\"Total Quantity\")}</div><div>${total_item_qty}</div>`);\n\n\t\tthis.$numpad_section\n\t\t\t.find(\".numpad-item-qty-total\")\n\t\t\t.html(`<div>${__(\"Total Quantity\")}: <span>${total_item_qty}</span></div>`);\n\t}\n\n\trender_grand_total(value) {\n\t\tconst currency = this.events.get_frm().doc.currency;\n\t\tthis.$totals_section\n\t\t\t.find(\".grand-total-container\")\n\t\t\t.html(`<div style=\"font-size:14px;\">${__(\"Total\")}</div><div>${format_currency(value, currency)}</div>`);\n\n\t\tthis.$numpad_section\n\t\t\t.find(\".numpad-grand-total\")\n\t\t\t.html(`<div>${__(\"Total\")}: <span>${format_currency(value, currency)}</span></div>`);\n\t}\n\n\n\trender_taxes(taxes) {\n\t\tif (taxes && taxes.length) {\n\t\t\tconst currency = this.events.get_frm().doc.currency;\n\t\t\tconst taxes_html = taxes\n\t\t\t\t.map((t) => {\n\t\t\t\t\tif (t.tax_amount_after_discount_amount == 0.0) return;\n\t\t\t\t\t// if tax rate is 0, don't print it.\n\t\t\t\t\tconst description = /[0-9]+/.test(t.description)\n\t\t\t\t\t\t? t.description\n\t\t\t\t\t\t: t.rate != 0\n\t\t\t\t\t\t\t? `${t.description} ${t.rate}%`\n\t\t\t\t\t\t\t: t.description;\n\t\t\t\t\treturn `<div class=\"tax-row\">\n\t\t\t\t\t<div class=\"tax-label\">${description}</div>\n\t\t\t\t\t<div class=\"tax-value\">${format_currency(t.tax_amount_after_discount_amount, currency)}</div>\n\t\t\t\t</div>`;\n\t\t\t\t})\n\t\t\t\t.join(\"\");\n\t\t\tthis.$totals_section.find(\".taxes-container\").css(\"display\", \"flex\").html(taxes_html);\n\t\t} else {\n\t\t\tthis.$totals_section.find(\".taxes-container\").css(\"display\", \"none\").html(\"\");\n\t\t}\n\t}\n\n\n\n\n\n\tget_cart_item({ name }) {\n\t\tconst item_selector = `.cart-item-wrapper[data-row-name=\"${escape(name)}\"]`;\n\t\treturn this.$cart_items_wrapper.find(item_selector);\n\t}\n\n\tget_item_from_frm(item) {\n\t\tconst doc = this.events.get_frm().doc;\n\t\treturn doc.items.find((i) => i.name == item.name);\n\t}\n\n\tupdate_item_html(item, remove_item) {\n\t\tconst $item = this.get_cart_item(item);\n\t\t// Retrieve current cart items from local storage\n\t\tlet cartItems = JSON.parse(localStorage.getItem('posCartItems')) || [];\n\n\t\tif (remove_item) {\n\t\t\tif ($item) {\n\t\t\t\t$item.next().remove();\n\t\t\t\t$item.remove();\n\n\t\t\t\t// Remove the item from the local storage cart items\n\t\t\t\tcartItems = cartItems.filter(cartItem => cartItem.item_code !== item.item_code);\n\n\t\t\t\tlocalStorage.setItem('posCartItems', JSON.stringify(cartItems));\n\n\t\t\t\tthis.remove_customer(); // Call remove_customer function after removing item\n\t\t\t\tthis.set_cash_customer(); // Set customer to \"Cash\" after removing item\n\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t() => frappe.dom.unfreeze(),\n\t\t\t\t]);\n\t\t\t}\n\t\t} else {\n\t\t\tconst item_row = this.get_item_from_frm(item);\n\n\t\t\tthis.render_cart_item(item_row, $item);\n\n\t\t\t// Add or update the item in the local storage cart items\n\t\t\tconst existingItemIndex = cartItems.findIndex(cartItem => cartItem.item_code === item.item_code);\n\t\t\tif (existingItemIndex > -1) {\n\t\t\t\tcartItems[existingItemIndex] = item; // Update existing item\n\t\t\t} else {\n\t\t\t\tcartItems.push(item); // Add new item\n\t\t\t}\n\t\t\tlocalStorage.setItem('posCartItems', JSON.stringify(cartItems));\n\t\t\t// console.log('cartItems', cartItems)\n\t\t}\n\n\t\tconst no_of_cart_items = this.$cart_items_wrapper.find(\".cart-item-wrapper\").length;\n\t\tthis.highlight_checkout_btn(no_of_cart_items > 0);\n\t\tthis.update_empty_cart_section(no_of_cart_items);\n\t}\n\n\n\tremove_customer() {\n\t\tconst frm = this.events.get_frm();\n\t\t// Get the current value of the \"customer\" field\n\t\tconst currentCustomer = frm.doc.customer;\n\n\t\t// Set the value of \"custom_customer_2\" to the current customer\n\t\tfrappe.model.set_value(frm.doc.doctype, frm.doc.name, \"custom_customer_2\", currentCustomer);\n\n\t\t// Clear the \"customer\" field\n\t\tfrappe.model.set_value(frm.doc.doctype, frm.doc.name, \"customer\", '');\n\t\t// Update the customer section\n\t\tthis.update_customer_section();\n\t}\n\n\tset_cash_customer() {\n\t\tconst frm = this.events.get_frm();\n\t\t// Get the value of \"custom_customer_2\"\n\t\tconst customCustomer2Value = frm.doc.custom_customer_2;\n\n\t\t// Set the value of \"customer\" to the value of \"custom_customer_2\"\n\t\tfrappe.model.set_value(frm.doc.doctype, frm.doc.name, \"customer\", customCustomer2Value);\n\n\t\t// Update the customer section\n\t\tthis.update_customer_section();\n\t}\n\n\trender_cart_item(item_data, $item_to_update) {\n\n\t\t// console.log(\"Item Data: \",item_data)\n\n\t\tconst currency = this.events.get_frm().doc.currency;\n\t\tconst me = this;\n\t\tconst customer_group = me.events.get_frm().doc.customer_group\n\t\tconst tax_rate = 0.12;\n\t\tconst no_vat = item_data.price_list_rate / (1 + tax_rate);\n\n\t\t// const item_doc = frappe.get_doc('Item', item_data.item_name)\n\t\t// console.log(\"Item Doc: \", item_doc);\n\n\t\tif (!$item_to_update.length) {\n\t\t\tthis.$cart_items_wrapper.append(\n\t\t\t\t`<div class=\"cart-item-wrapper\" tabindex=\"0\" data-row-name=\"${escape(item_data.name)}\" style=\"font-size: 12px; padding: 5px;\">\n\t\t\t\t\t<div class=\"separator\" style=\"height: 0.8px; background-color: #e0e0e0; margin: 4px 0;\"></div>`\n\t\t\t);\n\t\t\t$item_to_update = this.get_cart_item(item_data);\n\t\t}\n\t\t\n\t\t$item_to_update.html(\n\t\t\t`${get_item_image_html()}\n\t\t\t<div class=\"item-name-desc\" style=\"font-size: 10px;\">\n\t\t\t\t<div class=\"item-name\" style=\"font-size: 12px;\">\n\t\t\t\t\t${item_data.item_name}\n\t\t\t\t</div>\n\t\t\t\t${get_description_html()}\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class=\"item-vat mx-3\" style=\"font-size: 10px;\">\n\t\t\t\t<strong>${getVatType(item_data)}</strong>\n\t\t\t</div> \n\t\t\t\n\t\t\t<div class=\"item-vat mx-3\" style=\"font-size: 10px;\">\n\t\t\t\t<strong>${format_currency(item_data.price_list_rate, currency)}</strong>\n\t\t\t</div>\n\t\t\t\n\t\t\t<div class=\"item-discount mx-3\" style=\"font-size: 10px;\">\n\t\t\t\t<strong>${Math.round(item_data.discount_percentage)}%</strong>\n\t\t\t</div>\n\t\t\t${get_rate_discount_html(customer_group)}`\n\t\t);\n\t\t\n\n\t\tset_dynamic_rate_header_width();\n\n\t\tfunction set_dynamic_rate_header_width() {\n\t\t\tconst rate_cols = Array.from(me.$cart_items_wrapper.find(\".item-rate-amount\"));\n\t\t\tme.$cart_header.find(\".rate-amount-header\").css(\"width\", \"\");\n\t\t\tme.$cart_items_wrapper.find(\".item-rate-amount\").css(\"width\", \"\");\n\t\t\tlet max_width = rate_cols.reduce((max_width, elm) => {\n\t\t\t\tif ($(elm).width() > max_width) max_width = $(elm).width();\n\t\t\t\treturn max_width;\n\t\t\t}, 0);\n\n\t\t\tmax_width += 1;\n\t\t\tif (max_width === 1) max_width = \"\";\n\n\t\t\tme.$cart_header.find(\".rate-amount-header\").css(\"width\", max_width);\n\t\t\tme.$cart_items_wrapper.find(\".item-rate-amount\").css(\"width\", max_width);\n\t\t}\n\n\t\tfunction getVatType(item_data) {\n\t\t\tif (item_data.custom_vat_exempt_amount && item_data.custom_vat_exempt_amount != 0) {\n\t\t\t\treturn 'VAT-E';\n\t\t\t} else if (item_data.custom_vatable_amount && item_data.custom_vatable_amount != 0) {\n\t\t\t\treturn 'VAT';\n\t\t\t} else if (item_data.custom_zero_rated_amount && item_data.custom_zero_rated_amount != 0) {\n\t\t\t\treturn 'ZR';\n\t\t\t}else if (item_data.custom_free === 1) {\n\t\t\t\t\treturn 'FREE';\n\t\t\t\t\n\t\t\t} else {\n\n\t\t\t\treturn 'Unknown';\n\t\t\t}\n\t\t}\n\n\t\tfunction get_rate_discount_html(customer_group) {\n\n\n\t\t\tif (customer_group === \"Zero Rated\") {\n\n\t\t\t\treturn `\n\t\t\t\t\t\t<div class=\"item-qty-rate\">\n\t\t\t\t\t\t\t<div class=\"item-qty\" style=\"font-size:10px;\"><span>${item_data.qty || 0} ${item_data.uom}</span></div>\n\t\t\t\t\t\t\t<div class=\"item-rate-amount\">\n\t\t\t\t\t\t\t\t<div class=\"item-rate\" style=\"font-size:11px;\">${format_currency(item_data.custom_zero_rated_amount, currency)}</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`;\n\n\n\n\t\t\t} else if (customer_group === \"Senior Citizen\" || customer_group === \"PWD\") {\n\n\t\t\t\treturn `\n\t\t\t\t\t<div class=\"item-qty-rate\">\n\t\t\t\t\t\t<div class=\"item-qty\" style=\"font-size:10px;\"><span>${item_data.qty || 0} ${item_data.uom}</span></div>\n\t\t\t\t\t\t<div class=\"item-rate-amount\">\n\t\t\t\t\t\t\t<div class=\"item-rate\" style=\"font-size:11px;\">${format_currency(item_data.amount, currency)}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>`;\n\t\t\t} else {\n\t\t\t\tif (item_data.rate && item_data.amount && item_data.rate !== item_data.amount) {\n\t\t\t\t\treturn `\n\t\t\t\t\t\t<div class=\"item-qty-rate\">\n\t\t\t\t\t\t\t<div class=\"item-qty\" style=\"font-size:10px;\"><span>${item_data.qty || 0} ${item_data.uom}</span></div>\n\t\t\t\t\t\t\t<div class=\"item-rate-amount\">\n\t\t\t\t\t\t\t\t<div class=\"item-rate\" style=\"font-size:11px;\">${format_currency(item_data.amount, currency)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`;\n\t\t\t\t} else {\n\t\t\t\t\treturn `\n\t\t\t\t\t\t<div class=\"item-qty-rate\">\n\t\t\t\t\t\t\t<div class=\"item-qty\" style=\"font-size:10px;\"><span>${item_data.qty || 0} ${item_data.uom}</span></div>\n\t\t\t\t\t\t\t<div class=\"item-rate-amount\">\n\t\t\t\t\t\t\t\t<div class=\"item-rate\" style=\"font-size:11px;\">${format_currency(item_data.rate, currency)}</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfunction get_description_html() {\n\t\t\tif (item_data.description) {\n\t\t\t\tif (item_data.description.indexOf(\"<div>\") !== -1) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\titem_data.description = $(item_data.description).text();\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\titem_data.description = item_data.description\n\t\t\t\t\t\t\t.replace(/<div>/g, \" \")\n\t\t\t\t\t\t\t.replace(/<\\/div>/g, \" \")\n\t\t\t\t\t\t\t.replace(/ +/g, \" \");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\titem_data.description = frappe.ellipsis(item_data.description, 45);\n\t\t\t\treturn `<div class=\"item-desc\" style=\"font-size:10px;\">${item_data.description}</div>`;\n\t\t\t}\n\t\t\treturn ``;\n\t\t}\n\n\t\tfunction get_item_image_html() {\n\t\t\tconst { image, item_name } = item_data;\n\t\t\tif (!me.hide_images && image) {\n\t\t\t\treturn `\n\t\t\t\t\t<div class=\"item-image\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tonerror=\"cur_pos.cart.handle_broken_image(this)\"\n\t\t\t\t\t\t\tsrc=\"${image}\" alt=\"${frappe.get_abbr(item_name)}\">\n\t\t\t\t\t</div>`;\n\t\t\t} else {\n\t\t\t\treturn `<div class=\"item-image item-abbr\">${frappe.get_abbr(item_name)}</div>`;\n\t\t\t}\n\t\t}\n\n\t\t// Event listener for handling keydown events on cart items\n\t\tthis.$cart_items_wrapper.off('keydown', '.cart-item-wrapper').on('keydown', '.cart-item-wrapper', function (event) {\n\t\t\tconst $items = me.$cart_items_wrapper.find('.cart-item-wrapper');\n\t\t\tconst currentIndex = $items.index($(this));\n\t\t\tlet nextIndex = currentIndex;\n\n\t\t\tswitch (event.which) {\n\t\t\t\tcase 13: // Enter key\n\t\t\t\t\t$(this).click(); // Trigger click event immediately on Enter key press\n\t\t\t\t\tbreak;\n\t\t\t\tcase 38: // Up arrow key\n\t\t\t\t\tnextIndex = currentIndex > 0 ? currentIndex - 1 : $items.length - 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 40: // Down arrow key\n\t\t\t\t\tnextIndex = currentIndex < $items.length - 1 ? currentIndex + 1 : 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn; // Exit if other keys are pressed\n\t\t\t}\n\n\t\t\t$items.eq(nextIndex).focus(); // Move focus to the next item\n\t\t});\n\n\t\t// Add Ctrl+C shortcut to focus on the first cart item\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: 'ctrl+c',\n\t\t\taction: () => {\n\t\t\t\tconst $items = me.$cart_items_wrapper.find('.cart-item-wrapper');\n\t\t\t\tif ($items.length) {\n\t\t\t\t\t$items.first().focus(); // Focus on the first cart item\n\t\t\t\t}\n\t\t\t},\n\t\t\tcondition: () => me.$cart_items_wrapper.is(':visible'),\n\t\t\tdescription: __('Activate Cart Item Focus'),\n\t\t\tignore_inputs: true,\n\t\t\tpage: cur_page.page.page // Replace with your actual page context\n\t\t});\n\t}\n\n\n\n\thandle_broken_image($img) {\n\t\tconst item_abbr = $($img).attr(\"alt\");\n\t\t$($img).parent().replaceWith(`<div class=\"item-image item-abbr\">${item_abbr}</div>`);\n\t}\n\n\tupdate_selector_value_in_cart_item(selector, value, item) {\n\t\tconst $item_to_update = this.get_cart_item(item);\n\t\t$item_to_update.attr(`data-${selector}`, escape(value));\n\t}\n\n\ttoggle_checkout_btn(show_checkout) {\n\t\tif (show_checkout) {\n\t\t\tthis.$totals_section.find(\".checkout-btn\").css(\"display\", \"flex\");\n\t\t\tthis.$totals_section.find(\".edit-cart-btn\").css(\"display\", \"none\");\n\t\t} else {\n\t\t\tthis.$totals_section.find(\".checkout-btn\").css(\"display\", \"none\");\n\t\t\tthis.$totals_section.find(\".edit-cart-btn\").css(\"display\", \"flex\");\n\t\t}\n\t}\n\n\thighlight_checkout_btn(toggle) {\n\t\tif (toggle) {\n\t\t\tthis.$add_discount_elem.css(\"display\", \"flex\");\n\t\t\tthis.$cart_container.find(\".checkout-btn\").css({\n\t\t\t\t\"background-color\": \"var(--blue-500)\",\n\t\t\t});\n\t\t} else {\n\t\t\tthis.$add_discount_elem.css(\"display\", \"none\");\n\t\t\tthis.$cart_container.find(\".checkout-btn\").css({\n\t\t\t\t\"background-color\": \"var(--blue-200)\",\n\t\t\t});\n\t\t}\n\t}\n\n\tupdate_empty_cart_section(no_of_cart_items) {\n\t\tconst $no_item_element = this.$cart_items_wrapper.find(\".no-item-wrapper\");\n\n\t\t// if cart has items and no item is present\n\t\tno_of_cart_items > 0 &&\n\t\t\t$no_item_element &&\n\t\t\t$no_item_element.remove() &&\n\t\t\tthis.$cart_header.css(\"display\", \"flex\");\n\n\t\tno_of_cart_items === 0 && !$no_item_element.length && this.make_no_items_placeholder();\n\t}\n\n\ton_numpad_event($btn) {\n\t\tconst current_action = $btn.attr(\"data-button-value\");\n\t\tconst action_is_field_edit = [\"qty\", \"discount_percentage\", \"rate\"].includes(current_action);\n\t\tconst action_is_allowed = action_is_field_edit\n\t\t\t? (current_action == \"rate\" && this.allow_rate_change) ||\n\t\t\t(current_action == \"discount_percentage\" && this.allow_discount_change) ||\n\t\t\tcurrent_action == \"qty\"\n\t\t\t: true;\n\n\t\tconst action_is_pressed_twice = this.prev_action === current_action;\n\t\tconst first_click_event = !this.prev_action;\n\t\tconst field_to_edit_changed = this.prev_action && this.prev_action != current_action;\n\n\t\tif (action_is_field_edit) {\n\t\t\tif (!action_is_allowed) {\n\t\t\t\tconst label = current_action == \"rate\" ? \"Rate\".bold() : \"Discount\".bold();\n\t\t\t\tconst message = __(\"Editing {0} is not allowed as per POS Profile settings\", [label]);\n\t\t\t\tfrappe.show_alert({\n\t\t\t\t\tindicator: \"red\",\n\t\t\t\t\tmessage: message,\n\t\t\t\t});\n\t\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (first_click_event || field_to_edit_changed) {\n\t\t\t\tthis.prev_action = current_action;\n\t\t\t} else if (action_is_pressed_twice) {\n\t\t\t\tthis.prev_action = undefined;\n\t\t\t}\n\t\t\tthis.numpad_value = \"\";\n\t\t} else if (current_action === \"checkout\") {\n\t\t\tthis.prev_action = undefined;\n\t\t\tthis.toggle_item_highlight();\n\t\t\tthis.events.numpad_event(undefined, current_action);\n\t\t\treturn;\n\t\t} else if (current_action === \"remove\") {\n\t\t\tthis.prev_action = undefined;\n\t\t\tthis.toggle_item_highlight();\n\t\t\tthis.events.numpad_event(undefined, current_action);\n\t\t\treturn;\n\t\t} else {\n\t\t\tthis.numpad_value =\n\t\t\t\tcurrent_action === \"delete\"\n\t\t\t\t\t? this.numpad_value.slice(0, -1)\n\t\t\t\t\t: this.numpad_value + current_action;\n\t\t\tthis.numpad_value = this.numpad_value || 0;\n\t\t}\n\n\t\tconst first_click_event_is_not_field_edit = !action_is_field_edit && first_click_event;\n\n\t\tif (first_click_event_is_not_field_edit) {\n\t\t\tfrappe.show_alert({\n\t\t\t\tindicator: \"red\",\n\t\t\t\tmessage: __(\"Please select a field to edit from numpad\"),\n\t\t\t});\n\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (flt(this.numpad_value) > 100 && this.prev_action === \"discount_percentage\") {\n\t\t\tfrappe.show_alert({\n\t\t\t\tmessage: __(\"Discount cannot be greater than 100%\"),\n\t\t\t\tindicator: \"orange\",\n\t\t\t});\n\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\tthis.numpad_value = current_action;\n\t\t}\n\n\t\tthis.highlight_numpad_btn($btn, current_action);\n\t\tthis.events.numpad_event(this.numpad_value, this.prev_action);\n\t}\n\n\thighlight_numpad_btn($btn, curr_action) {\n\t\tconst curr_action_is_highlighted = $btn.hasClass(\"highlighted-numpad-btn\");\n\t\tconst curr_action_is_action = [\"qty\", \"discount_percentage\", \"rate\", \"done\"].includes(curr_action);\n\n\t\tif (!curr_action_is_highlighted) {\n\t\t\t$btn.addClass(\"highlighted-numpad-btn\");\n\t\t}\n\t\tif (this.prev_action === curr_action && curr_action_is_highlighted) {\n\t\t\t// if Qty is pressed twice\n\t\t\t$btn.removeClass(\"highlighted-numpad-btn\");\n\t\t}\n\t\tif (this.prev_action && this.prev_action !== curr_action && curr_action_is_action) {\n\t\t\t// Order: Qty -> Rate then remove Qty highlight\n\t\t\tconst prev_btn = $(`[data-button-value='${this.prev_action}']`);\n\t\t\tprev_btn.removeClass(\"highlighted-numpad-btn\");\n\t\t}\n\t\tif (!curr_action_is_action || curr_action === \"done\") {\n\t\t\t// if numbers are clicked\n\t\t\tsetTimeout(() => {\n\t\t\t\t$btn.removeClass(\"highlighted-numpad-btn\");\n\t\t\t}, 200);\n\t\t}\n\t}\n\n\ttoggle_numpad(show) {\n\t\tif (show) {\n\t\t\tthis.$totals_section.css(\"display\", \"none\");\n\t\t\tthis.$numpad_section.css(\"display\", \"flex\");\n\t\t} else {\n\t\t\tthis.$totals_section.css(\"display\", \"flex\");\n\t\t\tthis.$numpad_section.css(\"display\", \"none\");\n\t\t}\n\t\tthis.reset_numpad();\n\t}\n\n\treset_numpad() {\n\t\tthis.numpad_value = \"\";\n\t\tthis.prev_action = undefined;\n\t\tthis.$numpad_section.find(\".highlighted-numpad-btn\").removeClass(\"highlighted-numpad-btn\");\n\t}\n\n\ttoggle_numpad_field_edit(fieldname) {\n\t\tif ([\"qty\", \"discount_percentage\", \"rate\"].includes(fieldname)) {\n\t\t\tthis.$numpad_section.find(`[data-button-value=\"${fieldname}\"]`).click();\n\t\t}\n\t}\n\n\ttoggle_customer_info(show) {\n\t\tif (show) {\n\t\t\tconst { customer } = this.customer_info || {};\n\n\t\t\tthis.$cart_container.css(\"display\", \"none\");\n\t\t\tthis.$customer_section.css({\n\t\t\t\theight: \"100%\",\n\t\t\t\t\"padding-top\": \"0px\",\n\t\t\t});\n\t\t\tthis.$customer_section.find(\".customer-details\").html(\n\t\t\t\t`<div class=\"header\">\n\t\t\t\t\t<div class=\"label\">Contact Details</div>\n\t\t\t\t\t<div class=\"close-details-btn\">\n\t\t\t\t\t\t<svg width=\"32\" height=\"32\" viewBox=\"0 0 14 14\" fill=\"none\">\n\t\t\t\t\t\t\t<path d=\"M4.93764 4.93759L7.00003 6.99998M9.06243 9.06238L7.00003 6.99998M7.00003 6.99998L4.93764 9.06238L9.06243 4.93759\" stroke=\"#8D99A6\"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"customer-display\">\n\t\t\t\t\t${this.get_customer_image()}\n\t\t\t\t\t<div class=\"customer-name-desc\">\n\t\t\t\t\t\t<div class=\"customer-name\">${customer}</div>\n\t\t\t\t\t\t<div class=\"customer-desc\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"customer-fields-container\">\n\t\t\t\t\t<div class=\"email_id-field\"></div>\n\t\t\t\t\t<div class=\"mobile_no-field\"></div>\n\t\t\t\t\t<div class=\"custom_osca_id-field\"></div>\n\t\t\t\t\t<div class=\"custom_pwd_id-field\"></div>\n\t\t\t\t\t<div class=\"loyalty_program-field\"></div>\n\t\t\t\t\t<div class=\"loyalty_points-field\"></div>\n\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div class=\"transactions-label\">Recent Transactions</div>`\n\t\t\t);\n\t\t\t// transactions need to be in diff div from sticky elem for scrolling\n\t\t\tthis.$customer_section.append(`<div class=\"customer-transactions\"></div>`);\n\n\t\t\tthis.render_customer_fields();\n\t\t\tthis.fetch_customer_transactions();\n\t\t} else {\n\t\t\tthis.$cart_container.css(\"display\", \"flex\");\n\t\t\tthis.$customer_section.css({\n\t\t\t\theight: \"\",\n\t\t\t\t\"padding-top\": \"\",\n\t\t\t});\n\n\t\t\tthis.update_customer_section();\n\t\t}\n\t}\n\n\trender_customer_fields() {\n\t\tconst $customer_form = this.$customer_section.find(\".customer-fields-container\");\n\n\t\tconst dfs = [\n\t\t\t{\n\t\t\t\tfieldname: \"email_id\",\n\t\t\t\tlabel: __(\"Email\"),\n\t\t\t\tfieldtype: \"Data\",\n\t\t\t\toptions: \"email\",\n\t\t\t\tplaceholder: __(\"Enter customer's email\"),\n\t\t\t},\n\t\t\t{\n\t\t\t\tfieldname: \"mobile_no\",\n\t\t\t\tlabel: __(\"Phone Number\"),\n\t\t\t\tfieldtype: \"Data\",\n\t\t\t\tplaceholder: __(\"Enter customer's phone number\"),\n\t\t\t},\n\t\t\t{\n\t\t\t\tfieldname: \"loyalty_program\",\n\t\t\t\tlabel: __(\"Loyalty Program\"),\n\t\t\t\tfieldtype: \"Link\",\n\t\t\t\toptions: \"Loyalty Program\",\n\t\t\t\tplaceholder: __(\"Select Loyalty Program\"),\n\t\t\t},\n\n\t\t\t{\n\t\t\t\tfieldname: \"loyalty_points\",\n\t\t\t\tlabel: __(\"Loyalty Points\"),\n\t\t\t\tfieldtype: \"Data\",\n\t\t\t\tread_only: 1,\n\t\t\t},\n\n\t\t\t{\n\t\t\t\tfieldname: \"custom_osca_id\",\n\t\t\t\tlabel: __(\"OSCA ID\"),\n\t\t\t\tfieldtype: \"Data\",\n\t\t\t\tread_only: 1,\n\t\t\t},\n\t\t\t{\n\t\t\t\tfieldname: \"custom_pwd_id\",\n\t\t\t\tlabel: __(\"PWD ID\"),\n\t\t\t\tfieldtype: \"Data\",\n\t\t\t\tread_only: 1,\n\t\t\t},\n\n\t\t];\n\n\t\tconst me = this;\n\t\tdfs.forEach((df) => {\n\t\t\tthis[`customer_${df.fieldname}_field`] = frappe.ui.form.make_control({\n\t\t\t\tdf: { ...df, onchange: handle_customer_field_change },\n\t\t\t\tparent: $customer_form.find(`.${df.fieldname}-field`),\n\t\t\t\trender_input: true,\n\t\t\t});\n\t\t\tthis[`customer_${df.fieldname}_field`].set_value(this.customer_info[df.fieldname]);\n\t\t});\n\n\n\n\t\tfunction handle_customer_field_change() {\n\t\t\tconst current_value = me.customer_info[this.df.fieldname];\n\t\t\tconst current_customer = me.customer_info.customer;\n\n\t\t\tif (this.value && current_value != this.value && this.df.fieldname != \"loyalty_points\") {\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_app.customapp.page.amesco_point_of_sale.amesco_point_of_sale.set_customer_info\",\n\t\t\t\t\targs: {\n\t\t\t\t\t\tfieldname: this.df.fieldname,\n\t\t\t\t\t\tcustomer: current_customer,\n\t\t\t\t\t\tvalue: this.value,\n\t\t\t\t\t},\n\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\tif (!r.exc) {\n\t\t\t\t\t\t\tme.customer_info[this.df.fieldname] = this.value;\n\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\tmessage: __(\"Customer contact updated successfully.\"),\n\t\t\t\t\t\t\t\tindicator: \"green\",\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tfrappe.utils.play_sound(\"submit\");\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tfetch_customer_transactions() {\n\t\tfrappe.db\n\t\t\t.get_list(\"POS Invoice\", {\n\t\t\t\tfilters: { customer: this.customer_info.customer, docstatus: 1 },\n\t\t\t\tfields: [\"name\", \"grand_total\", \"status\", \"posting_date\", \"posting_time\", \"currency\", \"custom_invoice_series\"],\n\t\t\t\tlimit: 20,\n\t\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tconst transaction_container = this.$customer_section.find(\".customer-transactions\");\n\n\t\t\t\tif (!res.length) {\n\t\t\t\t\ttransaction_container.html(\n\t\t\t\t\t\t`<div class=\"no-transactions-placeholder\">No recent transactions found</div>`\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst elapsed_time = moment(res[0].posting_date + \" \" + res[0].posting_time).fromNow();\n\t\t\t\tthis.$customer_section.find(\".customer-desc\").html(`Last transacted ${elapsed_time}`);\n\n\t\t\t\tres.forEach((invoice) => {\n\t\t\t\t\tconst posting_datetime = moment(invoice.posting_date + \" \" + invoice.posting_time).format(\n\t\t\t\t\t\t\"Do MMMM, h:mma\"\n\t\t\t\t\t);\n\t\t\t\t\tlet indicator_color = {\n\t\t\t\t\t\tPaid: \"green\",\n\t\t\t\t\t\tDraft: \"red\",\n\t\t\t\t\t\tReturn: \"gray\",\n\t\t\t\t\t\tConsolidated: \"blue\",\n\t\t\t\t\t};\n\n\t\t\t\t\ttransaction_container.append(\n\t\t\t\t\t\t`<div class=\"invoice-wrapper\" data-invoice-name=\"${escape(invoice.name)}\">\n\t\t\t\t\t\t<div class=\"invoice-name-date\">\n\t\t\t\t\t\t\t<div class=\"invoice-name\">${invoice.custom_invoice_series}</div>\n\t\t\t\t\t\t\t<div class=\"invoice-date\">${posting_datetime}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"invoice-total-status\">\n\t\t\t\t\t\t\t<div class=\"invoice-total\">\n\t\t\t\t\t\t\t\t${format_currency(invoice.grand_total, invoice.currency, 0) || 0}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"invoice-status\">\n\t\t\t\t\t\t\t\t<span class=\"indicator-pill whitespace-nowrap ${indicator_color[invoice.status]}\">\n\t\t\t\t\t\t\t\t\t<span>${invoice.status}</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"seperator\"></div>`\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t});\n\t}\n\n\tattach_refresh_field_event(frm) {\n\t\t$(frm.wrapper).off(\"refresh-fields\");\n\t\t$(frm.wrapper).on(\"refresh-fields\", () => {\n\t\t\tif (frm.doc.items.length) {\n\t\t\t\tthis.$cart_items_wrapper.html(\"\");\n\t\t\t\tfrm.doc.items.forEach((item) => {\n\t\t\t\t\tthis.update_item_html(item);\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.update_totals_section(frm);\n\t\t});\n\t}\n\n\tload_invoice() {\n\t\tconst frm = this.events.get_frm();\n\n\t\tthis.attach_refresh_field_event(frm);\n\n\t\tthis.fetch_customer_details(frm.doc.customer).then(() => {\n\t\t\tthis.events.customer_details_updated(this.customer_info);\n\t\t\tthis.update_customer_section();\n\t\t});\n\n\t\tthis.$cart_items_wrapper.html(\"\");\n\n\t\tif (frm.doc.items.length) {\n\t\t\tfrm.doc.items.forEach((item) => {\n\t\t\t\tthis.update_item_html(item);\n\t\t\t});\n\t\t}\n\n\t\t// else if (storedItems) {\n\t\t// \tstoredItems.forEach(item_data => {\n\t\t// \t\tthis.update_item_html(item_data);\n\t\t// \t});\n\n\t\t// } \n\n\t\telse {\n\t\t\tthis.make_no_items_placeholder();\n\t\t\tthis.highlight_checkout_btn(false);\n\t\t}\n\n\t\tthis.update_totals_section(frm);\n\n\t\tif (frm.doc.docstatus === 1) {\n\t\t\tthis.$totals_section.find(\".checkout-btn\").css(\"display\", \"none\");\n\t\t\tthis.$totals_section.find(\".edit-cart-btn\").css(\"display\", \"none\");\n\t\t} else {\n\t\t\tthis.$totals_section.find(\".checkout-btn\").css(\"display\", \"flex\");\n\t\t\tthis.$totals_section.find(\".edit-cart-btn\").css(\"display\", \"none\");\n\t\t}\n\n\t\tthis.toggle_component(true);\n\t}\n\n\ttoggle_component(show) {\n\t\tshow ? this.$component.css(\"display\", \"flex\") : this.$component.css(\"display\", \"none\");\n\t}\n};", "custom_app.PointOfSale.ItemDetails = class {\n\tconstructor({ wrapper, events, settings }) {\n\t\tthis.wrapper = wrapper;\n\t\tthis.events = events;\n\t\tthis.hide_images = settings.hide_images;\n\t\tthis.allow_rate_change = settings.allow_rate_change;\n\t\tthis.allow_discount_change = settings.allow_discount_change;\n\t\tthis.current_item = {};\n\n\t\tthis.init_component();\n\t}\n\n\tinit_component() {\n\t\tthis.prepare_dom();\n\t\tthis.init_child_components();\n\t\tthis.bind_events();\n\t\tthis.attach_shortcuts();\n\t}\n\n\tprepare_dom() {\n\t\tthis.wrapper.append(`<section class=\"item-details-container\" style=\"grid-column:span 3 / span 3;\"></section>`);\n\n\t\tthis.$component = this.wrapper.find(\".item-details-container\");\n\t}\n\n\tinit_child_components() {\n\t\tthis.$component.html(\n\t\t\t`<div class=\"item-details-header\">\n\t\t\t\t<div class=\"label\">${__(\"Item Details\")}</div>\n\t\t\t\t<div class=\"close-btn\">\n\t\t\t\t\t<svg width=\"32\" height=\"32\" viewBox=\"0 0 14 14\" fill=\"none\">\n\t\t\t\t\t\t<path d=\"M4.93764 4.93759L7.00003 6.99998M9.06243 9.06238L7.00003 6.99998M7.00003 6.99998L4.93764 9.06238L9.06243 4.93759\" stroke=\"#8D99A6\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"item-display\">\n\t\t\t\t<div class=\"item-name-desc-price\">\n\t\t\t\t\t<div class=\"item-name\"></div>\n\t\t\t\t\t<div class=\"item-desc\"></div>\n\t\t\t\t\t<div class=\"item-price\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"discount-section\"></div>\n\t\t\t<div class=\"form-container\"></div>\n\t\t\t<div class=\"serial-batch-container\"></div>`\n\t\t);\n\n\t\tthis.$item_name = this.$component.find(\".item-name\");\n\t\tthis.$item_description = this.$component.find(\".item-desc\");\n\t\tthis.$item_price = this.$component.find(\".item-price\");\n\t\tthis.$item_image = this.$component.find(\".item-image\");\n\t\tthis.$form_container = this.$component.find(\".form-container\");\n\t\tthis.$dicount_section = this.$component.find(\".discount-section\");\n\t\tthis.$serial_batch_container = this.$component.find(\".serial-batch-container\");\n\t}\n\n\tcompare_with_current_item(item) {\n\t\t// returns true if `item` is currently being edited\n\t\treturn item && item.name == this.current_item.name;\n\t}\n\n\tasync toggle_item_details_section(item) {\n\n\t\tconst current_item_changed = !this.compare_with_current_item(item);\n\n\t\t// if item is null or highlighted cart item is clicked twice\n\t\tconst hide_item_details = !Boolean(item) || !current_item_changed;\n\n\t\tif ((!hide_item_details && current_item_changed) || hide_item_details) {\n\t\t\t// if item details is being closed OR if item details is opened but item is changed\n\t\t\t// in both cases, if the current item is a serialized item, then validate and remove the item\n\t\t\tawait this.validate_serial_batch_item();\n\t\t}\n\n\t\tthis.events.toggle_item_selector(!hide_item_details);\n\t\tthis.toggle_component(!hide_item_details);\n\n\t\tif (item && current_item_changed) {\n\t\t\tthis.doctype = item.doctype;\n\t\t\tthis.item_meta = frappe.get_meta(this.doctype);\n\t\t\tthis.name = item.name;\n\t\t\tthis.item_row = item;\n\t\t\tthis.currency = this.events.get_frm().doc.currency;\n\n\t\t\tthis.current_item = item;\n\n\t\t\tthis.render_dom(item);\n\t\t\tthis.render_discount_dom(item);\n\t\t\tthis.render_form(item);\n\t\t\tthis.events.highlight_cart_item(item);\n\t\t} else {\n\t\t\tthis.current_item = {};\n\t\t}\n\t}\n\n\tvalidate_serial_batch_item() {\n\t\tconst doc = this.events.get_frm().doc;\n\t\tconst item_row = doc.items.find((item) => item.name === this.name);\n\n\t\tif (!item_row) return;\n\n\t\tconst serialized = item_row.has_serial_no;\n\t\tconst batched = item_row.has_batch_no;\n\t\tconst no_bundle_selected = !item_row.serial_and_batch_bundle;\n\n\t\tif ((serialized && no_bundle_selected) || (batched && no_bundle_selected)) {\n\t\t\tfrappe.show_alert({\n\t\t\t\tmessage: __(\"Item is removed since no serial / batch no selected.\"),\n\t\t\t\tindicator: \"orange\",\n\t\t\t});\n\t\t\tfrappe.utils.play_sound(\"cancel\");\n\t\t\treturn this.events.remove_item_from_cart();\n\t\t}\n\t}\n\n\trender_dom(item) {\n\t\tlet { item_name, description, image, price_list_rate, custom_remarks, custom_vat } = item;\n\n\t\tfunction get_description_html() {\n\t\t\tif (description) {\n\t\t\t\tdescription =\n\t\t\t\t\tdescription.indexOf(\"...\") === -1 && description.length > 140\n\t\t\t\t\t\t? description.substr(0, 139) + \"...\"\n\t\t\t\t\t\t: description;\n\t\t\t\treturn description;\n\t\t\t}\n\t\t\treturn ``;\n\t\t}\n\n\t\tthis.$item_name.html(item_name);\n\t\tthis.$item_description.html(get_description_html());\n\t\tthis.$item_price.html(format_currency(price_list_rate, this.currency));\n\t}\n\n\thandle_broken_image($img) {\n\t\tconst item_abbr = $($img).attr(\"alt\");\n\t\t$($img).replaceWith(`<div class=\"item-abbr\">${item_abbr}</div>`);\n\t}\n\n\trender_discount_dom(item) {\n\t\tif (item.discount_percentage) {\n\t\t\tthis.$dicount_section.html(\n\t\t\t\t`<div class=\"item-rate\">${format_currency(item.price_list_rate, this.currency)}</div>\n\t\t\t\t<div class=\"item-discount\">${item.discount_percentage}% off</div>`\n\t\t\t);\n\t\t\tthis.$item_price.html(format_currency(item.rate, this.currency));\n\t\t} else {\n\t\t\tthis.$dicount_section.html(``);\n\t\t}\n\t}\n\n\trender_form(item) {\n\t\tconst fields_to_display = this.get_form_fields(item);\n\t\n\t\tthis.$form_container.html(\"\");\n\t\t\n\t\t// Store the original rate\n\t\tthis.original_rate = item.rate;\n\t\t\n\t\tfields_to_display.forEach((fieldname, idx) => {\n\t\t\t\n\t\t\tthis.$form_container.append(\n\t\t\t\t`<div class=\"${fieldname}-control\" data-fieldname=\"${fieldname}\"></div>`\n\t\t\t);\n\t\t\n\t\t\tconst field_meta = this.item_meta.fields.find((df) => df.fieldname === fieldname);\n\t\t\tif (fieldname === \"discount_percentage\") {\n\t\t\t\tfield_meta.label = __(\"Discount (%)\");\n\t\t\t}\n\t\t\n\t\t\tconst me = this;\n\t\n\t\t\t// console.log(\"Form Fields:\", field_meta)\n\t\t\n\t\t\tthis[`${fieldname}_control`] = frappe.ui.form.make_control({\n\t\t\t\tdf: {\n\t\t\t\t\t...field_meta,\n\t\t\t\t\tonchange: function () {\n\t\t\t\t\t\tme.events.form_updated(me.current_item, fieldname, this.value);\n\t\t\t\t\t\tme.is_oic_authenticated = false;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tparent: this.$form_container.find(`.${fieldname}-control`),\n\t\t\t\trender_input: true,\n\t\t\t});\n\t\t\tthis[`${fieldname}_control`].set_value(item[fieldname]);\n\n\t\t\t// Add event listener for discount_percentage and discount_amount field click\n\t\t\tif (fieldname === \"discount_percentage\" || fieldname === \"discount_amount\" || fieldname === \"rate\") {\n\t\t\t\tthis.$form_container.find(`.${fieldname}-control input`).on(\"focus\", function () {\n\t\t\t\t\tif (!me.is_oic_authenticated) {\n\t\t\t\t\t\tme.oic_authentication(fieldname, item);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\n\t\t\t}\n\t\n\t\t});\n\t\t\n\t\tthis.make_auto_serial_selection_btn(item);\n\t\tthis.bind_custom_control_change_event();\n\t}\n\t\n\toic_authentication(fieldname, item) {\n\t\tconst me = this;\n\t\tconst doc = me.events.get_frm()\n\t\t// Show password dialog for OIC authentication\n\t\tconst passwordDialog = new frappe.ui.Dialog({\n\t\t\ttitle: __('Authorization Required OIC'),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldname: 'password',\n\t\t\t\t\tfieldtype: 'Password',\n\t\t\t\t\tlabel: __('Password'),\n\t\t\t\t\treqd: 1\n\t\t\t\t}\n\t\t\t],\n\t\t\tprimary_action_label: __('Authorize'),\n\t\t\tprimary_action: (values) => {\n\t\t\t\tlet password = values.password;\n\n\t\t\n\t\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.confirm_user_password\",\n\t\t\t\t\targs: { password: password },\n\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\tif (r.message) {\n\n\t\t\t\t\t\t\t// console.log('User: ', r.message)\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif (r.message.name) {\n\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\tmessage: __('Verified'),\n\t\t\t\t\t\t\t\t\tindicator: 'green'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tpasswordDialog.hide();\n\t\n\t\t\t\t\t\t\t\tme.enable_discount_input(fieldname);\n\t\t\t\t\t\t\t\tme.set_discount_log(doc, item, r)\n\t\t\t\t\t\t\t\tme.is_oic_authenticated = true;\n\t\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\tmessage: __('Incorrect password or user is not an OIC'),\n\t\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Show alert for incorrect password or unauthorized user\n\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\tmessage: __('Incorrect password or user is not an OIC'),\n\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tpasswordDialog.show();\n\t}\n\n\tset_discount_log(doc, item, r) {\n\t\tlet current_discount_log = doc.doc.custom_manual_dicsount || '';\n\t\tlet discount_log = `${item.item_code} - ${r.message.full_name} - ${frappe.datetime.now_datetime()}\\n`;\n\t\tlet updated_discount_log = current_discount_log + discount_log;\n\t\tdoc.set_value('custom_manual_dicsount', updated_discount_log);\n\t}\n\n\t// Function to enable input to discount_percentage field after OTP authentication\n\tenable_discount_input(fieldname) {\n\t\tthis.$form_container.find(`.${fieldname}-control input`).prop(\"disabled\", false);\n\t}\n\n\tget_form_fields(item) {\n\t\tconst fields = [\n\t\t\t\"custom_free\",\n\t\t\t\"qty\",\n\t\t\t'price_list_rate',\n\t\t\t\"rate\",\n\t\t\t\"uom\",\n\t\t\t\"discount_percentage\",\n\t\t\t\"discount_amount\", \n\t\t\t\"custom_batch_number\",\n\t\t\t\"custom_batch_expiry\",\n\t\t\t'custom_vat_amount',\n\t\t\t'custom_vatable_amount',\n\t\t\t'custom_vat_exempt_amount',\n\t\t\t'custom_zero_rated_amount',\n\t\t\t\"custom_remarks\",\n\t\t];\n\t\tif (item.has_serial_no) fields.push(\"serial_no\");\n\t\tif (item.has_batch_no) fields.push(\"batch_no\");\n\t\treturn fields;\n\t}\n\n\tmake_auto_serial_selection_btn(item) {\n\t\tif (item.has_serial_no || item.has_batch_no) {\n\t\t\tconst label = item.has_serial_no ? __(\"Select Serial No\") : __(\"Select Batch No\");\n\t\t\tthis.$form_container.append(\n\t\t\t\t`<div class=\"btn btn-sm btn-secondary auto-fetch-btn\">${label}</div>`\n\t\t\t);\n\t\t\tthis.$form_container.find(\".serial_no-control\").find(\"textarea\").css(\"height\", \"6rem\");\n\t\t}\n\t}\n\n\tbind_custom_control_change_event() {\n\t\tconst me = this;\n\n\t\t// if (this.rate_control) {\n\t\t// \tthis.rate_control.df.onchange = function () {\n\t\t// \t\tif (this.value || flt(this.value) === 0) {\n\t\t// \t\t\tme.events.form_updated(me.current_item, \"rate\", this.value).then(() => {\n\t\t// \t\t\t\tconst item_row = frappe.get_doc(me.doctype, me.name);\n\t\t// \t\t\t\tconst doc = me.events.get_frm().doc;\n\t\t// \t\t\t\tme.$item_price.html(format_currency(item_row.rate, doc.currency));\n\t\t// \t\t\t\tme.render_discount_dom(item_row);\n\t\t// \t\t\t});\n\t\t// \t\t}\n\t\t// \t};\n\t\t// \tthis.rate_control.df.read_only = !this.allow_rate_change;\n\t\t// \tthis.rate_control.refresh();\n\t\t// }\n\n\t\tif (this.rate_control) {\n\t\t\t\n\t\t\tconst frm = me.events.get_frm();\n\t\t\t// Remove any existing onchange handler to avoid multiple handlers being attached\n\t\t\tthis.rate_control.df.onchange = null;\n\t\t\n\t\t\tthis.rate_control.df.onchange = function () {\n\t\t\t\tif (this.value || flt(this.value) === 0) {\n\t\t\t\t\t// Debounce to prevent multiple rapid changes from causing issues\n\t\t\t\t\tif (this._debounce) {\n\t\t\t\t\t\tclearTimeout(this._debounce);\n\t\t\t\t\t}\n\t\t\t\t\tthis._debounce = setTimeout(() => {\n\t\t\t\t\t\tme.events.form_updated(me.current_item, \"rate\", this.value).then(() => {\n\t\t\t\t\t\t\tconst item_row = frappe.get_doc(me.doctype, me.name);\n\t\t\t\t\t\t\tconst doc = me.events.get_frm().doc;\n\t\t\t\t\t\t\tme.$item_price.html(format_currency(item_row.rate, doc.currency));\n\t\t\t\t\t\t\tme.render_discount_dom(item_row);\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 200); // Adjust the debounce time as needed\n\t\t\t\t}\n\t\t\t};\n\t\t\t\n\n\t\t\tif (frm.doc.customer_group === 'Senior Citizen') {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tthis.rate_control.df.read_only = !this.allow_rate_change;\n\t\t\t\tthis.rate_control.refresh();\n\t\t\t}\n\t\t\t\n\t\t\t// this.rate_control.df.read_only = !this.allow_rate_change;\n\t\t\t// this.rate_control.refresh();\n\t\t}\n\t\t// Ensure frm.doc is checked for existence before accessing it\n\t\t\n\t\t\n\t\t// if (this.discount_percentage_control && !this.allow_discount_change) {\n\t\t// \tthis.discount_percentage_control.df.read_only = 1;\n\t\t// \tthis.discount_percentage_control.refresh();\n\t\t// }\n\n\t\tif (me.events && me.events.get_frm() && me.events.get_frm().doc) {\n\t\t\tconst frm = me.events.get_frm();\n\t\t\tif (frm.doc.customer_group === 'Senior Citizen'|| frm.doc.customer_group === 'PWD' ) {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tif (me.discount_percentage_control && !me.allow_discount_change) {\n\t\t\t\t\tme.discount_percentage_control.df.read_only = 1;\n\t\t\t\t\tme.discount_percentage_control.refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this.warehouse_control) {\n\t\t\tthis.warehouse_control.df.reqd = 1;\n\t\t\tthis.warehouse_control.df.onchange = function () {\n\t\t\t\tif (this.value) {\n\t\t\t\t\tme.events.form_updated(me.current_item, \"warehouse\", this.value).then(() => {\n\t\t\t\t\t\tme.item_stock_map = me.events.get_item_stock_map();\n\t\t\t\t\t\tconst available_qty = me.item_stock_map[me.item_row.item_code][this.value][0];\n\t\t\t\t\t\tconst is_stock_item = Boolean(\n\t\t\t\t\t\t\tme.item_stock_map[me.item_row.item_code][this.value][1]\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (available_qty === undefined) {\n\t\t\t\t\t\t\tme.events.get_available_stock(me.item_row.item_code, this.value).then(() => {\n\t\t\t\t\t\t\t\t// item stock map is updated now reset warehouse\n\t\t\t\t\t\t\t\tme.warehouse_control.set_value(this.value);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (available_qty === 0 && is_stock_item) {\n\t\t\t\t\t\t\tme.warehouse_control.set_value(\"\");\n\t\t\t\t\t\t\tconst bold_item_code = me.item_row.item_code.bold();\n\t\t\t\t\t\t\tconst bold_warehouse = this.value.bold();\n\t\t\t\t\t\t\tfrappe.throw(\n\t\t\t\t\t\t\t\t__(\"Item Code: {0} is not available under warehouse {1}.\", [\n\t\t\t\t\t\t\t\t\tbold_item_code,\n\t\t\t\t\t\t\t\t\tbold_warehouse,\n\t\t\t\t\t\t\t\t])\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.actual_qty_control.set_value(available_qty);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.warehouse_control.df.get_query = () => {\n\t\t\t\treturn {\n\t\t\t\t\tfilters: { company: this.events.get_frm().doc.company },\n\t\t\t\t};\n\t\t\t};\n\t\t\tthis.warehouse_control.refresh();\n\t\t}\n\n\t\tif (this.serial_no_control) {\n\t\t\tthis.serial_no_control.df.reqd = 1;\n\t\t\tthis.serial_no_control.df.onchange = async function () {\n\t\t\t\t!me.current_item.batch_no && (await me.auto_update_batch_no());\n\t\t\t\tme.events.form_updated(me.current_item, \"serial_no\", this.value);\n\t\t\t};\n\t\t\tthis.serial_no_control.refresh();\n\t\t}\n\n\t\tif (this.batch_no_control) {\n\t\t\tthis.batch_no_control.df.reqd = 1;\n\t\t\tthis.batch_no_control.df.get_query = () => {\n\t\t\t\treturn {\n\t\t\t\t\tquery: \"erpnext.controllers.queries.get_batch_no\",\n\t\t\t\t\tfilters: {\n\t\t\t\t\t\titem_code: me.item_row.item_code,\n\t\t\t\t\t\twarehouse: me.item_row.warehouse,\n\t\t\t\t\t\tposting_date: me.events.get_frm().doc.posting_date,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t};\n\t\t\tthis.batch_no_control.refresh();\n\t\t}\n\n\t\tif (this.uom_control) {\n\t\t\tthis.uom_control.df.onchange = function () {\n\t\t\t\tme.events.form_updated(me.current_item, \"uom\", this.value);\n\n\t\t\t\tconst item_row = frappe.get_doc(me.doctype, me.name);\n\t\t\t\tme.conversion_factor_control.df.read_only = item_row.stock_uom == this.value;\n\t\t\t\tme.conversion_factor_control.refresh();\n\t\t\t};\n\t\t}\n\n\t\tfrappe.model.on(\"POS Invoice Item\", \"*\", (fieldname, value, item_row) => {\n\t\t\tconst field_control = this[`${fieldname}_control`];\n\t\t\tconst item_row_is_being_edited = this.compare_with_current_item(item_row);\n\n\t\t\tif (item_row_is_being_edited && field_control && field_control.get_value() !== value) {\n\t\t\t\tfield_control.set_value(value);\n\t\t\t\tcur_pos.update_cart_html(item_row);\n\t\t\t}\n\t\t});\n\t}\n\n\tasync auto_update_batch_no() {\n\t\tif (this.serial_no_control && this.batch_no_control) {\n\t\t\tconst selected_serial_nos = this.serial_no_control\n\t\t\t\t.get_value()\n\t\t\t\t.split(`\\n`)\n\t\t\t\t.filter((s) => s);\n\t\t\tif (!selected_serial_nos.length) return;\n\n\t\t\t// find batch nos of the selected serial no\n\t\t\tconst serials_with_batch_no = await frappe.db.get_list(\"Serial No\", {\n\t\t\t\tfilters: { name: [\"in\", selected_serial_nos] },\n\t\t\t\tfields: [\"batch_no\", \"name\"],\n\t\t\t});\n\t\t\tconst batch_serial_map = serials_with_batch_no.reduce((acc, r) => {\n\t\t\t\tif (!acc[r.batch_no]) {\n\t\t\t\t\tacc[r.batch_no] = [];\n\t\t\t\t}\n\t\t\t\tacc[r.batch_no] = [...acc[r.batch_no], r.name];\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\t\t\t// set current item's batch no and serial no\n\t\t\tconst batch_no = Object.keys(batch_serial_map)[0];\n\t\t\tconst batch_serial_nos = batch_serial_map[batch_no].join(`\\n`);\n\t\t\t// eg. 10 selected serial no. -> 5 belongs to first batch other 5 belongs to second batch\n\t\t\tconst serial_nos_belongs_to_other_batch =\n\t\t\t\tselected_serial_nos.length !== batch_serial_map[batch_no].length;\n\n\t\t\tconst current_batch_no = this.batch_no_control.get_value();\n\t\t\tcurrent_batch_no != batch_no && (await this.batch_no_control.set_value(batch_no));\n\n\t\t\tif (serial_nos_belongs_to_other_batch) {\n\t\t\t\tthis.serial_no_control.set_value(batch_serial_nos);\n\t\t\t\tthis.qty_control.set_value(batch_serial_map[batch_no].length);\n\n\t\t\t\tdelete batch_serial_map[batch_no];\n\t\t\t\tthis.events.clone_new_batch_item_in_frm(batch_serial_map, this.current_item);\n\t\t\t}\n\t\t}\n\t}\n\n\tbind_events() {\n\t\tthis.bind_auto_serial_fetch_event();\n\t\tthis.bind_fields_to_numpad_fields();\n\n\t\tthis.$component.on(\"click\", \".close-btn\", () => {\n\t\t\tthis.events.close_item_details();\n\t\t});\n\t}\n\n\tattach_shortcuts() {\n\t\tthis.wrapper.find(\".close-btn\").attr(\"title\", \"Esc\");\n\t\tfrappe.ui.keys.on(\"escape\", () => {\n\t\t\tconst item_details_visible = this.$component.is(\":visible\");\n\t\t\tif (item_details_visible) {\n\t\t\t\tthis.events.close_item_details();\n\t\t\t}\n\t\t});\n\t}\n\n\tbind_fields_to_numpad_fields() {\n\t\tconst me = this;\n\t\tthis.$form_container.on(\"click\", \".input-with-feedback\", function () {\n\t\t\tconst fieldname = $(this).attr(\"data-fieldname\");\n\t\t\tif (this.last_field_focused != fieldname) {\n\t\t\t\tme.events.item_field_focused(fieldname);\n\t\t\t\tthis.last_field_focused = fieldname;\n\t\t\t}\n\t\t});\n\t}\n\n\tbind_auto_serial_fetch_event() {\n\t\tthis.$form_container.on(\"click\", \".auto-fetch-btn\", () => {\n\t\t\tlet frm = this.events.get_frm();\n\t\t\tlet item_row = this.item_row;\n\t\t\titem_row.type_of_transaction = \"Outward\";\n\n\t\t\tnew erpnext.SerialBatchPackageSelector(frm, item_row, (r) => {\n\t\t\t\tif (r) {\n\t\t\t\t\tfrappe.model.set_value(item_row.doctype, item_row.name, {\n\t\t\t\t\t\tserial_and_batch_bundle: r.name,\n\t\t\t\t\t\tqty: Math.abs(r.total_qty),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\ttoggle_component(show) {\n\t\tshow ? this.$component.css(\"display\", \"flex\") : this.$component.css(\"display\", \"none\");\n\t}\n};\n", "custom_app.PointOfSale.NumberPad = class {\n\tconstructor({ wrapper, events, cols, keys, css_classes, fieldnames_map }) {\n\t\tthis.wrapper = wrapper;\n\t\tthis.events = events;\n\t\tthis.cols = cols;\n\t\tthis.keys = keys;\n\t\tthis.css_classes = css_classes || [];\n\t\tthis.fieldnames = fieldnames_map || {};\n\n\t\tthis.init_component();\n\t}\n\n\tinit_component() {\n\t\tthis.prepare_dom();\n\t\tthis.bind_events();\n\t}\n\n\tprepare_dom() {\n\t\tconst { cols, keys, css_classes, fieldnames } = this;\n\n\t\tfunction get_keys() {\n\t\t\treturn keys.reduce((a, row, i) => {\n\t\t\t\treturn (\n\t\t\t\t\ta +\n\t\t\t\t\trow.reduce((a2, number, j) => {\n\t\t\t\t\t\tconst class_to_append = css_classes && css_classes[i] ? css_classes[i][j] : \"\";\n\t\t\t\t\t\tconst fieldname =\n\t\t\t\t\t\t\tfieldnames && fieldnames[number]\n\t\t\t\t\t\t\t\t? fieldnames[number]\n\t\t\t\t\t\t\t\t: typeof number === \"string\"\n\t\t\t\t\t\t\t\t? frappe.scrub(number)\n\t\t\t\t\t\t\t\t: number;\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\ta2 +\n\t\t\t\t\t\t\t`<div class=\"numpad-btn ${class_to_append}\" data-button-value=\"${fieldname}\">${__(\n\t\t\t\t\t\t\t\tnumber\n\t\t\t\t\t\t\t)}</div>`\n\t\t\t\t\t\t);\n\t\t\t\t\t}, \"\")\n\t\t\t\t);\n\t\t\t}, \"\");\n\t\t}\n\n\t\tthis.wrapper.html(\n\t\t\t`<div class=\"numpad-container\">\n\t\t\t\t${get_keys()}\n\t\t\t</div>`\n\t\t);\n\t}\n\n\tbind_events() {\n\t\tconst me = this;\n\t\tthis.wrapper.on(\"click\", \".numpad-btn\", function () {\n\t\t\tconst $btn = $(this);\n\t\t\tme.events.numpad_event($btn);\n\t\t});\n\t}\n};\n", "/* eslint-disable no-unused-vars */\ncustom_app.PointOfSale.Payment = class {\n\tconstructor({ events, wrapper }) {\n\t\tthis.wrapper = wrapper;\n\t\tthis.events = events;\n\t\tthis.init_component();\n\t}\n\n\tinit_component() {\n\t\tthis.prepare_dom();\n\t\t// this.initialize_numpad();\n\t\tthis.bind_events();\n\t\tthis.attach_shortcuts();\n\t}\n\n\tprepare_dom() {\n\t\tthis.wrapper.append(\n\t\t\t`<section class=\"payment-container\" style=\"grid-column:span 4 / span 4;\">\n\t\t\t\t<div class=\"fields-numpad-container\">\n\t\t\t\t\t<div class=\"fields-section\">\n\t\t\t\t\t\t<div class=\"section-label payment-section\">${__(\"Payment Method\")}</div>\n\t\t\t\t\t\t<div class=\"payment-modes\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"totals-section\">\n\t\t\t\t\t<div class=\"totals\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"submit-order-btn\">${__(\"Print Order\")}</div>\n\t\t\t</section>`\n\t\t);\n\t\tthis.$component = this.wrapper.find(\".payment-container\");\n\t\tthis.$payment_modes = this.$component.find(\".payment-modes\");\n\t\tthis.$totals_section = this.$component.find(\".totals-section\");\n\t\tthis.$totals = this.$component.find(\".totals\");\n\t\tthis.$numpad = this.$component.find(\".number-pad\");\n\t\tthis.$invoice_fields_section = this.$component.find(\".fields-section\");\n\t}\n\n\n\tmake_invoice_fields_control() {\n\t\tfrappe.db.get_doc(\"POS Settings\", undefined).then((doc) => {\n\t\t\tconst fields = doc.invoice_fields;\n\t\t\tif (!fields.length) return;\n\n\t\t\tthis.$invoice_fields = this.$invoice_fields_section.find(\".invoice-fields\");\n\t\t\tthis.$invoice_fields.html(\"\");\n\t\t\tconst frm = this.events.get_frm();\n\n\t\t\tfields.forEach((df) => {\n\t\t\t\tthis.$invoice_fields.append(\n\t\t\t\t\t`<div class=\"invoice_detail_field ${df.fieldname}-field\" data-fieldname=\"${df.fieldname}\"></div>`\n\t\t\t\t);\n\t\t\t\tlet df_events = {\n\t\t\t\t\tonchange: function () {\n\t\t\t\t\t\tfrm.set_value(this.df.fieldname, this.get_value());\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t\tif (df.fieldtype == \"Button\") {\n\t\t\t\t\tdf_events = {\n\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\tif (frm.script_manager.has_handlers(df.fieldname, frm.doc.doctype)) {\n\t\t\t\t\t\t\t\tfrm.script_manager.trigger(df.fieldname, frm.doc.doctype, frm.doc.docname);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tthis[`${df.fieldname}_field`] = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\t...df,\n\t\t\t\t\t\t...df_events,\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$invoice_fields.find(`.${df.fieldname}-field`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tthis[`${df.fieldname}_field`].set_value(frm.doc[df.fieldname]);\n\t\t\t});\n\t\t});\n\t}\n\n\tinitialize_numpad() {\n\t\tconst me = this;\n\t\tthis.number_pad = new erpnext.PointOfSale.NumberPad({\n\t\t\twrapper: this.$numpad,\n\t\t\tevents: {\n\t\t\t\tnumpad_event: function ($btn) {\n\t\t\t\t\tme.on_numpad_clicked($btn);\n\t\t\t\t},\n\t\t\t},\n\t\t\tcols: 3,\n\t\t\tkeys: [\n\t\t\t\t[1, 2, 3],\n\t\t\t\t[4, 5, 6],\n\t\t\t\t[7, 8, 9],\n\t\t\t\t[\".\", 0, \"Delete\"],\n\t\t\t],\n\t\t});\n\n\t\tthis.numpad_value = \"\";\n\t}\n\n\ton_numpad_clicked($btn) {\n\t\tconst button_value = $btn.attr(\"data-button-value\");\n\n\t\thighlight_numpad_btn($btn);\n\t\tthis.numpad_value =\n\t\t\tbutton_value === \"delete\" ? this.numpad_value.slice(0, -1) : this.numpad_value + button_value;\n\t\tthis.selected_mode.$input.get(0).focus();\n\t\tthis.selected_mode.set_value(this.numpad_value);\n\n\t\tfunction highlight_numpad_btn($btn) {\n\t\t\t$btn.addClass(\"shadow-base-inner bg-selected\");\n\t\t\tsetTimeout(() => {\n\t\t\t\t$btn.removeClass(\"shadow-base-inner bg-selected\");\n\t\t\t}, 100);\n\t\t}\n\t}\n\n\n\tbind_events() {\n\t\tconst me = this;\n\t\tfunction hideAllFields() {\n\t\t\t$(`.mode-of-payment-control`).hide();\n\t\t\t$(`.mobile-number`).hide();\n\t\t\t$(`.approval-code`).hide();\n\t\t\t$(`.reference-number`).hide();\n\t\t\t$(`.bank-name`).hide();\n\t\t\t$(`.holder-name`).hide();\n\t\t\t$(`.card_type_control`).hide();\n\t\t\t$(`.card-number`).hide();\n\t\t\t$(`.expiry-date`).hide();\n\t\t\t$(`.confirmation-code`).hide();\n\t\t\t$(`.cash-shortcuts`).hide();\n\t\t\t$(`.check-name`).hide();\n\t\t\t$(`.check-number`).hide();\n\t\t\t$(`.check-date`).hide();\n\t\t\t$(`.actual-gov-one`).hide();\n\t\t\t$(`.actual-gov-two`).hide();\n\t\t\t$(`.payment-type`).hide();\n\t\t\t$(`.bank-type`).hide();\n\t\t\t$(`.qr-reference-number`).hide();\n\t\t\t$(`.customer`).hide();\n\t\t\t$(`.charge-invoice-number`).hide();\n\t\t\t$(`.po-number`).hide();\n\t\t\t$(`.representative`).hide();\n\t\t\t$(`.id-number`).hide();\n\t\t\t$(`.approved-by`).hide();\n\t\t\t$(`.gift-code`).hide();\n\t\t\t$(`.button-code`).hide();\n\t\t\t$(`.amesco-code`).hide();\n\t\t\t$(`.button-amesco-plus`).hide();\n\t\t\t$(`.save-button`).hide();\n\t\t\t$(`.discard-button`).hide();\n\t\t\t$(`.cash-button`).hide();\n\t\t\tme.$payment_modes.find(`.pay-amount`).css(\"display\", \"inline\");\n\t\t\tme.$payment_modes.find(`.loyalty-amount-name`).hide();\n\t\t}\n\n\n\t\tfunction focusAndHighlightAmountField(mode_clicked) {\n\t\t\tconst $amountField = mode_clicked.find(\".frappe-control.input-max-width[data-fieldtype='Currency'] input\");\n\t\t\t$amountField.focus();\n\t\t\t$amountField[0].setSelectionRange(0, $amountField.val().length);\n\t\t}\n\n\n\t\tthis.$payment_modes.on(\"click\", \".mode-of-payment\", function (e) {\n\t\t\tconst mode_clicked = $(this);\n\t\t\tif (!$(e.target).is(mode_clicked)) return;\n\n\t\t\tconst scrollLeft = mode_clicked.offset().left - me.$payment_modes.offset().left + me.$payment_modes.scrollLeft();\n\t\t\tme.$payment_modes.animate({ scrollLeft });\n\n\t\t\tconst mode = mode_clicked.attr(\"data-mode\");\n\n\t\t\t// Hide all fields first\n\t\t\thideAllFields();\n\n\t\t\t// Remove highlight from all mode-of-payments\n\t\t\t$(\".mode-of-payment\").removeClass(\"border-primary\");\n\n\t\t\tif (mode_clicked.hasClass(\"border-primary\")) {\n\t\t\t\t// Clicked one is selected then unselect it\n\t\t\t\tmode_clicked.removeClass(\"border-primary\");\n\t\t\t\thideAllFields();\n\t\t\t} else {\n\t\t\t\t// Clicked one is not selected then select it\n\t\t\t\tmode_clicked.addClass(\"border-primary\");\n\n\t\t\t\t// Show relevant fields based on mode\n\t\t\t\tmode_clicked.find(\".mode-of-payment-control\").css(\"display\", \"flex\");\n\t\t\t\tmode_clicked.find(\".cash-button\").css(\"display\", \"flex\");\n\t\t\t\tif (mode === \"gcash\" || mode === \"paymaya\") {\n\t\t\t\t\tmode_clicked.find(\".mobile-number\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".reference-number\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".save-button\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".discard-button\").css(\"display\", \"flex\");\n\t\t\t\t} else if (mode === \"cards\" || mode === \"debit_card\" || mode === \"credit_card\") {\n\t\t\t\t\tmode_clicked.find(\".bank-name\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".holder-name\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".card_type_control\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".card-number\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".expiry-date\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".approval-code\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".save-button\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".discard-button\").css(\"display\", \"flex\");\n\t\t\t\t} else if (mode === \"cheque\") {\n\t\t\t\t\tmode_clicked.find(\".bank-name\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".check-name\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".check-number\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".check-date\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".save-button\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".discard-button\").css(\"display\", \"flex\");\n\t\t\t\t} else if (mode === \"2307g\") {\n\t\t\t\t\tmode_clicked.find(\".actual-gov-one\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".save-button\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".discard-button\").css(\"display\", \"flex\");\n\t\t\t\t} else if (mode === \"2307\") {\n\t\t\t\t\tmode_clicked.find(\".actual-gov-two\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".save-button\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".discard-button\").css(\"display\", \"flex\");\n\t\t\t\t} else if (mode === \"qr_payment\") {\n\t\t\t\t\tmode_clicked.find(\".payment-type\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".bank-type\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".qr-reference-number\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".save-button\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".discard-button\").css(\"display\", \"flex\");\n\t\t\t\t} else if (mode === \"charge\") {\n\t\t\t\t\tmode_clicked.find(\".customer\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".charge-invoice-number\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".po-number\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".representative\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".id-number\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".approved-by\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".save-button\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".discard-button\").css(\"display\", \"flex\");\n\t\t\t\t} else if (mode === \"gift_certificate\") {\n\t\t\t\t\tmode_clicked.find(\".gift-code\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".button-code\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".discard-button\").css(\"display\", \"flex\");\n\t\t\t\t} else if (mode === \"amesco_plus\") {\n\t\t\t\t\tmode_clicked.find(\".amesco-code\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".button-amesco-plus\").css(\"display\", \"flex\");\n\t\t\t\t\tmode_clicked.find(\".discard-button\").css(\"display\", \"flex\");\n\t\t\t\t} \n\t\t\t\tfocusAndHighlightAmountField(mode_clicked);\n\t\t\t\t// me.selected_mode = me[`${mode}_control`];\n\t\t\t\tme.selected_mode && me.selected_mode.$input.get();\n\t\t\t\tme.auto_set_remaining_amount();\n\t\t\t}\n\t\t});\n\n\t\t// Hide all fields if clicking outside mode-of-payment\n\t\t$(document).on(\"click\", function (e) {\n\t\t\tconst target = $(e.target);\n\t\t\tif (!target.closest(\".mode-of-payment\").length) {\n\t\t\t\thideAllFields();\n\t\t\t\t$(\".mode-of-payment\").removeClass(\"border-primary\");\n\t\t\t}\n\t\t});\n\n\t\tfrappe.ui.form.on(\"POS Invoice\", \"contact_mobile\", (frm) => {\n\t\t\tconst contact = frm.doc.contact_mobile;\n\t\t\tconst request_button = $(this.request_for_payment_field?.$input[0]);\n\t\t\tif (contact) {\n\t\t\t\trequest_button.removeClass(\"btn-default\").addClass(\"btn-primary\");\n\t\t\t} else {\n\t\t\t\trequest_button.removeClass(\"btn-primary\").addClass(\"btn-default\");\n\t\t\t}\n\t\t});\n\n\t\tfrappe.ui.form.on(\"POS Invoice\", \"coupon_code\", (frm) => {\n\t\t\tif (frm.doc.coupon_code && !frm.applying_pos_coupon_code) {\n\t\t\t\tif (!frm.doc.ignore_pricing_rule) {\n\t\t\t\t\tfrm.applying_pos_coupon_code = true;\n\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t() => (frm.doc.ignore_pricing_rule = 1),\n\t\t\t\t\t\t() => frm.trigger(\"ignore_pricing_rule\"),\n\t\t\t\t\t\t() => (frm.doc.ignore_pricing_rule = 0),\n\t\t\t\t\t\t() => frm.trigger(\"apply_pricing_rule\"),\n\t\t\t\t\t\t() => frm.save(),\n\t\t\t\t\t\t() => this.update_totals_section(frm.doc),\n\t\t\t\t\t\t() => (frm.applying_pos_coupon_code = false),\n\t\t\t\t\t]);\n\t\t\t\t} else if (frm.doc.ignore_pricing_rule) {\n\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\tmessage: __(\"Ignore Pricing Rule is enabled. Cannot apply coupon code.\"),\n\t\t\t\t\t\tindicator: \"orange\",\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis.setup_listener_for_payments();\n\n\t\tthis.$payment_modes.on(\"click\", \".shortcut\", function () {\n\t\t\tconst value = $(this).attr(\"data-value\");\n\t\t\tme.selected_mode.set_value(value);\n\t\t});\n\n\t\t\n\t\tthis.$component.on(\"click\", \".submit-order-btn\", () => {\n\t\t\tconst doc = this.events.get_frm().doc;\n\t\t\tconst paid_amount = parseFloat(doc.paid_amount).toFixed(2);  // Convert to 2 decimal places\n\t\t\tconst items = doc.items;\n\t\t\tconst payments = doc.payments;\n\t\t\t\n\t\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t\t? parseFloat(doc.grand_total).toFixed(2)  // Convert to 2 decimal places\n\t\t\t\t: parseFloat(doc.rounded_total).toFixed(2);  // Convert to 2 decimal places\n\t\t\n\t\t\t// Validate that there are items and a non-zero paid amount\n\t\t\tif (paid_amount === 0 || !items.length) {\n\t\t\t\tconst message = items.length\n\t\t\t\t\t? __(\"You cannot submit the order without payment.\")\n\t\t\t\t\t: __(\"You cannot submit an empty order.\");\n\t\t\t\tfrappe.show_alert({ message, indicator: \"orange\" });\n\t\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\n\t\t\tconst total_paid_amount = payments.reduce((sum, p) => sum + (p.amount || 0), 0);\n\n\t\t\t// Round to 2 decimal places to avoid floating-point precision issues\n\t\t\tconst rounded_total_paid = parseFloat(total_paid_amount).toFixed(2);\n\t\t\tconst rounded_grand_total = parseFloat(grand_total).toFixed(2);\n\n\t\t\tconst cash_payment_present = payments.some(p => p.mode_of_payment === 'Cash' || p.mode_of_payment === 'Gift Certificate' && p.amount > 0);\n\n\t\t\t// Compare the rounded values\n\t\t\tif (parseFloat(rounded_total_paid) > parseFloat(rounded_grand_total) && !cash_payment_present) {\n\t\t\t\tfrappe.show_alert({\n\t\t\t\t\tmessage: __(\"Paid amount cannot be greater than the grand total for non-cash payments.\"),\n\t\t\t\t\tindicator: \"orange\"\n\t\t\t\t});\n\t\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\n\t\t\t// If all checks pass, save as draft\n\t\t\tthis.events.save_as_draft();\n\t\t});\n\t\t\n\t\t\n\t\t\n\t\t\n\t\tfrappe.ui.form.on(\"POS Invoice\", \"paid_amount\", (frm) => {\n\t\t\tthis.update_totals_section(frm.doc);\n\t\t\t// need to re calculate cash shortcuts after discount is applied\n\t\t\tconst is_cash_shortcuts_invisible = !this.$payment_modes.find(\".cash-shortcuts\").is(\":visible\");\n\t\t\tthis.attach_cash_shortcuts(frm.doc);\n\t\t\t!is_cash_shortcuts_invisible &&\n\t\t\t\tthis.$payment_modes.find(\".cash-shortcuts\").css(\"display\", \"grid\");\n\t\t\tthis.render_payment_mode_dom();\n\t\t});\n\n\t\tfrappe.ui.form.on(\"POS Invoice\", \"loyalty_amount\", (frm) => {\n\t\t\tconst formatted_currency = format_currency(frm.doc.loyalty_amount, frm.doc.currency);\n\t\t\tthis.$payment_modes.find(`.loyalty-amount-amount`).html(formatted_currency);\n\t\t});\n\n\t\tfrappe.ui.form.on(\"Sales Invoice Payment\", \"amount\", (frm, cdt, cdn) => {\n\t\t\t// for setting correct amount after loyalty points are redeemed\n\n\t\t\tconst default_mop = locals[cdt][cdn];\n\n\t\t\t// console.log(frm)\n\t\t\t// console.log(default_mop)\n\n\t\t\tconst mode = default_mop.mode_of_payment.replace(/ +/g, \"_\").toLowerCase();\n\t\t\tif (this[`${mode}_control`] && this[`${mode}_control`].get_value() != default_mop.amount) {\n\t\t\t\tthis[`${mode}_control`].set_value(default_mop.amount);\n\n\t\t\t}\n\t\t});\n\t}\n\n\n\tsetup_listener_for_payments() {\n\t\tfrappe.realtime.on(\"process_phone_payment\", (data) => {\n\t\t\tconst doc = this.events.get_frm().doc;\n\t\t\tconst { response, amount, success, failure_message } = data;\n\t\t\tlet message, title;\n\n\t\t\tif (success) {\n\t\t\t\ttitle = __(\"Payment Received\");\n\t\t\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t\t\t? doc.grand_total\n\t\t\t\t\t: doc.rounded_total;\n\t\t\t\tif (amount >= grand_total) {\n\t\t\t\t\tfrappe.dom.unfreeze();\n\t\t\t\t\tmessage = __(\"Payment of {0} received successfully.\", [\n\t\t\t\t\t\tformat_currency(amount, doc.currency, 0),\n\t\t\t\t\t]);\n\t\t\t\t\tthis.events.submit_invoice();\n\t\t\t\t\tcur_frm.reload_doc();\n\t\t\t\t} else {\n\t\t\t\t\tmessage = __(\n\t\t\t\t\t\t\"Payment of {0} received successfully. Waiting for other requests to complete...\",\n\t\t\t\t\t\t[format_currency(amount, doc.currency, 0)]\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else if (failure_message) {\n\t\t\t\tmessage = failure_message;\n\t\t\t\ttitle = __(\"Payment Failed\");\n\t\t\t}\n\n\t\t\tfrappe.msgprint({ message: message, title: title });\n\t\t});\n\t}\n\n\tauto_set_remaining_amount() {\n\t\tconst doc = this.events.get_frm().doc;\n\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t? doc.grand_total\n\t\t\t: doc.rounded_total;\n\t\tconst remaining_amount = grand_total - doc.paid_amount;\n\t\tconst current_value = this.selected_mode ? this.selected_mode.get_value() : undefined;\n\t\tif (!current_value && remaining_amount > 0 && this.selected_mode) {\n\t\t\tthis.selected_mode.set_value(remaining_amount);\n\t\t}\n\t}\n\n\tattach_shortcuts() {\n\t\tconst shift_label = frappe.utils.is_mac() ? \"\u2318\" : \"Shift\";\n\t\tthis.$component.find(\".submit-order-btn\").attr(\"title\", `${shift_label}+Enter`);\n\t\n\t\t// Ctrl + Enter shortcut for submitting the order\n\t\tfrappe.ui.keys.on(\"shift+enter\", () => {\n\t\t\tconst paymentMethodVisible = this.$component.find(\".payment-section\").is(\":visible\");\n\t\n\t\t\t// Only trigger the click if the payment method section is visible\n\t\t\tif (paymentMethodVisible) {\n\t\t\t\tthis.$component.find(\".submit-order-btn\").click();\n\t\t\t}\n\t\t});\n\t\n\t\n\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: \"shift+tab\",\n\t\t\taction: () => {\n\t\t\t\tconst payment_is_visible = this.$component.is(\":visible\");\n\t\t\t\tlet active_mode = this.$payment_modes.find(\".border-primary\");\n\t\t\t\tactive_mode = active_mode.length ? active_mode.attr(\"data-mode\") : undefined;\n\n\t\t\t\tif (!active_mode) return;\n\n\t\t\t\tconst mode_of_payments = Array.from(this.$payment_modes.find(\".mode-of-payment\")).map((m) =>\n\t\t\t\t\t$(m).attr(\"data-mode\")\n\t\t\t\t);\n\t\t\t\tconst mode_index = mode_of_payments.indexOf(active_mode);\n\t\t\t\tconst next_mode_index = (mode_index + 1) % mode_of_payments.length;\n\t\t\t\tconst next_mode_to_be_clicked = this.$payment_modes.find(\n\t\t\t\t\t`.mode-of-payment[data-mode=\"${mode_of_payments[next_mode_index]}\"]`\n\t\t\t\t);\n\n\t\t\t\tif (payment_is_visible && mode_index != next_mode_index) {\n\t\t\t\t\tnext_mode_to_be_clicked.click();\n\t\t\t\t}\n\t\t\t},\n\t\t\tcondition: () =>\n\t\t\t\tthis.$component.is(\":visible\") && this.$payment_modes.find(\".border-primary\").length,\n\t\t\tdescription: __(\"Switch Between Payment Modes\"),\n\t\t\tignore_inputs: true,\n\t\t\tpage: cur_page.page.page,\n\t\t});\n\t}\n\n\ttoggle_numpad() {\n\t\t// pass\n\t}\n\n\trender_payment_section() {\n\t\tthis.render_payment_mode_dom();\n\t\tthis.make_invoice_fields_control();\n\t\tthis.update_totals_section();\n\t\tthis.focus_on_default_mop();\n\t}\n\n\tafter_render() {\n\t\tconst frm = this.events.get_frm();\n\t\tfrm.script_manager.trigger(\"after_payment_render\", frm.doc.doctype, frm.doc.docname);\n\t}\n\n\tedit_cart() {\n\t\tthis.events.toggle_other_sections(false);\n\t\tthis.toggle_component(false);\n\t}\n\n\tcheckout() {\n\t\tthis.events.toggle_other_sections(true);\n\t\tthis.toggle_component(true);\n\t\tthis.render_payment_section();\n\t\tthis.after_render();\n\t}\n\n\ttoggle_remarks_control() {\n\t\tif (this.$remarks.find(\".frappe-control\").length) {\n\t\t\tthis.$remarks.html(\"+ Add Remark\");\n\t\t} else {\n\t\t\tthis.$remarks.html(\"\");\n\t\t\tthis[`remark_control`] = frappe.ui.form.make_control({\n\t\t\t\tdf: {\n\t\t\t\t\tlabel: __(\"Remark\"),\n\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\tonchange: function () { },\n\t\t\t\t},\n\t\t\t\tparent: this.$totals_section.find(`.remarks`),\n\t\t\t\trender_input: true,\n\t\t\t});\n\t\t\tthis[`remark_control`].set_value(\"\");\n\t\t}\n\t}\n\n\n\n\trender_payment_mode_dom() {\n\t\tconst doc = this.events.get_frm().doc;\n\t\tconst payments = doc.payments;\n\t\tconst currency = doc.currency;\n\n\t\tconst customer_group = doc.customer_group;\n\t\tconst allowed_payment_modes = [\"2306\", \"2307\"];\n\n\t\tthis.$payment_modes.html(\n\n\t\t\t`<div style=\"display: flex; flex-wrap: wrap; gap: 16px;\">\n\t\t\t\t${payments.map((p, i) => {\n\t\t\t\tconst mode = p.mode_of_payment.replace(/ +/g, \"_\").toLowerCase();\n\t\t\t\tconst payment_type = p.type;\n\t\t\t\tconst amount = p.amount > 0 ? format_currency(p.amount, currency) : \"\";\n\n\t\t\t\tconst displayStyle = (p.mode_of_payment === \"2307G\" && customer_group !== \"Government\") ? 'display: none;' : '';\n\n\t\t\t\tlet paymentModeHtml = `\n\t\t\t\t\t\t<div class=\"payment-mode-wrapper\" style=\"flex: 0 0 calc(50% - 16px); min-width: calc(50% - 16px); ${displayStyle}\">\n\t\t\t\t\t\t<div class=\"mode-of-payment\" data-mode=\"${mode}\" data-payment-type=\"${payment_type}\" style=\"border: 1px solid #ccc; border-radius: 8px; padding: 16px; box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); background-color: #fff;\">\n\t\t\t\t\t\t\t ${p.mode_of_payment}\n\t\t\t\t\t\t\t<div class=\"${mode}-amount pay-amount\" style=\"font-weight: bold;\">${amount}</div>\n\t\t\t\t\t\t\t<div class=\"${mode} mode-of-payment-control\"></div>\n\t\t\t\t\t\t\t<div class=\"${mode} cash-button\"></div>\n\t\t\t\t\t`;\n\n\t\t\t\tswitch (p.mode_of_payment) {\n\t\t\t\t\tcase \"Cards\":\n\t\t\t\t\tcase \"Debit Card\":\n\t\t\t\t\tcase \"Credit Card\":\n\t\t\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t\t<div class=\"${mode} bank-name\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} holder-name\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} card_type_control\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} card-number\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} expiry-date\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} approval-code\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} button-row\" style=\"display: flex; gap: 5px; align-items: center;\">\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} save-button\"></div>\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} discard-button\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"GCash\":\n\t\t\t\t\tcase \"PayMaya\":\n\t\t\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t\t<div class=\"${mode} mobile-number\" style=\"margin-top:10px;\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} reference-number\" style=\"margin-top:10px;\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} button-row\" style=\"display: flex; gap: 5px; align-items: center;\">\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} save-button\"></div>\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} discard-button\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Cheque\":\n\t\t\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t\t<div class=\"${mode} bank-name\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} check-name\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} check-number\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} check-date\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} button-row\" style=\"display: flex; gap: 5px; align-items: center;\">\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} save-button\"></div>\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} discard-button\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"2307G\":\n\t\t\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t\t<div class=\"${mode} actual-gov-one\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} button-row\" style=\"display: flex; gap: 5px; align-items: center;\">\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} save-button\"></div>\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} discard-button\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"2307\":\n\t\t\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t\t<div class=\"${mode} actual-gov-two\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} button-row\" style=\"display: flex; gap: 5px; align-items: center;\">\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} save-button\"></div>\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} discard-button\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"QR Payment\":\n\t\t\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t\t<div class=\"${mode} payment-type\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} bank-type\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} qr-reference-number\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} button-row\" style=\"display: flex; gap: 5px; align-items: center;\">\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} save-button\"></div>\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} discard-button\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Charge\":\n\t\t\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t\t<div class=\"${mode} customer\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} charge-invoice-number\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} po-number\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} representative\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} id-number\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} approved-by\"></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} button-row\" style=\"display: flex; gap: 5px; align-items: center;\">\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} save-button\"></div>\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} discard-button\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Gift Certificate\":\n\t\t\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t  <div class=\"${mode} gift-code\"></div>\n\t\t\t\t\t\t\t  <div class=\"${mode} button-row\" style=\"display: flex; gap: 3px; align-items: center;\">\n\t\t\t\t\t\t\t  \t\t<div class=\"${mode} button-code mt-2\" ></div>\n\t\t\t\t\t\t\t\t\t<div class=\"${mode} discard-button\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t   `;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Amesco Plus\":\n\t\t\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t<div class=\"${mode} amesco-code\"></div>\n\t\t\t\t\t\t\t<div class=\"${mode} button-row\" style=\"display: flex; gap: 3px; align-items: center;\">\n\t\t\t\t\t\t\t\t<div class=\"${mode} button-amesco-plus mt-2\" ></div>\n\t\t\t\t\t\t\t\t<div class=\"${mode} discard-button\"></div>\n\t\t\t\t\t\t\t</div>\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t   `;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tpaymentModeHtml += `\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`;\n\n\t\t\t\treturn paymentModeHtml;\n\t\t\t}).join(\"\")}\n\t\t\t</div>`\n\t\t);\n\n\n\n\t\tpayments.forEach((p) => {\n\t\t\tconst mode = p.mode_of_payment.replace(/ +/g, \"_\").toLowerCase();\n\t\t\tconst me = this;\n\t\t\tconst frm = this.events.get_frm()\n\n\n\t\t\tthis[`${mode}_control`] = frappe.ui.form.make_control({\n\t\t\t\tdf: {\n\t\t\t\t\tlabel: \"Amount\",\n\t\t\t\t\tfieldtype: \"Currency\",\n\t\t\t\t\tplaceholder: __(\"Enter {0} amount.\", [p.mode_of_payment]),\n\t\t\t\t\tread_only: (mode === \"gift_certificate\"),\n\t\t\t\t\tonchange: function () {\n\t\t\t\t\t\tconst current_value = frappe.model.get_value(p.doctype, p.name, \"amount\");\n\t\t\t\t\t\tif (current_value != this.value) {\n\t\t\t\t\t\t\t// frappe.model\n\t\t\t\t\t\t\t// \t// .set_value(p.doctype, p.name, \"amount\", flt(this.value))\n\t\t\t\t\t\t\t// \t.then(() => me.update_totals_section());\n\n\n\n\t\t\t\t\t\t\tconst formatted_currency = format_currency(this.value, currency);\n\t\t\t\t\t\t\tme.$payment_modes.find(`.${mode}-amount`).html(formatted_currency);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\treqd: true // Make the amount field required\n\t\t\t\t},\n\t\t\t\tparent: this.$payment_modes.find(`.${mode}.mode-of-payment-control`),\n\t\t\t\trender_input: true,\n\t\t\t});\n\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst $amountField = this.$payment_modes.find(`.${mode}.mode-of-payment-control input[data-fieldname=\"amount\"]`);\n\t\t\t\t$amountField.focus();\n\t\t\t\t$amountField.select(); // Selects the text inside the field for easy replacement\n\t\t\t}, 300); // Use a small delay to ensure the element is in the DOM\n\n\t\t\t// Add save and discard buttons for cash mode\n\t\t\tif (mode === \"cash\") {\n\t\t\t\t// Add save button\n\t\t\t\tconst save_button = $('<button/>', {\n\t\t\t\t\ttext: 'Save',\n\t\t\t\t\tclass: 'btn btn-primary',\n\t\t\t\t\tclick: function () {\n\t\t\t\t\t\tconst amount_value = me[`${mode}_control`].get_value();\n\n\t\t\t\t\t\tif (!amount_value) {\n\t\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\t\tmessage: __('All fields are required.'),\n\t\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t\t});\n\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\n\n\t\t\t\t\t\tfrappe.model\n\t\t\t\t\t\t\t.set_value(p.doctype, p.name, \"amount\", flt(amount_value))\n\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\tme.update_totals_section();\n\t\t\t\t\t\t\t\tconst formatted_currency = format_currency(amount_value, currency);\n\t\t\t\t\t\t\t\tme.$payment_modes.find(`.${mode}-amount`).html(formatted_currency);\n\n\t\t\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\t\t\t\tmessage: __('Cash payment details have been saved.'),\n\t\t\t\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t// Add event listener for Enter key\n\t\t\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Add discard button\n\t\t\t\tconst discard_button = $('<button/>', {\n\t\t\t\t\ttext: 'Discard',\n\t\t\t\t\tclass: 'btn btn-secondary',\n\t\t\t\t\tclick: function () {\n\t\t\t\t\t\tme[`${mode}_control`].set_value(0);\n\t\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0).then(() => {\n\t\t\t\t\t\t\tme.update_totals_section();\n\t\t\t\t\t\t\tme.$payment_modes.find(`.${mode}-amount`).html(format_currency(0, currency));\n\n\t\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\t\tmessage: __('Cash payment details have been discarded.'),\n\t\t\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// Add event listener for Enter key\n\t\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Append the save and discard buttons to the parent container\n\t\t\t\tconst button_container = $('<div/>', { style: 'display: flex; gap: 5px; align-items: center;' });\n\t\t\t\tbutton_container.append(save_button);\n\t\t\t\tbutton_container.append(discard_button);\n\t\t\t\tthis.$payment_modes.find(`.${mode}.cash-button`).append(button_container);\n\n\t\t\t\t// Add keypress event listener for Enter key to trigger save button click\n\t\t\t\tthis.$payment_modes.find(`.${mode}.mode-of-payment-control input`).keypress(function (e) {\n\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.$payment_modes.find(`.${mode}.mode-of-payment-control input`).keypress(function (e) {\n\t\t\t\t\tif (e.which === 8) { // Enter key pressed\n\t\t\t\t\t\tdiscard_button.click();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t\tthis[`${mode}_control`].set_value(0);\n\n\t\t\tif (p.mode_of_payment === \"Cards\") {\n\n\t\t\t\tlet existing_custom_bank_name = frappe.model.get_value(p.doctype, p.name, \"custom_bank_name\");\n\t\t\t\t// Create the bank_name_control without onchange\n\t\t\t\tlet bank_name_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Bank',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Bank Name',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.bank-name`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tbank_name_control.set_value(existing_custom_bank_name || '');\n\t\t\t\tbank_name_control.refresh();\n\n\n\t\t\t\tconst selected_customer = cur_frm.doc.customer;\n\n\t\t\t\tlet existing_custom_card_name = frappe.model.get_value(p.doctype, p.name, \"custom_card_name\");\n\t\t\t\tlet name_on_card_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Name on Card',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Card name holder',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.holder-name`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\n\n\t\t\t\tfrappe.db.get_value('Customer', selected_customer, 'customer_name')\n\t\t\t\t\t.then(r => {\n\t\t\t\t\t\tconst result = r.message.customer_name; // Extract the customer_name from the result\n\t\t\t\t\t\tname_on_card_control.set_value(existing_custom_card_name || result || '');\n\t\t\t\t\t})\n\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\tconsole.error('Error fetching customer name:', error);\n\t\t\t\t\t});\n\n\t\t\t\tname_on_card_control.refresh();\n\n\t\t\t\tlet existing_custom_card_type = frappe.model.get_value(p.doctype, p.name, \"custom_card_type\");\n\t\t\t\tlet card_type_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Card Type',\n\t\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{ label: 'Select Card Type', value: '' },\n\t\t\t\t\t\t\t{ label: 'Visa', value: 'Visa' },\n\t\t\t\t\t\t\t{ label: 'Visa Debit', value: 'Visa Debit' },\n\t\t\t\t\t\t\t{ label: 'Visa Electron', value: 'Visa Electron' },\n\t\t\t\t\t\t\t{ label: 'Credit Card', value: 'Credit Card' },\n\t\t\t\t\t\t\t{ label: 'Mastercard', value: 'Mastercard' },\n\t\t\t\t\t\t\t{ label: 'Mastercard Debit', value: 'Mastercard Debit' },\n\t\t\t\t\t\t\t{ label: 'Maestro', value: 'Maestro' },\n\t\t\t\t\t\t\t{ label: 'American Express (Amex)', value: 'American Express (Amex)' },\n\t\t\t\t\t\t\t{ label: 'Discover', value: 'Discover' },\n\t\t\t\t\t\t\t{ label: 'Diners Club', value: 'Diners Club' },\n\t\t\t\t\t\t\t{ label: 'JCB', value: 'JCB' },\n\t\t\t\t\t\t\t{ label: 'UnionPay', value: 'UnionPay' },\n\t\t\t\t\t\t\t{ label: 'RuPay', value: 'RuPay' },\n\t\t\t\t\t\t\t{ label: 'Interac', value: 'Interac' },\n\t\t\t\t\t\t\t{ label: 'Carte Bancaire (CB)', value: 'Carte Bancaire (CB)' },\n\t\t\t\t\t\t\t{ label: 'Elo', value: 'Elo' },\n\t\t\t\t\t\t\t{ label: 'Mir', value: 'Mir' },\n\t\t\t\t\t\t\t{ label: 'Others', value: 'Others' }\n\t\t\t\t\t\t],\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.card_type_control`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcard_type_control.set_value(existing_custom_card_type || '');\n\t\t\t\tcard_type_control.refresh();\n\n\t\t\t\tlet existing_custom_card_number = frappe.model.get_value(p.doctype, p.name, \"custom_card_number\");\n\t\t\t\tlet card_number_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Card Number',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Last 4 digits',\n\t\t\t\t\t\tmaxlength: 4,\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.card-number`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcard_number_control.set_value(existing_custom_card_number || '');\n\t\t\t\tcard_number_control.refresh();\n\n\t\t\t\tlet existing_custom_card_expiration_date = frappe.model.get_value(p.doctype, p.name, \"custom_card_expiration_date\");\n\t\t\n\t\t\t\tlet expiry_date_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Card Expiration Date',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'MM/YY',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.expiry-date`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\texpiry_date_control.set_value(existing_custom_card_expiration_date || '');\n\t\t\t\texpiry_date_control.refresh();\n\t\t\t\t\n\t\t\t\t// Add event listener to automatically insert '/' after two digits\n\t\t\t\texpiry_date_control.$input.on('input', function () {\n\t\t\t\t\tlet value = this.value.replace(/\\D/g, ''); // Remove any non-digit characters\n\t\t\t\t\tif (value.length >= 2) {\n\t\t\t\t\t\tthis.value = value.slice(0, 2) + '/' + value.slice(2); // Add '/' after the second digit\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.value = value; // Set the value directly if less than 2 digits\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tlet existing_custom_approval_code = frappe.model.get_value(p.doctype, p.name, \"custom_approval_code\");\n\t\t\t\tlet custom_approval_code_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Approval Code',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Approval Code',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.approval-code`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcustom_approval_code_control.set_value(existing_custom_approval_code || '');\n\t\t\t\tcustom_approval_code_control.refresh();\n\n\t\t\t\t// let existing_reference_no = frappe.model.get_value(p.doctype, p.name, \"reference_no\");\n\t\t\t\t// let reference_no_control = frappe.ui.form.make_control({\n\t\t\t\t// \tdf: {\n\t\t\t\t// \t\tlabel: 'Reference No',\n\t\t\t\t// \t\tfieldtype: \"Data\",\n\t\t\t\t// \t\tplaceholder: 'Reference No.',\n\t\t\t\t// \t\treqd: true\n\t\t\t\t// \t},\n\t\t\t\t// \tparent: this.$payment_modes.find(`.${mode}.reference-number`),\n\t\t\t\t// \trender_input: true,\n\t\t\t\t// });\n\t\t\t\t// reference_no_control.set_value(existing_reference_no || '');\n\t\t\t\t// reference_no_control.refresh();\n\n\t\t\t\t// Create a save button for all the fields and append it under the reference control\n\t\t\t\tlet save_button = $(`<button class=\"btn btn-primary\"style=\"text-align: right;\"\">Save</button>`);\n\t\t\t\tthis.$payment_modes.find(`.${mode}.save-button`).append(save_button);\n\n\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\" style=\"text-align: right; margin-left: 10px;\">Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\n\t\t\t\tconst me = this;\n\t\t\t\t// Attach an event listener to the save button\n\t\t\t\tsave_button.on('click', function () {\n\t\t\t\t\tlet amount = me[`${mode}_control`].get_value(); // Get amount value\n\t\t\t\t\tlet bank_name = bank_name_control.get_value();\n\t\t\t\t\tlet card_name = name_on_card_control.get_value();\n\t\t\t\t\tlet card_type = card_type_control.get_value();\n\t\t\t\t\tlet card_number = card_number_control.get_value();\n\t\t\t\t\tlet card_expiry_date = expiry_date_control.get_value();\n\t\t\t\t\tlet approval_code = custom_approval_code_control.get_value();\n\t\t\t\t\t// let reference_no = reference_no_control.get_value();\n\n\t\t\t\t\tif (!amount || !bank_name || !card_name || !card_type || !card_number || !card_expiry_date || !approval_code) {\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('All fields are required.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!validateLastFourDigits(card_number)) {\n\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('Card number must be exactly 4 digits.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t\t\t\t? doc.grand_total\n\t\t\t\t\t\t: doc.rounded_total;\n\t\t\t\t\tconst currency = doc.currency;\n\n\t\t\t\t\tif (amount > grand_total) {\n\t\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('Amount must not exceed the grand total.'),\n\t\t\t\t\t\t\tindicator: 'orange'\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", flt(amount));\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_bank_name\", bank_name);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_name\", card_name);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_type\", card_type);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_number\", card_number);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_expiration_date\", card_expiry_date);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_approval_code\", approval_code);\n\t\t\t\t\t// frappe.model.set_value(p.doctype, p.name, \"reference_no\", reference_no);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\tmessage: __('Card payment details have been saved.'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\n\t\t\t\t});\n\n\t\t\t\tdiscard_button.on('click', function () {\n\t\t\t\t\t// Clear all the fields\n\t\t\t\t\tthis[`${mode}_control`].set_value(0);\n\t\t\t\t\tbank_name_control.set_value('');\n\t\t\t\t\tname_on_card_control.set_value('');\n\t\t\t\t\tcard_type_control.set_value('');\n\t\t\t\t\tcard_number_control.set_value('');\n\t\t\t\t\texpiry_date_control.set_value('');\n\t\t\t\t\tcustom_approval_code_control.set_value('');\n\n\n\t\t\t\t\t// Set values in the model to null or empty string\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_bank_name\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_name\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_type\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_number\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_expiration_date\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_approval_code\", '');\n\n\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tconst controls = [\n\t\t\t\t\tme[`${mode}_control`],\n\t\t\t\t\tbank_name_control,\n\t\t\t\t\tname_on_card_control,\n\t\t\t\t\tcard_type_control,\n\t\t\t\t\tcard_number_control,\n\t\t\t\t\texpiry_date_control,\n\t\t\t\t\tcustom_approval_code_control\n\t\t\t\t]\n\n\t\t\t\tcontrols.forEach(control => {\n\t\t\t\t\tcontrol.$input && control.$input.keypress(function (e) {\n\t\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\n\n\t\t\t\tfunction validateLastFourDigits(value) {\n\t\t\t\t\tconst regex = /^\\d{4}$/;\n\t\t\t\t\treturn regex.test(value);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (p.mode_of_payment === \"GCash\" || p.mode_of_payment === 'PayMaya') {\n\n\t\t\t\tlet existing_custom_phone_number = frappe.model.get_value(p.doctype, p.name, \"custom_phone_number\");\n\t\t\t\tlet phone_number_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Number',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: '09876543212',\n\n\t\t\t\t\t\t// onchange: function () {\n\t\t\t\t\t\t// \tfrappe.model.set_value(p.doctype, p.name, \"custom_phone_number\", this.value);\n\t\t\t\t\t\t// },\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.mobile-number`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tphone_number_control.set_value(existing_custom_phone_number || '');\n\t\t\t\tphone_number_control.refresh();\n\n\n\n\t\t\t\tlet existing_custom_epayment_reference_number = frappe.model.get_value(p.doctype, p.name, \"reference_no\");\n\n\t\t\t\tlet epayment_reference_number_controller = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Reference No',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Reference No.',\n\n\t\t\t\t\t\t// onchange: function () {\n\t\t\t\t\t\t// \tfrappe.model.set_value(p.doctype, p.name, \"reference_no\", this.value);\n\t\t\t\t\t\t// },\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.reference-number`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t\tdefault: p.reference_no || ''\n\t\t\t\t});\n\n\t\t\t\tepayment_reference_number_controller.set_value(existing_custom_epayment_reference_number || '');\n\t\t\t\tepayment_reference_number_controller.refresh();\n\n\n\n\t\t\t\tlet save_button = $('<button class=\"btn btn-primary\" style=\"text-align: right;\">save</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.save-button`).append(save_button);\n\n\t\t\t\t// Create discard button\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\" style=\"text-align: right; margin-left: 10px;\">Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\n\t\t\t\tconst me = this;\n\n\t\t\t\t// Attach event listener to the save button\n\t\t\t\tsave_button.on('click', function () {\n\t\t\t\t\tlet amount = me[`${mode}_control`].get_value(); // Get amount value\n\t\t\t\t\tlet phone_number = phone_number_control.get_value();\n\t\t\t\t\tlet reference_no = epayment_reference_number_controller.get_value();\n\n\n\t\t\t\t\tif (!amount) {\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('All fields are required.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t\t\t\t? doc.grand_total\n\t\t\t\t\t\t: doc.rounded_total;\n\t\t\t\t\tconst currency = doc.currency;\n\n\n\t\t\t\t\tif (amount > grand_total) {\n\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('Amount must not exceed the grand total.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", flt(amount));\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_phone_number\", phone_number);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"reference_no\", reference_no);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\tmessage: __('Payment details have been saved.'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\t\t\t\t// Attach event listener to the discard button\n\t\t\t\tdiscard_button.on('click', function () {\n\t\t\t\t\t// Clear all the fields\n\t\t\t\t\tme[`${mode}_control`].set_value(0);\n\t\t\t\t\tphone_number_control.set_value('');\n\t\t\t\t\tepayment_reference_number_controller.set_value('');\n\n\t\t\t\t\t// Set values in the model to null or empty string\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_phone_number\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"reference_no\", '');\n\n\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tconst controls = [\n\t\t\t\t\tme[`${mode}_control`],\n\t\t\t\t\tphone_number_control,\n\t\t\t\t\tepayment_reference_number_controller,\n\t\t\t\t];\n\n\t\t\t\tcontrols.forEach(control => {\n\t\t\t\t\tcontrol.$input && control.$input.keypress(function (e) {\n\t\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\n\t\t\t}\n\n\n\t\t\tif (p.mode_of_payment === \"Debit Card\" || p.mode_of_payment === \"Credit Card\") {\n\t\t\t\t// Retrieve existing values\n\t\t\t\tlet existing_custom_bank_name = frappe.model.get_value(p.doctype, p.name, \"custom_bank_name\");\n\t\t\t\tlet existing_custom_card_name = frappe.model.get_value(p.doctype, p.name, \"custom_card_name\");\n\t\t\t\tlet existing_custom_card_type = frappe.model.get_value(p.doctype, p.name, \"custom_card_type\");\n\t\t\t\tlet existing_custom_card_number = frappe.model.get_value(p.doctype, p.name, \"custom_card_number\");\n\t\t\t\tlet existing_custom_card_expiration_date = frappe.model.get_value(p.doctype, p.name, \"custom_card_expiration_date\");\n\t\t\t\tlet existing_custom_approval_code = frappe.model.get_value(p.doctype, p.name, \"custom_approval_code\");\n\t\t\n\t\t\t\t// Create controls\n\t\t\t\tlet bank_name_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Bank',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Bank Name',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.bank-name`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tbank_name_control.set_value(existing_custom_bank_name || '');\n\t\t\t\tbank_name_control.refresh();\n\n\n\n\t\t\t\tconst selected_customer = cur_frm.doc.customer;\n\t\t\t\tlet name_on_card_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Name on Card',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Card name holder',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.holder-name`), // Ensure mode is defined and correct\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\n\t\t\t\t// Fetch the customer name and set it to the control when available\n\t\t\t\tfrappe.db.get_value('Customer', selected_customer, 'customer_name')\n\t\t\t\t\t.then(r => {\n\t\t\t\t\t\tconst result = r.message.customer_name; // Extract the customer_name from the result\n\t\t\t\t\t\tname_on_card_control.set_value(existing_custom_card_name || result || '');\n\t\t\t\t\t})\n\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\tconsole.error('Error fetching customer name:', error);\n\t\t\t\t\t});\n\n\t\t\t\t// Refresh the control to render it properly\n\t\t\t\tname_on_card_control.refresh();\n\n\t\t\t\tlet card_type_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Card Type',\n\t\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{ label: 'Select Card Type', value: '' },\n\t\t\t\t\t\t\t{ label: 'Visa', value: 'Visa' },\n\t\t\t\t\t\t\t{ label: 'Visa Debit', value: 'Visa Debit' },\n\t\t\t\t\t\t\t{ label: 'Visa Electron', value: 'Visa Electron' },\n\t\t\t\t\t\t\t{ label: 'Credit Card', value: 'Credit Card' },\n\t\t\t\t\t\t\t{ label: 'Mastercard', value: 'Mastercard' },\n\t\t\t\t\t\t\t{ label: 'Mastercard Debit', value: 'Mastercard Debit' },\n\t\t\t\t\t\t\t{ label: 'Maestro', value: 'Maestro' },\n\t\t\t\t\t\t\t{ label: 'American Express (Amex)', value: 'American Express (Amex)' },\n\t\t\t\t\t\t\t{ label: 'Discover', value: 'Discover' },\n\t\t\t\t\t\t\t{ label: 'Diners Club', value: 'Diners Club' },\n\t\t\t\t\t\t\t{ label: 'JCB', value: 'JCB' },\n\t\t\t\t\t\t\t{ label: 'UnionPay', value: 'UnionPay' },\n\t\t\t\t\t\t\t{ label: 'RuPay', value: 'RuPay' },\n\t\t\t\t\t\t\t{ label: 'Interac', value: 'Interac' },\n\t\t\t\t\t\t\t{ label: 'Carte Bancaire (CB)', value: 'Carte Bancaire (CB)' },\n\t\t\t\t\t\t\t{ label: 'Elo', value: 'Elo' },\n\t\t\t\t\t\t\t{ label: 'Mir', value: 'Mir' },\n\t\t\t\t\t\t\t{ label: 'Others', value: 'Others' }\n\t\t\t\t\t\t],\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.card_type_control`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcard_type_control.set_value(existing_custom_card_type || '');\n\t\t\t\tcard_type_control.refresh();\n\n\n\n\t\t\t\tlet card_number_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Card Number',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Last 4 digits',\n\t\t\t\t\t\tmaxlength: 4,\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.card-number`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcard_number_control.set_value(existing_custom_card_number || '');\n\t\t\t\tcard_number_control.refresh();\n\n\t\t\t\tlet expiry_date_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Card Expiration Date',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'MM/YY',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.expiry-date`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\texpiry_date_control.set_value(existing_custom_card_expiration_date || '');\n\t\t\t\texpiry_date_control.refresh();\n\t\t\t\t\n\t\t\t\t// Add event listener to automatically insert '/' after two digits\n\t\t\t\texpiry_date_control.$input.on('input', function () {\n\t\t\t\t\tlet value = this.value.replace(/\\D/g, ''); // Remove any non-digit characters\n\t\t\t\t\tif (value.length >= 2) {\n\t\t\t\t\t\tthis.value = value.slice(0, 2) + '/' + value.slice(2); // Add '/' after the second digit\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.value = value; // Set the value directly if less than 2 digits\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tlet custom_approval_code_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Approval Code',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Approval Code',\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.approval-code`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcustom_approval_code_control.set_value(existing_custom_approval_code || '');\n\t\t\t\tcustom_approval_code_control.refresh();\n\n\n\n\n\t\t\t\tlet save_button = $('<button class=\"btn btn-primary\" style=\"text-align: right;\">Save</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.save-button`).append(save_button);\n\n\t\t\t\t// Create discard button\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\" style=\"text-align: right; margin-left: 10px;\">Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\n\t\t\t\tconst me = this;\n\n\t\t\t\t// Attach event listener to the save button\n\t\t\t\tsave_button.on('click', function () {\n\t\t\t\t\tlet amount = me[`${mode}_control`].get_value(); // Get amount value\n\t\t\t\t\tlet bank_name = bank_name_control.get_value();\n\t\t\t\t\tlet card_name = name_on_card_control.get_value();\n\t\t\t\t\tlet card_type = card_type_control.get_value();\n\t\t\t\t\tlet card_number = card_number_control.get_value();\n\t\t\t\t\tlet card_expiry_date = expiry_date_control.get_value();\n\t\t\t\t\tlet approval_code = custom_approval_code_control.get_value();\n\n\t\t\t\t\tif  (!amount || !bank_name || !card_name || !card_number || !card_expiry_date)  {\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('All fields are required.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!validateLastFourDigits(card_number)) {\n\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('Card number must be exactly 4 digits.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\n\t\t\t\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t\t\t\t? doc.grand_total\n\t\t\t\t\t\t: doc.rounded_total;\n\t\t\t\t\tconst currency = doc.currency;\n\n\n\t\t\t\t\tif (amount > grand_total) {\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('Amount must not exceed the grand total.'),\n\t\t\t\t\t\t\tindicator: 'orange'\n\t\t\t\t\t\t});\n\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", flt(amount));\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_bank_name\", bank_name);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_name\", card_name);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_type\", card_type);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_number\", card_number);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_expiration_date\", card_expiry_date);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_approval_code\", approval_code);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\tmessage: __('Card payment details have been saved.'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\n\t\t\t\t});\n\n\t\t\t\t// Attach event listener to the discard button\n\t\t\t\tdiscard_button.on('click', function () {\n\t\t\t\t\t// Clear all the fields\n\t\t\t\t\tme[`${mode}_control`].set_value(0);\n\t\t\t\t\tbank_name_control.set_value('');\n\t\t\t\t\tname_on_card_control.set_value('');\n\t\t\t\t\tcard_number_control.set_value('');\n\t\t\t\t\texpiry_date_control.set_value('');\n\t\t\t\t\tcustom_approval_code_control.set_value('');\n\n\t\t\t\t\t// Set values in the model to null or empty string\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_bank_name\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_name\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_number\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_card_expiration_date\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_approval_code\", '');\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\t\t\t\tfunction validateLastFourDigits(value) {\n\t\t\t\t\tconst regex = /^\\d{4}$/;\n\t\t\t\t\treturn regex.test(value);\n\t\t\t\t}\n\n\t\t\t\tconst controls = [\n\t\t\t\t\tme[`${mode}_control`],\n\t\t\t\t\tbank_name_control,\n\t\t\t\t\tname_on_card_control,\n\t\t\t\t\tcard_number_control,\n\t\t\t\t\texpiry_date_control,\n\t\t\t\t\tcustom_approval_code_control\n\t\t\t\t];\n\n\t\t\t\tcontrols.forEach(control => {\n\t\t\t\t\tcontrol.$input && control.$input.keypress(function (e) {\n\t\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t}\n\n\n\t\t\tif (p.mode_of_payment === \"Cheque\" || p.mode_of_payment === 'Government') {\n\n\t\t\t\tlet existing_custom_bank_name = frappe.model.get_value(p.doctype, p.name, \"custom_check_bank_name\");\n\n\t\t\t\t// Create the bank_name_control with the existing value if it exists\n\t\t\t\tlet bank_name_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Bank Of Cheque',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Bank Of Cheque',\n\t\t\t\t\t\treqd: true\n\n\t\t\t\t\t\t// onchange: function () {\n\t\t\t\t\t\t// \tfrappe.model.set_value(p.doctype, p.name, \"custom_check_bank_name\", this.value);\n\t\t\t\t\t\t// },\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.bank-name`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\n\t\t\t\t// Set the existing value and refresh the control\n\t\t\t\tbank_name_control.set_value(existing_custom_bank_name || '');\n\t\t\t\tbank_name_control.refresh();\n\n\n\t\t\t\tconst selected_customer = cur_frm.doc.customer;\n\n\t\t\t\tlet existing_custom_check_name = frappe.model.get_value(p.doctype, p.name, \"custom_name_on_check\");\n\t\t\t\tlet check_name_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Name On Cheque',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Cheque Name',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t\t// onchange: function () {\n\t\t\t\t\t\t// \tfrappe.model.set_value(p.doctype, p.name, \"custom_name_on_check\", this.value);\n\t\t\t\t\t\t// },\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.check-name`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\t// Set the existing value and refresh the control\n\t\t\t\tfrappe.db.get_value('Customer', selected_customer, 'customer_name')\n\t\t\t\t\t.then(r => {\n\t\t\t\t\t\tconst result = r.message.customer_name; // Extract the customer_name from the result\n\t\t\t\t\t\tcheck_name_control.set_value(existing_custom_check_name || result || '');\n\t\t\t\t\t})\n\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\tconsole.error('Error fetching customer name:', error);\n\t\t\t\t\t});\n\t\t\n\t\t\t\tcheck_name_control.refresh();\n\n\n\t\t\t\tlet existing_custom_check_number = frappe.model.get_value(p.doctype, p.name, \"custom_check_number\");\n\t\t\t\tlet check_number_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Cheque Number',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Cheque Number',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t\t// onchange: function () {\n\t\t\t\t\t\t// \tfrappe.model.set_value(p.doctype, p.name, \"custom_check_number\", this.value);\n\t\t\t\t\t\t// },\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.check-number`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\t// Set the existing value and refresh the control\n\t\t\t\tcheck_number_control.set_value(existing_custom_check_number || '');\n\t\t\t\tcheck_number_control.refresh();\n\n\t\t\t\tlet existing_custom_check_date = frappe.model.get_value(p.doctype, p.name, \"custom_check_date\");\n\t\t\t\tlet check_date_control = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tfieldname: 'custom_check_date',\n\t\t\t\t\t\tlabel: 'Cheque Date',\n\t\t\t\t\t\tfieldtype: \"Date\",\n\t\t\t\t\t\tplaceholder: 'Cheque Date',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t\t// onchange: function () {\n\t\t\t\t\t\t// \tfrappe.model.set_value(p.doctype, p.name, \"custom_check_date\", this.get_value());\n\t\t\t\t\t\t// }\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.check-date`),\n\t\t\t\t\trender_input: true\n\t\t\t\t});\n\t\t\t\t// Set the existing value and refresh the control\n\t\t\t\tcheck_date_control.set_value(existing_custom_check_date || frappe.datetime.nowdate());\n\t\t\t\tcheck_date_control.refresh();\n\n\t\t\t\tlet save_button = $(`<button class=\"btn btn-primary\"style=\"text-align: right;\"\">Save</button>`);\n\t\t\t\tthis.$payment_modes.find(`.${mode}.save-button`).append(save_button);\n\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\" style=\"text-align: right; margin-left: 10px;\">Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\n\t\t\t\tconst me = this;\n\t\t\t\t// Attach an event listener to the save button\n\t\t\t\tsave_button.on('click', function () {\n\t\t\t\t\tlet amount = me[`${mode}_control`].get_value(); // Get amount value\n\t\t\t\t\tlet bank_name = bank_name_control.get_value();\n\t\t\t\t\tlet check_name = check_name_control.get_value();\n\t\t\t\t\tlet check_number = check_number_control.get_value();\n\t\t\t\t\tlet check_date = check_date_control.get_value();\n\t\t\t\t\t// let reference_no = reference_no_control.get_value();\n\n\t\t\t\t\tif (!amount || !bank_name || !check_name || !check_number || !check_date) {\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('All fields are required.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t\t\t\t? doc.grand_total\n\t\t\t\t\t\t: doc.rounded_total;\n\t\t\t\t\tconst currency = doc.currency;\n\n\n\t\t\t\t\tif (amount > grand_total) {\n\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('Amount must not exceed the grand total.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", flt(amount));\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_check_bank_name\", bank_name);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_name_on_check\", check_name);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_check_number\", check_number);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_check_date\", check_date);\n\t\t\t\t\t// frappe.model.set_value(p.doctype, p.name, \"reference_no\", reference_no);\n\n\n\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\tmessage: __('Cheque payment details have been saved.'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\n\t\t\t\tdiscard_button.on('click', function () {\n\t\t\t\t\tme[`${mode}_control`].set_value(0);\n\t\t\t\t\tbank_name_control.set_value('');\n\t\t\t\t\tcheck_name_control.set_value('');\n\t\t\t\t\tcheck_number_control.set_value('');\n\t\t\t\t\tcheck_date_control.set_value('');\n\t\t\t\t\t// let reference_no = reference_no_control.get_value();\n\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_check_bank_name\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_name_on_check\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_check_number\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_check_date\", '');\n\t\t\t\t\t// frappe.model.set_value(p.doctype, p.name, \"reference_no\", reference_no);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\n\t\t\t\tconst controls = [\n\t\t\t\t\tme[`${mode}_control`],\n\t\t\t\t\tbank_name_control,\n\t\t\t\t\tcheck_name_control,\n\t\t\t\t\tcheck_number_control,\n\t\t\t\t\tcheck_date_control,\n\t\t\t\t];\n\n\t\t\t\tcontrols.forEach(control => {\n\t\t\t\t\tcontrol.$input && control.$input.keypress(function (e) {\n\t\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\n\t\t\t}\n\n\n\t\t\tif (p.mode_of_payment === \"2307G\") {\n\t\t\t\t// console.log('Form 2306 Expected: ', doc.custom_2306);\n\n\n\t\t\t\tlet check_form_2306 = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: `Expected 2307G Amount`,\n\t\t\t\t\t\tfieldtype: \"Currency\",\n\t\t\t\t\t\tplaceholder: 'Actual 2307G',\n\t\t\t\t\t\tread_only: 1, // Set the field to read-only\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.actual-gov-one`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\n\t\t\t\t// Set the latest value of doc.custom_2306 directly\n\t\t\t\tlet latest_form_2306_value = doc.custom_2306;\n\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_form_2306\", latest_form_2306_value);\n\n\t\t\t\t// Set the existing value and refresh the control\n\t\t\t\tcheck_form_2306.set_value(latest_form_2306_value || '');\n\t\t\t\tcheck_form_2306.refresh();\n\n\n\t\t\t\tlet save_button = $(`<button class=\"btn btn-primary\"style=\"text-align: right;\"\">Save</button>`);\n\t\t\t\tthis.$payment_modes.find(`.${mode}.save-button`).append(save_button);\n\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\" style=\"text-align: right; margin-left: 10px;\">Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\n\t\t\t\tconst me = this;\n\t\t\t\t// Attach an event listener to the save button\n\t\t\t\tsave_button.on('click', function () {\n\t\t\t\t\tlet amount = me[`${mode}_control`].get_value(); // Get amount value\n\n\t\t\t\t\tif (!amount) {\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('All fields are required.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", flt(amount));\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\tmessage: __('Payment details have been saved.'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\n\t\t\t\t});\n\n\n\t\t\t\tdiscard_button.on('click', function () {\n\t\t\t\t\tme[`${mode}_control`].set_value('');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\n\t\t\t\tconst controls = [\n\t\t\t\t\tme[`${mode}_control`],\n\t\t\t\t];\n\n\t\t\t\tcontrols.forEach(control => {\n\t\t\t\t\tcontrol.$input && control.$input.keypress(function (e) {\n\t\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\n\t\t\t}\n\n\t\t\tif (p.mode_of_payment === \"2307\") {\n\n\n\t\t\t\tlet check_form_2307 = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: `Expected 2307 Amount`,\n\t\t\t\t\t\tfieldtype: \"Currency\",\n\t\t\t\t\t\tplaceholder: 'Actual 2307',\n\t\t\t\t\t\tread_only: 1, // Set the field to read-only\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.actual-gov-two`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\t// Set the existing value and refresh the control\n\t\t\t\tlet latest_form_2307_value = doc.custom_2307;\n\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_form_2307\", latest_form_2307_value);\n\n\t\t\t\tcheck_form_2307.set_value(latest_form_2307_value || '');\n\t\t\t\tcheck_form_2307.refresh();\n\n\n\n\t\t\t\tlet save_button = $(`<button class=\"btn btn-primary\"style=\"text-align: right;\"\">Save</button>`);\n\t\t\t\tthis.$payment_modes.find(`.${mode}.save-button`).append(save_button);\n\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\" style=\"text-align: right; margin-left: 10px;\">Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\n\t\t\t\tconst me = this;\n\t\t\t\t// Attach an event listener to the save button\n\t\t\t\tsave_button.on('click', function () {\n\t\t\t\t\tlet amount = me[`${mode}_control`].get_value(); // Get amount value\n\n\t\t\t\t\tif (!amount) {\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('All fields are required.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", flt(amount));\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\tmessage: __('Payment details have been saved.'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\t\t\t\t});\n\n\n\t\t\t\tdiscard_button.on('click', function () {\n\t\t\t\t\tme[`${mode}_control`].set_value('');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\t\t\t\tconst controls = [\n\t\t\t\t\tme[`${mode}_control`],\n\t\t\t\t];\n\n\t\t\t\tcontrols.forEach(control => {\n\t\t\t\t\tcontrol.$input && control.$input.keypress(function (e) {\n\t\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\n\n\t\t\t}\n\n\t\t\tif (p.mode_of_payment === \"QR Payment\") {\n\n\t\t\t\tlet existing_custom_payment_type = frappe.model.get_value(p.doctype, p.name, \"custom_payment_type\");\n\t\t\t\tlet custom_payment_type = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Payment Type',\n\t\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{ label: 'Select Payment Type', value: '' },\n\t\t\t\t\t\t\t{ label: 'Standee', value: 'Standee' },\n\t\t\t\t\t\t\t{ label: 'Terminal', value: 'Terminal' },\n\t\t\t\t\t\t],\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t\t// onchange: function () {\n\t\t\t\t\t\t// \tconst value = this.value;\n\t\t\t\t\t\t// \tfrappe.model.set_value(p.doctype, p.name, \"custom_payment_type\", value);\n\t\t\t\t\t\t// },\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.payment-type`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\t// Set the existing value and refresh the control\n\t\t\t\tcustom_payment_type.set_value(existing_custom_payment_type || '');\n\t\t\t\tcustom_payment_type.refresh();\n\n\n\t\t\t\tlet existing_custom_bank_type = frappe.model.get_value(p.doctype, p.name, \"custom_bank_type\");\n\t\t\t\tlet custom_bank_type = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Bank',\n\t\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t{ label: 'Select Bank Type', value: '' },\n\t\t\t\t\t\t\t{ label: 'SBC', value: 'SBC' },\n\t\t\t\t\t\t\t{ label: 'MBTC', value: 'MBTC' },\n\t\t\t\t\t\t\t{ label: 'MAYA', value: 'MAYA' },\n\t\t\t\t\t\t\t{ label: 'GCASH', value: 'GCASH' },\n\t\t\t\t\t\t\t{ label: 'BDO', value: 'BDO' },\n\t\t\t\t\t\t],\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t\t// onchange: function () {\n\t\t\t\t\t\t// \tconst value = this.value;\n\t\t\t\t\t\t// \tfrappe.model.set_value(p.doctype, p.name, \"custom_bank_type\", value);\n\t\t\t\t\t\t// },\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.bank-type`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\t// Set the existing value and refresh the control\n\t\t\t\tcustom_bank_type.set_value(existing_custom_bank_type || '');\n\t\t\t\tcustom_bank_type.refresh();\n\n\n\n\t\t\t\tlet existing_custom_qr_reference_number = frappe.model.get_value(p.doctype, p.name, \"custom_qr_reference_number\");\n\t\t\t\tlet custom_qr_reference_number = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: `Confirmation Code`,\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Reference # or Confirmation Code',\n\t\t\t\t\t\n\n\t\t\t\t\t\t// onchange: function () {\n\t\t\t\t\t\t// \tfrappe.model.set_value(p.doctype, p.name, \"custom_qr_reference_number\", this.value);\n\t\t\t\t\t\t// },\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.qr-reference-number`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcustom_qr_reference_number.set_value(existing_custom_qr_reference_number || '');\n\t\t\t\tcustom_qr_reference_number.refresh();\n\n\n\t\t\t\tlet save_button = $(`<button class=\"btn btn-primary\"style=\"text-align: right;\"\">Save</button>`);\n\t\t\t\tthis.$payment_modes.find(`.${mode}.save-button`).append(save_button);\n\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\" style=\"text-align: right; margin-left: 10px;\">Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\n\t\t\t\tconst me = this;\n\t\t\t\t// Attach an event listener to the save button\n\t\t\t\tsave_button.on('click', function () {\n\t\t\t\t\tlet amount = me[`${mode}_control`].get_value(); // Get amount value\n\t\t\t\t\tlet payment_type = custom_payment_type.get_value();\n\t\t\t\t\tlet bank_type = custom_bank_type.get_value();\n\t\t\t\t\tlet qr_reference_number = custom_qr_reference_number.get_value();\n\n\t\t\t\t\t// let reference_no = reference_no_control.get_value();\n\n\t\t\t\t\tif (!amount || !payment_type || !bank_type) {\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('All fields are required.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\n\t\t\t\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t\t\t\t? doc.grand_total\n\t\t\t\t\t\t: doc.rounded_total;\n\t\t\t\t\tconst currency = doc.currency;\n\n\t\t\t\t\tif (amount > grand_total) {\n\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('Amount must not exceed the grand total.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t}\n\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", flt(amount));\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_payment_type\", payment_type);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_bank_type\", bank_type);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_qr_reference_number\", qr_reference_number);\n\t\t\t\t\t// frappe.model.set_value(p.doctype, p.name, \"reference_no\", reference_no);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\tmessage: __('Payment details have been saved.'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\t\t\t\t});\n\n\n\t\t\t\tdiscard_button.on('click', function () {\n\t\t\t\t\tme[`${mode}_control`].set_value(0);\n\t\t\t\t\tcustom_payment_type.set_value('');\n\t\t\t\t\tcustom_bank_type.set_value('');\n\t\t\t\t\tcustom_qr_reference_number.set_value('');\n\t\t\t\t\t// let reference_no = reference_no_control.get_value();\n\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_payment_type\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_bank_type\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_qr_reference_number\", '');\n\t\t\t\t\t// frappe.model.set_value(p.doctype, p.name, \"reference_no\", reference_no);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\t\t\t\tconst controls = [\n\t\t\t\t\tme[`${mode}_control`],\n\t\t\t\t\tcustom_payment_type,\n\t\t\t\t\tcustom_bank_type,\n\t\t\t\t\tcustom_qr_reference_number,\n\t\t\t\t];\n\n\t\t\t\tcontrols.forEach(control => {\n\t\t\t\t\tcontrol.$input && control.$input.keypress(function (e) {\n\t\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\n\n\n\t\t\t}\n\n\t\t\tif (p.mode_of_payment === \"Charge\") {\n\t\t\t\tconst selected_customer = cur_frm.doc.customer;\n\n\n\n\t\t\t\t\n\t\t\t\tlet existing_custom_customer = frappe.model.get_value(p.doctype, p.name, \"custom_customer\");\n\t\t\t\tlet custom_customer = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Customer',\n\t\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\t\tplaceholder: 'Customer Name',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.customer`), // Use [0] to select the DOM element\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\n\t\t\t\t\n\t\t\t\tfrappe.db.get_value('Customer', selected_customer, 'customer_name')\n\t\t\t\t\t.then(r => {\n\t\t\t\t\t\tconst result = r.message.customer_name; // Extract the customer_name from the result\n\t\t\t\t\t\tcustom_customer.set_value(existing_custom_customer || result || ''); \n\t\t\t\t\t})\n\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\tconsole.error('Error fetching customer name:', error);\n\t\t\t\t\t});\n\n\t\t\t\tcustom_customer.refresh();\n\n\n\t\t\t\tlet existing_charge_invoice_number = frappe.model.get_value(p.doctype, p.name, \"custom_charge_invoice_number\");\n\t\t\t\tlet charge_invoice_number = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Charge Invoice Number',\n\t\t\t\t\t\tfieldtype: \"Data\", // Corrected fieldtype\n\t\t\t\t\t\tplaceholder: 'Charge Invoice Number',\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.charge-invoice-number`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcharge_invoice_number.set_value(existing_charge_invoice_number || '');\n\t\t\t\tcharge_invoice_number.refresh();\n\n\n\t\t\t\tlet existing_custom_po_number = frappe.model.get_value(p.doctype, p.name, \"custom_po_number\");\n\t\t\t\tlet custom_po_number = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'PO Number',\n\t\t\t\t\t\tfieldtype: \"Data\", // Corrected fieldtype\n\t\t\t\t\t\tplaceholder: 'PO Number',\n\t\t\t\t\t\treqd: true\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.po-number`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcustom_po_number.set_value(existing_custom_po_number || '');\n\t\t\t\tcustom_po_number.refresh();\n\n\t\t\t\tlet existing_custom_representative = frappe.model.get_value(p.doctype, p.name, \"custom_representative\");\n\t\t\t\tlet custom_representative = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Representative',\n\t\t\t\t\t\tfieldtype: \"Data\", // Corrected fieldtype\n\t\t\t\t\t\tplaceholder: 'Representative',\n\t\t\t\t\t\treqd: true\n\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.representative`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcustom_representative.set_value(existing_custom_representative || '');\n\t\t\t\tcustom_representative.refresh();\n\n\t\t\t\tlet existing_custom_id_number = frappe.model.get_value(p.doctype, p.name, \"custom_id_number\");\n\t\t\t\tlet custom_id_number = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'ID Number',\n\t\t\t\t\t\tfieldtype: \"Data\", // Corrected fieldtype\n\t\t\t\t\t\tplaceholder: 'ID Number',\n\t\t\t\t\t\treqd: true\n\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.id-number`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcustom_id_number.set_value(existing_custom_id_number || '');\n\t\t\t\tcustom_id_number.refresh();\n\n\t\t\t\tlet existing_custom_approved_by = frappe.model.get_value(p.doctype, p.name, \"custom_approved_by\");\n\t\t\t\tlet custom_approved_by = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Approved By',\n\t\t\t\t\t\tfieldtype: \"Data\", // Corrected fieldtype\n\t\t\t\t\t\tplaceholder: 'Approver name',\n\n\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.approved-by`),\n\t\t\t\t\trender_input: true,\n\t\t\t\t});\n\t\t\t\tcustom_approved_by.set_value(existing_custom_approved_by || '');\n\t\t\t\tcustom_approved_by.refresh();\n\n\n\n\t\t\t\tlet save_button = $(`<button class=\"btn btn-primary\"style=\"text-align: right;\"\">Save</button>`);\n\t\t\t\tthis.$payment_modes.find(`.${mode}.save-button`).append(save_button);\n\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\" style=\"text-align: right; margin-left: 10px;\">Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\n\t\t\t\tconst me = this;\n\t\t\t\t// Attach an event listener to the save button\n\t\t\t\tsave_button.on('click', function () {\n\t\t\t\t\tlet amount = me[`${mode}_control`].get_value(); // Get amount value\n\t\t\t\t\tlet customer = custom_customer.get_value();\n\t\t\t\t\tlet charge_invoice_no = charge_invoice_number.get_value();\n\t\t\t\t\tlet po_number = custom_po_number.get_value();\n\t\t\t\t\tlet representative = custom_representative.get_value();\n\t\t\t\t\tlet id_number = custom_id_number.get_value();\n\t\t\t\t\tlet approved_by = custom_approved_by.get_value();\n\n\t\t\t\t\t// let reference_no = reference_no_control.get_value();\n\n\t\t\t\t\tif (!amount || !customer || !po_number || !representative || !id_number) {\n\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\ttitle: __('Validation Warning'),\n\t\t\t\t\t\t\tmessage: __('All fields are required.'),\n\t\t\t\t\t\t\tindicator: 'orange',\n\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", flt(amount));\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_customer\", customer);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_charge_invoice_number\", charge_invoice_no)\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_po_number\", po_number);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_representative\", representative);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_id_number\", id_number);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_approved_by\", approved_by);\n\t\t\t\t\t// frappe.model.set_value(p.doctype, p.name, \"reference_no\", reference_no);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\tmessage: __('Payment details have been saved.'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\n\t\t\t\tdiscard_button.on('click', function () {\n\t\t\t\t\tme[`${mode}_control`].set_value(0);\n\t\t\t\t\tcustom_customer.set_value('');\n\t\t\t\t\tcharge_invoice_number.set_value('');\n\t\t\t\t\tcustom_po_number.set_value('');\n\t\t\t\t\tcustom_representative.set_value('');\n\t\t\t\t\tcustom_id_number.set_value('');\n\t\t\t\t\tcustom_approved_by.set_value('');\n\t\t\t\t\t// let reference_no = reference_no_control.get_value();\n\n\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_customer\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_charge_invoice_number\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_po_number\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_representative\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_id_number\", '');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_approved_by\", '');\n\t\t\t\t\t// frappe.model.set_value(p.doctype, p.name, \"reference_no\", reference_no);\n\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\n\t\t\t\t});\n\n\t\t\t\tconst controls = [\n\t\t\t\t\tme[`${mode}_control`],\n\t\t\t\t\tcustom_customer,\n\t\t\t\t\tcustom_po_number,\n\t\t\t\t\tcharge_invoice_number,\n\t\t\t\t\tcustom_representative,\n\t\t\t\t\tcustom_id_number,\n\t\t\t\t\tcustom_approved_by,\n\t\t\t\t];\n\n\t\t\t\tcontrols.forEach(control => {\n\t\t\t\t\tcontrol.$input && control.$input.keypress(function (e) {\n\t\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\n\t\t\tif (p.mode_of_payment === \"Gift Certificate\") {\n\n\t\t\t\t// Create input field\n\t\t\t\tlet code_input = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\tlabel: 'Gift Code',\n\t\t\t\t\t\tplaceholder: 'Enter Gift Code'\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.gift-code`)[0],\n\t\t\t\t\trender_input: true\n\t\t\t\t});\n\t\t\t\n\t\t\t\tcode_input.refresh();\n\t\t\t\n\t\t\t\t// Create button\n\t\t\t\tlet button = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Add Gift Code',\n\t\t\t\t\t\tfieldtype: 'Button',\n\t\t\t\t\t\tbtn_size: 'sm', // xs, sm, lg\n\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\tlet code_value = code_input.get_value();\n\t\t\t\t\t\t\tif (code_value) {\n\t\t\t\t\t\t\t\tfrappe.db.get_doc(\"Amesco Gift Certificate\", code_value)\n\t\t\t\t\t\t\t\t\t.then(gift_cert => {\n\t\t\t\t\t\t\t\t\t\t// Add the gift amount to the existing payment amount\n\t\t\t\t\t\t\t\t\t\tif (gift_cert.is_used !== 1) {\n\t\t\t\t\t\t\t\t\t\t\tlet current_amount = flt(frappe.model.get_value(p.doctype, p.name, \"amount\"));\n\t\t\t\t\t\t\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", current_amount + flt(gift_cert.amount));\n\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t// Push the gift code and its amount to the codes array\n\t\t\t\t\t\t\t\t\t\t\tfrm.add_child(\"custom_gift_cert_used\", {\n\t\t\t\t\t\t\t\t\t\t\t\tcode: code_value,\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t\t\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: __('Success'),\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: __('Gift Certificate code added successfully.'),\n\t\t\t\t\t\t\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\t\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\t\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\t\t\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t// Clear input field for the next gift code\n\t\t\t\t\t\t\t\t\t\t\tcode_input.set_value('');\n\t\t\t\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: __('Error'),\n\t\t\t\t\t\t\t\t\t\t\t\tindicator: 'red',\n\t\t\t\t\t\t\t\t\t\t\t\tmessage: __('Gift Code Already Used. Please check the code and try again.')\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch(error => {\n\t\t\t\t\t\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\t\t\t\t\t\ttitle: __('Error'),\n\t\t\t\t\t\t\t\t\t\t\tindicator: 'red',\n\t\t\t\t\t\t\t\t\t\t\tmessage: __('Invalid Gift Code. Please check the code and try again.')\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\t\t\t\ttitle: __('Error'),\n\t\t\t\t\t\t\t\t\tindicator: 'red',\n\t\t\t\t\t\t\t\t\tmessage: __('Please enter a gift code before clicking Add Gift Code.')\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.button-code`)[0], // Ensure correct parent DOM element\n\t\t\t\t\trender_input: true\n\t\t\t\t});\n\t\t\t\n\t\t\t\tbutton.refresh();\n\t\t\t\n\t\t\t\t// Create discard button\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\">Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\t\t\t\n\t\t\t\tconst me = this;\n\t\t\t\n\t\t\t\t// Attach an event listener to the discard button\n\t\t\t\tdiscard_button.on('click', function () {\n\t\t\t\t\tme[`${mode}_control`].set_value('');\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\t\t\t\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function () {\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t$(document).on('keydown', function (e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\n\t\t\t\t// Attach keypress event to the code input field\n\t\t\t\tcode_input.$input && code_input.$input.keypress(function (e) {\n\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\tbutton.$input.trigger('click'); // Trigger the button click\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif (p.mode_of_payment === \"Amesco Plus\") {\n\t\t\t\tlet button = frappe.ui.form.make_control({\n\t\t\t\t\tdf: {\n\t\t\t\t\t\tlabel: 'Scan',\n\t\t\t\t\t\tfieldtype: 'Button',\n\t\t\t\t\t\tbtn_size: 'sm', // xs, sm, lg\n\t\t\t\t\t\tclick: function () {\n\t\t\t\t\t\t\t// console.log('Click');\n\t\t\t\t\t\t\tnew frappe.ui.Scanner({\n\t\t\t\t\t\t\t\tdialog: true, // open camera scanner in a dialog\n\t\t\t\t\t\t\t\tmultiple: false, // stop after scanning one value\n\t\t\t\t\t\t\t\ton_scan(data) {\n\t\t\t\t\t\t\t\t\t// Assuming the scanned data is comma-separated\n\t\t\t\t\t\t\t\t\tlet scannedData = data.decodedText.split(',');\n\t\t\t\t\t\t\t\t\tconsole.log(\"scannedData\", scannedData);\n\t\t\t\t\t\t\t\t\t// Extracting fields from the scanned data\n\t\t\t\t\t\t\t\t\tlet voucher_code = scannedData[0]; //'AVQR8105441319'\n\t\t\t\t\t\t\t\t\tlet user_id = scannedData[1];\n\t\t\t\t\t\t\t\t\t// let date = scannedData[3];\n\t\t\t\t\t\t\t\t\tlet email = scannedData[4];\n\t\t\t\t\t\t\t\t\tlet amesco_points = scannedData[2];\n\n\t\t\t\t\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\t\t\t\t\tmethod: \"custom_app.customapp.doctype.used_ameco_plus_code.used_ameco_plus_code.check_used_amesco_plus_code\",\n\t\t\t\t\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t\t\t\t\tcode: voucher_code\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tcallback: function(response) {\n\t\t\t\t\t\t\t\t\t\t\tif (response.message) {\n\t\t\t\t\t\t\t\t\t\t\t\tfrappe.msgprint(__('Amesco Plus voucher is already used.'));\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tlet details_dialog = new frappe.ui.Dialog({\n\t\t\t\t\t\t\t\t\t\t\t\ttitle: __('Scanned Amesco Plus User'),\n\t\t\t\t\t\t\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: 'Voucher Code',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfieldname: 'voucher_code',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tread_only: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefault: voucher_code\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: 'User ID',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfieldname: 'user_id',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tread_only: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefault: user_id\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: 'Email',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfieldname: 'email',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tread_only: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefault: email\n\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel: 'Redeem Points',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfieldname: 'points',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tread_only: 1,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefault: amesco_points\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t\t\t\tprimary_action_label: __('Ok'),\n\t\t\t\t\t\t\t\t\t\t\t\tprimary_action: function () {\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_am_voucher_code\", voucher_code);\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_am_plus_user_id\", user_id);\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"custom_am_plus_user_email\", email);\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", flt(amesco_points));\n\t\t\t\t\t\t\t\t\t\t\t\t\tfrm.add_child(\"custom_ameco_plus_code_used\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcode: voucher_code,\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t\t\tdetails_dialog.hide();\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\tdetails_dialog.show();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\n\t\t\t\t\t},\n\t\t\t\t\tparent: this.$payment_modes.find(`.${mode}.button-amesco-plus`)[0],\n\t\t\t\t\trender_input: true\n\t\t\t\t});\n\t\t\t\tbutton.refresh();\n\n\t\t\t\tlet discard_button = $('<button class=\"btn btn-secondary\" >Discard</button>');\n\t\t\t\tthis.$payment_modes.find(`.${mode}.discard-button`).append(discard_button);\n\t\t\t\tconst me = this;\n\t\t\t\t// Attach an event listener to the save button\n\n\t\t\t\tdiscard_button.on('click', function() {\n\t\t\t\t\tme[`${mode}_control`].set_value('');\n\t\t\t\t\t// let reference_no = reference_no_control.get_value()\n\t\t\t\t\tfrappe.model.set_value(p.doctype, p.name, \"amount\", 0);\n\t\t\t\t\t// frappe.model.set_value(p.doctype, p.name, \"reference_no\", reference_no);\n\t\t\t\n\t\t\t\t\tconst dialog = frappe.msgprint({\n\t\t\t\t\t\tmessage: __('Payment details have been discarded.'),\n\t\t\t\t\t\tindicator: 'blue',\n\t\t\t\t\t\tprimary_action: {\n\t\t\t\t\t\t\tlabel: __('OK'),\n\t\t\t\t\t\t\taction: function() {\n\t\t\t\t\t\t\t\t// Close the dialog\n\t\t\t\t\t\t\t\tfrappe.msg_dialog.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t\t$(document).on('keydown', function(e) {\n\t\t\t\t\t\tif (e.which === 13 && dialog.$wrapper.is(':visible')) { // 13 is the Enter key code\n\t\t\t\t\t\t\tdialog.get_primary_btn().trigger('click');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\n\t\t\t\t\t// Remove event listener when dialog is closed\n\t\t\t\t\tdialog.$wrapper.on('hidden.bs.modal', function () {\n\t\t\t\t\t\t$(document).off('keydown');\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tconst controls = [\n\t\t\t\t\tme[`${mode}_control`],\n\t\t\t\t];\n\t\t\t\tcontrols.forEach(control => {\n\t\t\t\t\tcontrol.$input && control.$input.keypress(function (e) {\n\t\t\t\t\t\tif (e.which === 13) { // Enter key pressed\n\t\t\t\t\t\t\tsave_button.click();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\n\n\t\t\t}\n\t\t\t// this[`${mode}_control`].toggle_label(true);\n\t\t\tthis[`${mode}_control`].set_value(p.amount);\n\t\t});\n\t\tthis.render_loyalty_points_payment_mode();\n\t\tthis.attach_cash_shortcuts(doc);\n\t}\n\n\n\n\tfocus_on_default_mop() {\n\t\tconst doc = this.events.get_frm().doc;\n\t\tconst payments = doc.payments;\n\t\tpayments.forEach((p) => {\n\t\t\tconst mode = p.mode_of_payment.replace(/ +/g, \"_\").toLowerCase();\n\t\t\tif (p.default) {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.$payment_modes.find(`.${mode}.mode-of-payment-control`).parent().click();\n\t\t\t\t}, 500);\n\t\t\t}\n\t\t});\n\t}\n\n\tattach_cash_shortcuts(doc) {\n\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t? doc.grand_total\n\t\t\t: doc.rounded_total;\n\t\tconst currency = doc.currency;\n\n\t\tconst shortcuts = this.get_cash_shortcuts(flt(grand_total));\n\n\t\tthis.$payment_modes.find(\".cash-shortcuts\").remove();\n\t\tlet shortcuts_html = shortcuts\n\t\t\t.map((s) => {\n\t\t\t\treturn `<div class=\"shortcut\" data-value=\"${s}\">${format_currency(s, currency, 0)}</div>`;\n\t\t\t})\n\t\t\t.join(\"\");\n\n\t\tthis.$payment_modes\n\t\t\t.find('[data-payment-type=\"Cash\"]')\n\t\t\t.find(\".mode-of-payment-control\")\n\t\t\t.after(`<div class=\"cash-shortcuts\">${shortcuts_html}</div>`);\n\t}\n\n\tget_cash_shortcuts(grand_total) {\n\t\tlet steps = [1, 5, 10];\n\t\tconst digits = String(Math.round(grand_total)).length;\n\n\t\tsteps = steps.map((x) => x * 10 ** (digits - 2));\n\n\t\tconst get_nearest = (amount, x) => {\n\t\t\tlet nearest_x = Math.ceil(amount / x) * x;\n\t\t\treturn nearest_x === amount ? nearest_x + x : nearest_x;\n\t\t};\n\n\t\tlet shortcuts = steps.reduce((finalArr, x) => {\n\t\t\tlet nearest_x = get_nearest(grand_total, x);\n\t\t\tnearest_x = finalArr.indexOf(nearest_x) != -1 ? nearest_x + x : nearest_x;\n\t\t\treturn [...finalArr, nearest_x];\n\t\t}, []);\n\n\t\t// Add 500 and 1000 if grand total is above 100\n\t\tif (grand_total > 100) {\n\t\t\tif (!shortcuts.includes(500)) {\n\t\t\t\tshortcuts.push(500);\n\t\t\t}\n\t\t\tif (!shortcuts.includes(1000)) {\n\t\t\t\tshortcuts.push(1000);\n\t\t\t}\n\t\t}\n\n\t\t// Sort shortcuts in ascending order\n\t\tshortcuts.sort((a, b) => a - b);\n\n\t\treturn shortcuts;\n\t}\n\n\n\trender_loyalty_points_payment_mode() {\n\t\tconst me = this;\n\t\tconst doc = this.events.get_frm().doc;\n\t\tconst { loyalty_program, loyalty_points, conversion_factor } = this.events.get_customer_details();\n\n\t\tthis.$payment_modes.find(`.mode-of-payment[data-mode=\"loyalty-amount\"]`).parent().remove();\n\n\t\tif (!loyalty_program) return;\n\n\t\tlet description, read_only, max_redeemable_amount;\n\t\tif (!loyalty_points) {\n\t\t\tdescription = __(\"You don't have enough points to redeem.\");\n\t\t\tread_only = true;\n\t\t} else {\n\t\t\tmax_redeemable_amount = flt(\n\t\t\t\tflt(loyalty_points) * flt(conversion_factor),\n\t\t\t\tprecision(\"loyalty_amount\", doc)\n\t\t\t);\n\t\t\tdescription = __(\"You can redeem upto {0}.\", [format_currency(max_redeemable_amount)]);\n\t\t\tread_only = false;\n\t\t}\n\n\t\tconst margin = this.$payment_modes.children().length % 2 === 0 ? \"pr-2\" : \"pl-2\";\n\t\tconst amount = doc.loyalty_amount > 0 ? format_currency(doc.loyalty_amount, doc.currency) : \"\";\n\t\tthis.$payment_modes.append(\n\t\t\t`<div class=\"payment-mode-wrapper\">\n\t\t\t\t<div class=\"mode-of-payment loyalty-card\" data-mode=\"loyalty-amount\" data-payment-type=\"loyalty-amount\">\n\t\t\t\t\tRedeem Loyalty Points\n\t\t\t\t\t<div class=\"loyalty-amount-amount pay-amount\">${amount}</div>\n\t\t\t\t\t<div class=\"loyalty-amount-name\">${loyalty_program}</div>\n\t\t\t\t\t<div class=\"loyalty-amount mode-of-payment-control\"></div>\n\t\t\t\t</div>\n\t\t\t</div>`\n\t\t);\n\n\t\tthis[\"loyalty-amount_control\"] = frappe.ui.form.make_control({\n\t\t\tdf: {\n\t\t\t\tlabel: __(\"Redeem Loyalty Points\"),\n\t\t\t\tfieldtype: \"Currency\",\n\t\t\t\tplaceholder: __(\"Enter amount to be redeemed.\"),\n\t\t\t\toptions: \"company:currency\",\n\t\t\t\tread_only,\n\t\t\t\tonchange: async function () {\n\t\t\t\t\tif (!loyalty_points) return;\n\n\t\t\t\t\tif (this.value > max_redeemable_amount) {\n\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\tmessage: __(\"You cannot redeem more than {0}.\", [\n\t\t\t\t\t\t\t\tformat_currency(max_redeemable_amount),\n\t\t\t\t\t\t\t]),\n\t\t\t\t\t\t\tindicator: \"red\",\n\t\t\t\t\t\t});\n\t\t\t\t\t\tfrappe.utils.play_sound(\"submit\");\n\t\t\t\t\t\tme[\"loyalty-amount_control\"].set_value(0);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconst redeem_loyalty_points = this.value > 0 ? 1 : 0;\n\t\t\t\t\tawait frappe.model.set_value(\n\t\t\t\t\t\tdoc.doctype,\n\t\t\t\t\t\tdoc.name,\n\t\t\t\t\t\t\"redeem_loyalty_points\",\n\t\t\t\t\t\tredeem_loyalty_points\n\t\t\t\t\t);\n\t\t\t\t\tfrappe.model.set_value(\n\t\t\t\t\t\tdoc.doctype,\n\t\t\t\t\t\tdoc.name,\n\t\t\t\t\t\t\"loyalty_points\",\n\t\t\t\t\t\tparseInt(this.value / conversion_factor)\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tdescription,\n\t\t\t},\n\t\t\tparent: this.$payment_modes.find(`.loyalty-amount.mode-of-payment-control`),\n\t\t\trender_input: true,\n\t\t});\n\t\tthis[\"loyalty-amount_control\"].toggle_label(false);\n\n\t\t// this.render_add_payment_method_dom();\n\t}\n\n\trender_add_payment_method_dom() {\n\t\tconst docstatus = this.events.get_frm().doc.docstatus;\n\t\tif (docstatus === 0)\n\t\t\tthis.$payment_modes.append(\n\t\t\t\t`<div class=\"w-full pr-2\">\n\t\t\t\t\t<div class=\"add-mode-of-payment w-half text-grey mb-4 no-select pointer\">+ Add Payment Method</div>\n\t\t\t\t</div>`\n\t\t\t);\n\t}\n\n\tupdate_totals_section(doc) {\n\t\tif (!doc) doc = this.events.get_frm().doc;\n\t\tconst paid_amount = doc.paid_amount;\n\t\tconst grand_total = cint(frappe.sys_defaults.disable_rounded_total)\n\t\t\t? doc.grand_total\n\t\t\t: doc.rounded_total;\n\t\tconst remaining = grand_total - doc.paid_amount;\n\t\tconst change = doc.change_amount || remaining <= 0 ? -1 * remaining : undefined;\n\t\tconst currency = doc.currency;\n\t\tconst label = change ? __(\"Change\") : __(\"To Be Paid\");\n\n\t\tthis.$totals.html(\n\t\t\t`<div class=\"col\">\n\t\t\t\t<div class=\"total-label\">${__(\"Grand Total\")}</div>\n\t\t\t\t<div class=\"value\">${format_currency(grand_total, currency)}</div>\n\t\t\t</div>\n\t\t\t<div class=\"seperator-y\"></div>\n\t\t\t<div class=\"col\">\n\t\t\t\t<div class=\"total-label\">${__(\"Paid Amount\")}</div>\n\t\t\t\t<div class=\"value\">${format_currency(paid_amount, currency)}</div>\n\t\t\t</div>\n\t\t\t<div class=\"seperator-y\"></div>\n\t\t\t<div class=\"col\">\n\t\t\t\t<div class=\"total-label\">${label}</div>\n\t\t\t\t<div class=\"value\">${format_currency(change || remaining, currency)}</div>\n\t\t\t</div>`\n\t\t);\n\n\n\t}\n\n\ttoggle_component(show) {\n\t\tshow ? this.$component.css(\"display\", \"flex\") : this.$component.css(\"display\", \"none\");\n\t}\n};", "custom_app.PointOfSale.PastOrderList = class {\n\tconstructor({ wrapper, events }) {\n\t\tthis.wrapper = wrapper;\n\t\tthis.events = events;\n\t\tthis.invoice_count = 0\n\t\tthis.init_component();\n\t}\n\n\tinit_component() {\n\t\tthis.prepare_dom();\n\t\tthis.make_filter_section();\n\t\tthis.bind_events();\n\t}\n\n\tprepare_dom() {\n\t\tthis.wrapper.append(\n\t\t\t`<section class=\"past-order-list\">\n\t\t\t\t<div class=\"filter-section\">\n\t\t\t\t\t<div class=\"label\">${__(\"Pending Orders\")} <span class=\"invoice-count ml-3 badge rounded-pill bg-danger text-white\"></span> </div>\n\t\t\t\t\t<div class=\"search-field\"></div>\n\t\t\t\t\t<div class=\"status-field\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invoices-container\"></div>\n\t\t\t</section>`\n\t\t);\n\n\t\tthis.$component = this.wrapper.find(\".past-order-list\");\n\t\tthis.$invoices_container = this.$component.find(\".invoices-container\");\n\t\tthis.$invoice_count = this.$component.find(\".invoice-count\");\n\t}\n\tbind_events() {\n\t\tconst me = this;\n\t\n\t\t// Initialize filter section once\n\t\tthis.make_filter_section();\n\t\n\t\t// Automatically focus on the search field when the section is rendered\n\t\tsetTimeout(() => {\n\t\t\tthis.search_field.set_focus();\n\t\t}, 300);\n\t\n\t\tthis.search_field.$input.on(\"input\", (e) => {\n\t\t\tclearTimeout(this.last_search);\n\t\t\tthis.last_search = setTimeout(() => {\n\t\t\t\tconst search_term = e.target.value;\n\t\t\t\tthis.refresh_list(search_term, this.status_field.get_value());\n\t\t\t}, 300);\n\t\t});\n\t\n\t\tthis.$invoices_container.on(\"click\", \".invoice-wrapper\", function () {\n\t\t\tconst invoice_name = unescape($(this).attr(\"data-invoice-name\"));\n\t\t\tme.events.open_invoice_data(invoice_name);\n\t\t});\n\t\n\t\tthis.$invoices_container.off('keydown', '.invoice-wrapper').on('keydown', '.invoice-wrapper', function(event) {\n\t\t\tconst $items = me.$invoices_container.find('.invoice-wrapper');\n\t\t\tconst currentIndex = $items.index($(this));\n\t\t\tlet nextIndex = currentIndex;\n\t\n\t\t\tswitch (event.which) {\n\t\t\t\tcase 13: // Enter key\n\t\t\t\t\t$(this).click(); // Trigger click event immediately on Enter key press\n\t\t\t\t\tbreak;\n\t\t\t\tcase 38: // Up arrow key\n\t\t\t\t\tnextIndex = currentIndex > 0 ? currentIndex - 1 : $items.length - 1;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 40: // Down arrow key\n\t\t\t\t\tnextIndex = currentIndex < $items.length - 1 ? currentIndex + 1 : 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\treturn; // Exit if other keys are pressed\n\t\t\t}\n\t\n\t\t\t$items.eq(nextIndex).focus(); // Move focus to the next item\n\t\t});\n\t\n\t\t// Add Ctrl+I shortcut to focus on the search field\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: 'ctrl+i',\n\t\t\taction: () => {\n\t\t\t\tconst $items = me.$invoices_container.find('.invoice-wrapper');\n\t\t\t\tif ($items.length) {\n\t\t\t\t\t$items.first().focus(); // Focus on the first cart item\n\t\t\t\t}\n\t\t\t},\n\t\t\tcondition: () => me.$invoices_container.is(':visible'),\n\t\t\tdescription: __('Activate Cart Item Focus'),\n\t\t\tignore_inputs: true,\n\t\t\tpage: cur_page.page.page // Replace with your actual page context\n\t\t});\n\t}\n\t\n\n\tmake_filter_section() {\n\t\tconst me = this;\n\t\tif (!this.search_field) {\n\t\t\tthis.search_field = frappe.ui.form.make_control({\n\t\t\t\tdf: {\n\t\t\t\t\tlabel: __(\"Search\"),\n\t\t\t\t\tfieldtype: \"Data\",\n\t\t\t\t\tplaceholder: __(\"Search by invoice id or customer name\"),\n\t\t\t\t},\n\t\t\t\tparent: this.$component.find(\".search-field\"),\n\t\t\t\trender_input: true,\n\t\t\t});\n\t\t\tthis.search_field.toggle_label(true);\n\t\t\t\n\t\t}\n\t\n\t\tif (!this.status_field) {\n\t\t\tthis.status_field = frappe.ui.form.make_control({\n\t\t\t\tdf: {\n\t\t\t\t\tlabel: __(\"Invoice Status\"),\n\t\t\t\t\tfieldtype: \"Select\",\n\t\t\t\t\toptions: `Draft`,\n\t\t\t\t\tplaceholder: __(\"Filter by invoice status\"),\n\t\t\t\t\tonchange: function () {\n\t\t\t\t\t\tif (me.$component.is(\":visible\")) me.refresh_list();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tparent: this.$component.find(\".status-field\"),\n\t\t\t\trender_input: true,\n\t\t\t});\n\t\t\tthis.status_field.toggle_label(false);\n\t\t\tthis.status_field.set_value(\"Draft\"); // set default draft\n\t\t}\n\n\t\t\n\t}\n\n\n\t\n\trefresh_list() {\n\t\tfrappe.dom.freeze();\n\t\tthis.events.reset_summary();\n\t\tconst search_term = this.search_field.get_value();\n\t\tconst status = this.status_field.get_value();\n\t\t// added pos profile variable for filter\n\t\tconst pos_profile = this.events.pos_profile();\n\n\t\t// const current_user = frappe.session.user;\n\n\t\tthis.$invoices_container.html(\"\");\n\n\t\treturn frappe.call({\n\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.get_past_order_list\",\n\t\t\tfreeze: true,\n\t\t\targs: { search_term, status, pos_profile}, // added pos_profile for filtering\n\t\t\tcallback: (response) => {\n\t\t\t\t// console.log(response.message);\n\t\t\t\tfrappe.dom.unfreeze();\n\t\t\t\tresponse.message.forEach((invoice) => {\t\t\t\t\t\n\t\t\t\t\tconst invoice_html = this.get_invoice_html(invoice);\n\t\t\t\t\tthis.$invoices_container.append(invoice_html);\n\t\t\t\t});\n\n\t\t\t\tthis.$invoice_count.text(response.message.length);\n\t\t\t},\n\t\t});\n\t}\n\t\n\tget_invoice_html(invoice) {\n\t\tconst posting_datetime = moment(invoice.posting_date + \" \" + invoice.posting_time).format(\n\t\t\t\"Do MMMM, h:mma\"\n\t\t);\n\t\treturn `<div class=\"invoice-wrapper\" tabindex=\"0\" data-invoice-name=\"${escape(invoice.name)}\">\n\t\t\t\t<div class=\"invoice-name-date\">\n\t\t\t\t\t<div class=\"invoice-name\">${invoice.name}</div>\n\t\t\t\t\t<div class=\"invoice-date\">\n\t\t\t\t\t\t<svg class=\"mr-2\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" stroke=\"currentColor\" stroke-width=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n\t\t\t\t\t\t\t<path d=\"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\"/><circle cx=\"12\" cy=\"7\" r=\"4\"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t${frappe.ellipsis(invoice.customer_name, 20)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invoice-total-status\">\n\t\t\t\t\t<div class=\"invoice-total\">${format_currency(invoice.grand_total, invoice.currency) || 0}</div>\n\t\t\t\t\t<div class=\"invoice-date\">${posting_datetime}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"seperator\"></div>`\n\t}\n\n\n\t// Function to render the invoice items\n\t\n\n\ttoggle_component(show) {\n\t\tshow\n\t\t\t? this.$component.css(\"display\", \"flex\") && this.refresh_list()\n\t\t\t: this.$component.css(\"display\", \"none\");\n\t}\n};\n", "import jsbarcode from 'jsbarcode';\n\n\ncustom_app.PointOfSale.PastOrderSummary = class {\n\tconstructor({ wrapper, events }) {\n\t\tthis.wrapper = wrapper;\n\t\tthis.events = events;\n\n\t\tthis.init_component();\n\t}\n\n\tinit_component() {\n\t\tthis.prepare_dom();\n\t\tthis.init_email_print_dialog();\n\t\tthis.bind_events();\n\t\tthis.attach_shortcuts();\n\t}\n\n\tprepare_dom() {\n\t\tthis.wrapper.append(\n\t\t\t`\n\t\t\t<section class=\"past-order-summary\">\n\t\t\t\t<div class=\"no-summary-placeholder\">\n\t\t\t\t\t${__(\"Select an invoice to load summary data\")}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invoice-summary-wrapper\" style=\"width:50rem !important;\">\n\t\t\t\t\t<div class=\"abs-container\">\n\t\t\t\t\t\t<div class=\"upper-section\"></div>\n\t\t\t\t\t\t<div class=\"label\">${__(\"Items\")}</div>\n\t\t\t\t\t\t<div class=\"items-container summary-container\"></div>\n\t\t\t\t\t\t<div class=\"label\">${__(\"Totals\")}</div>\n\t\t\t\t\t\t<div class=\"totals-container summary-container\"></div>\n\t\t\t\t\t\t<div class=\"label\">${__(\"Payments\")}</div>\n\t\t\t\t\t\t<div class=\"payments-container summary-container\"></div>\n\t\t\t\t\t\t<div class=\"change-container summary-container\"></div>\n\t\t\t\t\t\t<div class=\"summary-btns\"></div>\n\t\t\t\t\t\t<svg id=\"barcode\" class=\"mt-3 mx-auto\" style=\"max-width: 100%;\" jsbarcode-format=\"code128\"></svg>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</section>`\n\t\t);\n\n\t\tthis.$component = this.wrapper.find(\".past-order-summary\");\n\t\tthis.$summary_wrapper = this.$component.find(\".invoice-summary-wrapper\");\n\t\tthis.$summary_container = this.$component.find(\".abs-container\");\n\t\tthis.$upper_section = this.$summary_container.find(\".upper-section\");\n\t\tthis.$items_container = this.$summary_container.find(\".items-container\");\n\t\tthis.$totals_container = this.$summary_container.find(\".totals-container\");\n\t\tthis.$payment_container = this.$summary_container.find(\".payments-container\");\n\t\tthis.$change_container = this.$summary_container.find(\".change-container\");// added change container\n\t\tthis.$summary_btns = this.$summary_container.find(\".summary-btns\");\n\t}\n\n\tinit_email_print_dialog() {\n\t\tconst email_dialog = new frappe.ui.Dialog({\n\t\t\ttitle: \"Email Receipt\",\n\t\t\tfields: [\n\t\t\t\t{ fieldname: \"email_id\", fieldtype: \"Data\", options: \"Email\", label: \"Email ID\", reqd: 1 },\n\t\t\t\t{ fieldname: \"content\", fieldtype: \"Small Text\", label: \"Message (if any)\" },\n\t\t\t],\n\t\t\tprimary_action: () => {\n\t\t\t\tthis.send_email();\n\t\t\t},\n\t\t\tprimary_action_label: __(\"Send\"),\n\t\t});\n\t\tthis.email_dialog = email_dialog;\n\n\t\tconst print_dialog = new frappe.ui.Dialog({\n\t\t\ttitle: \"Print Receipt\",\n\t\t\tfields: [{ fieldname: \"print\", fieldtype: \"Data\", label: \"Print Preview\" }],\n\t\t\tprimary_action: () => {\n\t\t\t\tthis.print_receipt();\n\t\t\t},\n\t\t\tprimary_action_label: __(\"Print\"),\n\t\t});\n\t\tthis.print_dialog = print_dialog;\n\t}\n\n\tget_upper_section_html(doc) {\n\t\tconst { status } = doc;\n\t\tlet indicator_color = \"\";\n\t\t // Determine the 'Sold by' value based on the status\n\t\tconst sold_by = status === \"Draft\" ? doc.custom_pa_name : doc.custom_cashier_name;\n\n\t\t[\"Paid\", \"Consolidated\"].includes(status) && (indicator_color = \"green\");\n\t\tstatus === \"Draft\" && (indicator_color = \"red\");\n\t\tstatus === \"Return\" && (indicator_color = \"grey\");\n\n\t\treturn `<div class=\"left-section\">\n\t\t\t\t\t<div class=\"customer-name\">${doc.customer_name}</div>\n\t\t\t\t\t<div class=\"customer-email\">${this.customer_email}</div>\n\t\t\t\t\t<div class=\"cashier\"> Take by:  ${__(sold_by)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"right-section\">\n\t\t\t\t\t<div class=\"paid-amount\">${format_currency(doc.grand_total, doc.currency)}</div>\n\t\t\t\t\t<div class=\"invoice-name\">${doc.name}</div>\n\t\t\t\t\t<span class=\"indicator-pill whitespace-nowrap ${indicator_color}\"><span>${doc.status}</span></span>\n\t\t\t\t</div>`;\n\t}\n\n\tget_item_html(doc, item_data) {\n\t\treturn `<div class=\"item-row-wrapper\">\n\t\t\t\t\t<div class=\"item-name\">${item_data.item_name}</div>\n\t\t\t\t\t<div class=\"item-qty\"></div>\n\t\t\t\t\t<div class=\"item-rate-disc\">${get_rate_discount_html()}</div>\n\t\t\t\t</div>`;\n\t\n\t\tfunction get_rate_discount_html() {\n\t\t\tlet rate_html = '';\n\t\t\tlet amount_html = `<span class=\"item-amount\" style=\"padding-left:1rem;\">${format_currency(item_data.amount, doc.currency)}</span>`;\n\t\t\tlet qty_html = `<span class=\"qty\" style=\"padding-left:1rem;\">${item_data.qty || 0} ${item_data.uom}</span>`;\n\t\n\t\t\tif (item_data.rate && item_data.price_list_rate && item_data.rate !== item_data.price_list_rate) {\n\t\t\t\trate_html = `<span class=\"item-disc\">(${item_data.discount_percentage}% off)</span>\n\t\t\t\t\t\t\t <div class=\"item-rate\">${format_currency(item_data.rate, doc.currency)}</div>`;\n\t\t\t} else {\n\t\t\t\trate_html = `<div class=\"item-rate\">${format_currency(\n\t\t\t\t\titem_data.price_list_rate || item_data.rate,\n\t\t\t\t\tdoc.currency\n\t\t\t\t)}  </div>`;\n\t\t\t}\n\t\n\t\t\treturn `${rate_html} ${qty_html} ${amount_html}`;\n\t\t}\n\t}\n\t\n\t\n\t\n\n\tget_discount_html(doc) {\n\t\tif (doc.discount_amount) {\n\t\t\treturn `<div class=\"summary-row-wrapper\">\n\t\t\t\t\t\t<div>Discount (${doc.additional_discount_percentage} %)</div>\n\t\t\t\t\t\t<div>${format_currency(doc.discount_amount, doc.currency)}</div>\n\t\t\t\t\t</div>`;\n\t\t} else {\n\t\t\treturn ``;\n\t\t}\n\t}\n\n\tget_vatable_sales_html(doc) {\n\t\treturn `<div class=\"summary-row-wrapper\">\n\t\t\t\t\t<div>${__(\"VATable Sales\")}</div>\n\t\t\t\t\t<div>${format_currency(doc.custom_vatable_sales, doc.currency)}</div>\n\t\t\t\t</div>`;\n\t}\n\n\tget_vatable_exempt_html(doc) {\n\t\treturn `<div class=\"summary-row-wrapper\">\n\t\t\t\t\t<div>${__(\"VAT-Exempt Sales\")}</div>\n\t\t\t\t\t<div>${format_currency(doc.custom_vat_exempt_sales, doc.currency)}</div>\n\t\t\t\t</div>`;\n\t}\n\n\tget_zero_rated_html(doc) {\n\t\treturn `<div class=\"summary-row-wrapper\">\n\t\t\t\t\t<div>${__(\"Zero-Rated\")}</div>\n\t\t\t\t\t<div>${format_currency(doc.custom_zero_rated_sales, doc.currency)}</div>\n\t\t\t\t</div>`;\n\t}\n\n\tget_vat_amount_html(doc) {\n\t\treturn `<div class=\"summary-row-wrapper\">\n\t\t\t\t\t<div>${__(\"VAT 12%\")}</div>\n\t\t\t\t\t<div>${format_currency(doc.custom_vat_amount, doc.currency)}</div>\n\t\t\t\t</div>`;\n\t}\n\n\n\tget_net_total_html(doc) {\n\t\treturn `<div class=\"summary-row-wrapper\">\n\t\t\t\t\t<div>${__(\"Net Total\")}</div>\n\t\t\t\t\t<div>${format_currency(doc.net_total, doc.currency)}</div>\n\t\t\t\t</div>`;\n\t}\n\n\n\tget_taxes_html(doc) {\n\t\tif (!doc.taxes.length) return \"\";\n\n\t\tlet taxes_html = doc.taxes\n\t\t\t.map((t) => {\n\t\t\t\t// if tax rate is 0, don't print it.\n\t\t\t\tconst description = /[0-9]+/.test(t.description)\n\t\t\t\t\t? t.description\n\t\t\t\t\t: t.rate != 0\n\t\t\t\t\t\t? `${t.description} @ ${t.rate}%`\n\t\t\t\t\t\t: t.description;\n\t\t\t\treturn `\n\t\t\t\t<div class=\"tax-row\">\n\t\t\t\t\t<div class=\"tax-label\">${description}</div>\n\t\t\t\t\t<div class=\"tax-value\">${format_currency(t.tax_amount_after_discount_amount, doc.currency)}</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\t})\n\t\t\t.join(\"\");\n\n\t\treturn `<div class=\"taxes-wrapper\">${taxes_html}</div>`;\n\t}\n\n\tget_grand_total_html(doc) {\n\t\treturn `<div class=\"summary-row-wrapper grand-total\">\n\t\t\t\t\t<div>${__(\"Grand Total\")}</div>\n\t\t\t\t\t<div>${format_currency(doc.grand_total, doc.currency)}</div>\n\t\t\t\t</div>`;\n\t}\n\n\tget_payment_html(doc, payment) {\n\t\treturn `<div class=\"summary-row-wrapper payments\">\n\t\t\t\t\t<div>${__(payment.mode_of_payment)}</div>\n\t\t\t\t\t<div>${format_currency(payment.amount, doc.currency)}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"summary-row-wrapper change\">\n\t\t\t\t\t<div>${__('Change')}</div>\n\t\t\t\t\t<div>${format_currency(doc.change_amount, doc.currency)}</div>\n\t\t\t\t</div>\n\t\t\t\t`;\n\t}\n\n\t// added change dom for change amount\n\t// get_change_html(doc) {\n\t// \t`<div class=\"summary-row-wrapper change\">\n\t// \t\t<div>${__('Change')}</div>\n\t// \t\t<div>${format_currency(doc.change_amount, doc.currency)}</div>\n\t// \t</div>`\n\t// }\n\n\tbind_events() {\n\t\tthis.$summary_container.on(\"click\", \".return-btn\", () => {\n\t\t\tthis.events.process_return(this.doc.name);\n\t\t\tthis.toggle_component(false);\n\t\t\tthis.$component.find(\".no-summary-placeholder\").css(\"display\", \"flex\");\n\t\t\tthis.$summary_wrapper.css(\"display\", \"none\");\n\t\t});\n\n\t\tthis.$summary_container.on(\"click\", \".edit-btn\", () => {\n\t\t\tthis.events.edit_order(this.doc.name);\n\t\t\tthis.toggle_component(false);\n\t\t\tthis.$component.find(\".no-summary-placeholder\").css(\"display\", \"flex\");\n\t\t\tthis.$summary_wrapper.css(\"display\", \"none\");\n\t\t});\n\n\t\tthis.$summary_container.on(\"click\", \".delete-btn\", () => {\n\t\t\tthis.events.delete_order(this.doc.name);\n\t\t\tthis.show_summary_placeholder();\n\t\t});\n\n\t\tthis.$summary_container.on(\"click\", \".delete-btn\", () => {\n\t\t\tthis.events.delete_order(this.doc.name);\n\t\t\tthis.show_summary_placeholder();\n\t\t\t\n\t\t\t// this.toggle_component(false);\n\t\t\t// this.$component.find('.no-summary-placeholder').removeClass('d-none');\n\t\t\t// this.$summary_wrapper.addClass('d-none');\n\t\t});\n\n\t\tthis.$summary_container.on(\"click\", \".new-btn\", () => {\n\t\t\tthis.events.new_order();\n\t\t\tthis.toggle_component(false);\n\t\t\tthis.$component.find(\".no-summary-placeholder\").css(\"display\", \"flex\");\n\t\t\tthis.$summary_wrapper.css(\"display\", \"none\");\n\t\t});\n\n\t\tthis.$summary_container.on(\"click\", \".email-btn\", () => {\n\t\t\tthis.email_dialog.fields_dict.email_id.set_value(this.customer_email);\n\t\t\tthis.email_dialog.show();\n\t\t});\n\n\t\tthis.$summary_container.on(\"click\", \".print-btn\", () => {\n\t\t\tthis.print_receipt();\n\t\t});\n\t}\n\n\tpos_new_order() {\n\t\tthis.events.new_order();\n\t}\n\n\tprint_receipt() {\n\n\t\tconst frm = this.events.get_frm();\n\t\tfrappe.utils.print(\n\t\t\tthis.doc.doctype,\n\t\t\tthis.doc.name,\n\t\t\tfrm.pos_print_format,\n\t\t\tthis.doc.letter_head,\n\t\t\tthis.doc.language || frappe.boot.lang\n\t\t);\n\t\t\n\t}\n\n\tattach_shortcuts() {\n\t\tconst ctrl_label = frappe.utils.is_mac() ? \"\u2318\" : \"Ctrl\";\n\t\tthis.$summary_container.find(\".print-btn\").attr(\"title\", `${ctrl_label}+P`);\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: \"ctrl+p\",\n\t\t\taction: () => this.$summary_container.find(\".print-btn\").click(),\n\t\t\tcondition: () =>\n\t\t\t\tthis.$component.is(\":visible\") && this.$summary_container.find(\".print-btn\").is(\":visible\"),\n\t\t\tdescription: __(\"Print Receipt\"),\n\t\t\tpage: cur_page.page.page,\n\t\t});\n\t\tthis.$summary_container.find(\".new-btn\").attr(\"title\", `${ctrl_label}+Enter`);\n\t\tfrappe.ui.keys.on(\"ctrl+enter\", () => {\n\t\t\tconst summary_is_visible = this.$component.is(\":visible\");\n\t\t\tif (summary_is_visible && this.$summary_container.find(\".new-btn\").is(\":visible\")) {\n\t\t\t\tthis.$summary_container.find(\".new-btn\").click();\n\t\t\t}\n\t\t});\n\t\tthis.$summary_container.find(\".edit-btn\").attr(\"title\", `${ctrl_label}+E`);\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: \"ctrl+e\",\n\t\t\taction: () => this.$summary_container.find(\".edit-btn\").click(),\n\t\t\tcondition: () =>\n\t\t\t\tthis.$component.is(\":visible\") && this.$summary_container.find(\".edit-btn\").is(\":visible\"),\n\t\t\tdescription: __(\"Edit Receipt\"),\n\t\t\tpage: cur_page.page.page,\n\t\t});\n\n\t\tthis.$summary_container.find(\".edit-btn\").attr(\"title\", `${ctrl_label}+E`);\n\t\tfrappe.ui.keys.add_shortcut({\n\t\t\tshortcut: \"ctrl+e\",\n\t\t\taction: () => this.$summary_container.find(\".edit-btn\").click(),\n\t\t\tcondition: () =>\n\t\t\t\tthis.$component.is(\":visible\") && this.$summary_container.find(\".edit-btn\").is(\":visible\"),\n\t\t\tdescription: __(\"Edit Receipt\"),\n\t\t\tpage: cur_page.page.page,\n\t\t});\n\t\t\n\t}\n\n\tsend_email() {\n\t\tconst frm = this.events.get_frm();\n\t\tconst recipients = this.email_dialog.get_values().email_id;\n\t\tconst content = this.email_dialog.get_values().content;\n\t\tconst doc = this.doc || frm.doc;\n\t\tconst print_format = frm.pos_print_format;\n\n\t\tfrappe.call({\n\t\t\tmethod: \"frappe.core.doctype.communication.email.make\",\n\t\t\targs: {\n\t\t\t\trecipients: recipients,\n\t\t\t\tsubject: __(frm.meta.name) + \": \" + doc.name,\n\t\t\t\tcontent: content ? content : __(frm.meta.name) + \": \" + doc.name,\n\t\t\t\tdoctype: doc.doctype,\n\t\t\t\tname: doc.name,\n\t\t\t\tsend_email: 1,\n\t\t\t\tprint_format,\n\t\t\t\tsender_full_name: frappe.user.full_name(),\n\t\t\t\t_lang: doc.language,\n\t\t\t},\n\t\t\tcallback: (r) => {\n\t\t\t\tif (!r.exc) {\n\t\t\t\t\tfrappe.utils.play_sound(\"email\");\n\t\t\t\t\tif (r.message[\"emails_not_sent_to\"]) {\n\t\t\t\t\t\tfrappe.msgprint(\n\t\t\t\t\t\t\t__(\"Email not sent to {0} (unsubscribed / disabled)\", [\n\t\t\t\t\t\t\t\tfrappe.utils.escape_html(r.message[\"emails_not_sent_to\"]),\n\t\t\t\t\t\t\t])\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\tmessage: __(\"Email sent successfully.\"),\n\t\t\t\t\t\t\tindicator: \"green\",\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tthis.email_dialog.hide();\n\t\t\t\t} else {\n\t\t\t\t\tfrappe.msgprint(__(\"There were errors while sending email. Please try again.\"));\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\tadd_summary_btns(map) {\n\t\tthis.$summary_btns.html(\"\");\n\t\tmap.forEach((m) => {\n\t\t\tif (m.condition) {\n\t\t\t\tm.visible_btns.forEach((b) => {\n\t\t\t\t\tconst class_name = b.split(\" \")[0].toLowerCase();\n\t\t\t\t\tconst btn = __(b);\n\t\t\t\t\tthis.$summary_btns.append(\n\t\t\t\t\t\t`<div class=\"summary-btn btn btn-default ${class_name}-btn\">${btn}</div>`\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.$summary_btns.children().last().removeClass(\"mr-4\");\n\t\t\n\t}\n\n\ttoggle_summary_placeholder(show) {\n\t\tif (show) {\n\t\t\tthis.$summary_wrapper.css(\"display\", \"none\");\n\t\t\tthis.$component.find(\".no-summary-placeholder\").css(\"display\", \"flex\");\n\t\t} else {\n\t\t\tthis.$summary_wrapper.css(\"display\", \"flex\");\n\t\t\tthis.$component.find(\".no-summary-placeholder\").css(\"display\", \"none\");\n\t\t}\n\t}\n\n\tget_condition_btn_map(after_submission) {\n\t\tif (after_submission)\n\t\t\treturn [{ condition: true, visible_btns: [\"Print Receipt\", \"Email Receipt\", \"New Order\"] }];\n\n\t\t// added print reciept button \n\t\treturn [\n\t\t\t{ condition: this.doc.docstatus === 0, visible_btns: [\"Edit Order\"] },\n\t\t\t{\n\t\t\t\tcondition: !this.doc.is_return && this.doc.docstatus === 1,\n\t\t\t\tvisible_btns: [\"Print Receipt\", \"Email Receipt\", \"Return\"],\t\n\t\t\t},\n\t\t\t{\n\t\t\t\tcondition: this.doc.is_return && this.doc.docstatus === 1,\n\t\t\t\tvisible_btns: [\"Print Receipt\", \"Email Receipt\"],\n\t\t\t},\n\t\t];\n\t}\n\n\tload_summary_of(doc, after_submission = false) {\n\t\tafter_submission\n\t\t\t? this.$component.css(\"grid-column\", \"span 10 / span 10\")\n\t\t\t: this.$component.css(\"grid-column\", \"span 6 / span 6\");\n\n\t\tthis.toggle_summary_placeholder(false);\n\n\t\tthis.doc = doc;\n\n\t\tthis.attach_document_info(doc);\n\n\t\tthis.attach_items_info(doc);\n\n\t\tthis.attach_totals_info(doc);\n\n\t\tthis.attach_payments_info(doc);\n\n\t\t// this.attach_change_info(doc); // added change attactment\n\n\t\tconst condition_btns_map = this.get_condition_btn_map(after_submission);\n\n\t\tthis.add_summary_btns(condition_btns_map);\n\t}\n\n\tattach_document_info(doc) {\n\t\tfrappe.db.get_value(\"Customer\", this.doc.customer, \"email_id\").then(({ message }) => {\n\t\t\tthis.customer_email = message.email_id || \"\";\n\t\t\tconst upper_section_dom = this.get_upper_section_html(doc);\n\t\t\tjsbarcode(\"#barcode\", doc.name, {\n\t\t\t\twidth: 1\n\t\t\t}\n\t\t\t);\n\t\t\tthis.$upper_section.html(upper_section_dom); SS\n\t\t});\n\t}\n\n\tattach_items_info(doc) {\n\t\tthis.$items_container.html(\"\");\n\t\tdoc.items.forEach((item) => {\n\t\t\tconst item_dom = this.get_item_html(doc, item);\n\t\t\tthis.$items_container.append(item_dom);\n\t\t\tthis.set_dynamic_rate_header_width();\n\t\t});\n\t}\n\n\tset_dynamic_rate_header_width() {\n\t\tconst rate_cols = Array.from(this.$items_container.find(\".item-rate-disc\"));\n\t\tthis.$items_container.find(\".item-rate-disc\").css(\"width\", \"\");\n\t\tlet max_width = rate_cols.reduce((max_width, elm) => {\n\t\t\tif ($(elm).width() > max_width) max_width = $(elm).width();\n\t\t\treturn max_width;\n\t\t}, 0);\n\n\t\tmax_width += 1;\n\t\tif (max_width == 1) max_width = \"\";\n\n\t\tthis.$items_container.find(\".item-rate-disc\").css(\"width\", max_width);\n\t}\n\n\tattach_payments_info(doc) {\n\t\tthis.$payment_container.html(\"\");\n\t\t// this.$change_container.html(\"\");\n\t\t// const change_dom = this.get_change_html(doc)\n\t\t// this.$change_container.append(change_dom);\n\t\tdoc.payments.forEach((p) => {\n\t\t\tif (p.amount) {\n\t\t\t\tconst payment_dom = this.get_payment_html(doc, p);\n\t\t\t\tthis.$payment_container.append(payment_dom);\n\t\t\t}\n\t\t});\n\t\tif (doc.redeem_loyalty_points && doc.loyalty_amount) {\n\t\t\tconst payment_dom = this.get_payment_html(doc, {\n\t\t\t\tmode_of_payment: \"Loyalty Points\",\n\t\t\t\tamount: doc.loyalty_amount,\n\t\t\t});\n\t\t\tthis.$payment_container.append(payment_dom);\n\t\t}\n\t}\n\n\tattach_totals_info(doc) {\n\t\tthis.$totals_container.html(\"\");\n\n\t\tconst net_total_dom = this.get_net_total_html(doc);\n\t\tconst vatable_sale_dom =this.get_vatable_sales_html(doc);\n\t\tconst vat_exempt_dom =this.get_vatable_exempt_html(doc);\n\t\tconst zero_rated_dom = this.get_zero_rated_html(doc);\n\t\tconst vat_amount_dom = this.get_vat_amount_html(doc);\n\t\tconst taxes_dom = this.get_taxes_html(doc);\n\t\tconst discount_dom = this.get_discount_html(doc);\n\t\tconst grand_total_dom = this.get_grand_total_html(doc);\n\t\tthis.$totals_container.append(net_total_dom);\n\t\t// this.$totals_container.append(vatable_sale_dom);\n\t\t// this.$totals_container.append(vat_exempt_dom);\n\t\t// this.$totals_container.append(zero_rated_dom);\n\t\t// this.$totals_container.append(vat_amount_dom);\n\t\tthis.$totals_container.append(taxes_dom);\n\t\tthis.$totals_container.append(discount_dom);\n\t\tthis.$totals_container.append(grand_total_dom);\n\t}\n\n\ttoggle_component(show) {\n\t\tshow ? this.$component.css(\"display\", \"flex\") : this.$component.css(\"display\", \"none\");\n\t}\n};\n", "custom_app.PointOfSale.Controller = class {\n\tconstructor(wrapper) {\n\t\tthis.wrapper = $(wrapper).find(\".layout-main-section\");\n\t\tthis.page = wrapper.page;\n\n\t\tthis.init_pos_profile();\n\t\tthis.add_event_listeners();\n\t\tconsole.log('Controller is loaded');\n\t}\n\n\tinit_pos_profile() {\n\t\tconst savedPosProfile = localStorage.getItem('pos_profile');\n\t\tconst selectedWarehouse = localStorage.getItem('selected_warehouse');\n\t\tif (savedPosProfile) {\n\t\t\tthis.prepare_app_defaults({ pos_profile: savedPosProfile, warehouse: selectedWarehouse });\n\t\t} else {\n\t\t\tthis.select_pos_profile();\n\t\t}\n\t}\n\n\n\n\tselect_pos_profile() {\n\t\tconst me = this;\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Select POS Profile\"),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Link\",\n\t\t\t\t\tlabel: __(\"POS Profile\"),\n\t\t\t\t\toptions: \"POS Profile\",\n\t\t\t\t\tfieldname: \"pos_profile\",\n\t\t\t\t\treqd: 1,\n\t\t\t\t\tget_query: () => ({\n\t\t\t\t\t\tquery: \"erpnext.accounts.doctype.pos_profile.pos_profile.pos_profile_query\",\n\t\t\t\t\t\tfilters: { company: frappe.defaults.get_default(\"company\") },\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t],\n\t\t\tprimary_action: function ({ pos_profile }) {\n\t\t\t\tlocalStorage.setItem('pos_profile', pos_profile);\n\t\t\t\tme.prepare_app_defaults({ pos_profile });\n\t\t\t\tdialog.hide();\n\n\t\t\t\t// Reload the page after selecting the POS profile\n\t\t\t\tlocation.reload();\n\t\t\t},\n\t\t\tprimary_action_label: __(\"Select\"),\n\t\t});\n\t\tdialog.show();\n\t}\n\n\n\n\n\n\tasync prepare_app_defaults(data) {\n\t\tthis.company = frappe.defaults.get_default(\"company\");\n\t\tthis.pos_profile = data.pos_profile;\n\t\tthis.warehouse = data.warehouse || null;\n\t\tthis.item_stock_map = {};\n\t\tthis.settings = {};\n\n\t\tfrappe.db.get_value(\"Stock Settings\", undefined, \"allow_negative_stock\").then(({ message }) => {\n\t\t\tthis.allow_negative_stock = flt(message.allow_negative_stock) || false;\n\t\t});\n\n\t\tfrappe.call({\n\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.get_pos_profile_data\",\n\t\t\targs: { pos_profile: this.pos_profile },\n\t\t\tcallback: (res) => {\n\t\t\t\tconst profile = res.message;\n\t\t\t\tObject.assign(this.settings, profile);\n\t\t\t\tthis.settings.customer_groups = profile.customer_groups.map((group) => group.name);\n\t\t\t\tthis.make_app();\n\t\t\t},\n\t\t});\n\t}\n\n\tset_opening_entry_status() {\n\t\tthis.page.set_title_sub(\n\t\t\t`<span class=\"indicator orange\">\n\t\t\t\t<a class=\"text-muted\" href=\"#Form/POS%20Opening%20Entry/${this.pos_opening}\">\n\t\t\t\t\tOpened at ${moment(this.pos_opening_time).format(\"Do MMMM, h:mma\")}\n\t\t\t\t</a>\n\t\t\t</span>`\n\t\t);\n\t}\n\n\tmake_app() {\n\t\tthis.prepare_dom();\n\t\tthis.prepare_components();\n\t\tthis.prepare_menu();\n\t\tthis.add_buttons_to_toolbar();\n\t\tthis.make_new_invoice();\n\t\t// this.setup_shortcuts();\n\t}\n\n\tprepare_dom() {\n\t\tthis.wrapper.append(`<div class=\"point-of-sale-app\"></div>`);\n\t\tthis.$components_wrapper = this.wrapper.find(\".point-of-sale-app\");\n\t}\n\n\tprepare_components() {\n\t\tthis.init_item_selector();\n\t\tthis.init_item_details();\n\t\tthis.init_item_cart();\n\t\tthis.init_payments();\n\t\tthis.init_recent_order_list();\n\t\tthis.init_order_summary();\n\t}\n\n\n\n\tprepare_dom() {\n\t\tthis.wrapper.append(`<div class=\"point-of-sale-app\"></div>`);\n\n\t\tthis.$components_wrapper = this.wrapper.find(\".point-of-sale-app\");\n\t}\n\n\n\n\tprepare_menu() {\n\t\tthis.page.clear_menu();\n\t\tthis.page.add_menu_item(__(\"Item Selector (F1)\"), this.add_new_order.bind(this), false, \"f1\");\n\t\tthis.page.add_menu_item(\n\t\t\t__(\"Pending Transaction (F2)\"),\n\t\t\tthis.order_list.bind(this),\n\t\t\tfalse,\n\t\t\t\"f2\"\n\t\t);\n\t\tthis.page.add_menu_item(__(\"Branch Item Lookup (F4)\"), this.show_branch_selection_dialog.bind(this), false, \"f4\");\n\t\tthis.page.add_menu_item(__(\"Change POS Profile (F5)\"), this.select_pos_profile.bind(this), false, \"f5\");\n\t\tthis.page.add_menu_item(__(\"Save as Draft\"), this.save_draft.bind(this), false, \"f3\");\n\n\t}\n\n\n\tadd_buttons_to_toolbar() {\n\t\tconst buttons = [\n\t\t\t{ label: __(\"Item Selector (F1)\"), action: this.add_new_order.bind(this), shortcut: \"f1\" },\n\t\t\t{ label: __(\"Pending Transaction (F2\"), action: this.order_list.bind(this), shortcut: \"f2\" },\n\t\t\t{ label: __(\"Save as Draft (F3)\"), action: this.save_draft.bind(this), shortcut: \"f3\" },\n\t\t\t{ label: __(\"Amesco Plus Member\"), action: this.amesco_plus_scan.bind(this)},\n\t\t\t{ label: __(\"Branch Item Lookup (F4)\"), action: this.show_branch_selection_dialog.bind(this), shortcut: \"f4\" },\n\t\t\t// { label: __(\"Change POS Profile (F5)\"), action: this.select_pos_profile.bind(this), shortcut: \"f5\" },\n\t\t];\n\n\t\t// Clear existing buttons to avoid duplication\n\t\t$('.page-actions .btn-custom').remove();\n\n\t\tbuttons.forEach(btn => {\n\t\t\tthis.page.add_button(btn.label, btn.action, { shortcut: btn.shortcut }).addClass('btn-custom');\n\t\t});\n\t}\n\n\n\tadd_new_order() {\n\t\tfrappe.run_serially([\n\t\t\t() => frappe.dom.freeze(),\n\t\t\t() => this.frm.call(\"reset_mode_of_payments\"),\n\t\t\t() => this.cart.load_invoice(),\n\t\t\t() => this.make_new_invoice(),\n\t\t\t() => this.item_selector.toggle_component(true),\n\t\t\t() => this.item_details.toggle_item_details_section(),\n\t\t\t() => this.toggle_recent_order_list(false),\n\t\t\t() => window.location.reload(),\n\t\t\t() => frappe.dom.unfreeze(),\n\t\t]);\n\t}\n\n\torder_list() {\n\t\tfrappe.run_serially([\n\t\t\t() => frappe.dom.freeze(),\n\t\t\t() => this.toggle_recent_order_list(true),\n\t\t\t() => frappe.dom.unfreeze(),\n\t\t]);\n\t}\n\n\tamesco_plus_scan() {\n\t\tconst me = this;\n\t\tconst doc = me.frm;\n\t\n\t\t// Create a dialog with a data field for manual input\n\t\tlet manualInputDialog = new frappe.ui.Dialog({\n\t\t\ttitle: __('Enter Scanned Data'),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Scanned Data',\n\t\t\t\t\tfieldname: 'scanned_data',\n\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\treqd: 1, // Make this field mandatory\n\t\t\t\t\tdescription: 'Enter the scanned data (comma-separated format)'\n\t\t\t\t}\n\t\t\t],\n\t\t\tprimary_action_label: __('Submit'),\n\t\t\tprimary_action(values) {\n\t\t\t\tlet scannedData = values.scanned_data.split(',');  // Assuming the data is comma-separated\n\t\n\t\t\t\tif (scannedData.length >= 5) {\n\t\t\t\t\t// Extracting fields from the scanned data\n\t\t\t\t\tlet user_id = scannedData[0];\n\t\t\t\t\tlet userName = scannedData[2];\n\t\t\t\t\tlet email = scannedData[3];\n\t\t\t\t\tlet points = scannedData[4];\n\t\n\t\t\t\t\t// Set the extracted values in the document\n\t\t\t\t\tdoc.set_value('custom_ameso_user', email);\n\t\t\t\t\tdoc.set_value('custom_amesco_user_id', user_id);\n\t\n\t\t\t\t\t// Display the extracted user details in another dialog\n\t\t\t\t\tlet userDetailsDialog = new frappe.ui.Dialog({\n\t\t\t\t\t\ttitle: __('Scanned User Details'),\n\t\t\t\t\t\tfields: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Name',\n\t\t\t\t\t\t\t\tfieldname: 'user_name',\n\t\t\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\t\t\tread_only: 1,\n\t\t\t\t\t\t\t\tdefault: userName\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Email',\n\t\t\t\t\t\t\t\tfieldname: 'email',\n\t\t\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\t\t\tread_only: 1,\n\t\t\t\t\t\t\t\tdefault: email\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: 'Points',\n\t\t\t\t\t\t\t\tfieldname: 'points',\n\t\t\t\t\t\t\t\tfieldtype: 'Data',\n\t\t\t\t\t\t\t\tread_only: 1,\n\t\t\t\t\t\t\t\tdefault: points\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tprimary_action_label: __('Close'),\n\t\t\t\t\t\tprimary_action: function() {\n\t\t\t\t\t\t\tuserDetailsDialog.hide();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\n\t\t\t\t\t// Show the dialog with the user details\n\t\t\t\t\tuserDetailsDialog.show();\n\t\n\t\t\t\t} else {\n\t\t\t\t\tfrappe.msgprint(__('Invalid data format. Please enter at least 5 comma-separated values.'));\n\t\t\t\t}\n\t\n\t\t\t\t// Hide the manual input dialog after submission\n\t\t\t\tmanualInputDialog.hide();\n\t\t\t}\n\t\t});\n\t\n\t\t// Show the manual input dialog\n\t\tmanualInputDialog.show();\n\t}\n\n\n\tset_discount_log(doc, user, email) {\n\t\tdoc.set_value('custom_ameso_user', updated_discount_log);\n\t\tdoc.set_value('custom_manual_dicsount', updated_discount_log);\n\t}\n\t\n\t\n\t\n\t// Define the handle_scanned_barcode function\n\thandle_scanned_barcode(barcode) {\n\t\t// Logic to handle the scanned barcode\n\t\tconsole.log(\"Scanned Barcode:\", barcode);\n\t\t// Add your barcode handling logic here\n\t}\n\n\t// prepare_buttons() {\n\t// \tthis.page.clear_actions(); // Clear any existing buttons\n\t// \tthis.page.add_button(__(\"Toggle Recent Orders\"), this.toggle_recent_order.bind(this), \"octicon octicon-sync\", \"btn-secondary\");\n\t// \tthis.page.add_button(__(\"Toggle Recent Orders\"), this.toggle_recent_order.bind(this), \"octicon octicon-sync\", \"btn-secondary\");\n\t// \tthis.page.add_button(__(\"Toggle Recent Orders\"), this.toggle_recent_order.bind(this), \"octicon octicon-sync\", \"btn-secondary\");\n\t// \t// Add a button for \"Toggle Recent Orders\"\n\t// \tthis.page.add_button(__(\"Toggle Pending Transaction (F6)\"), this.toggle_recent_order.bind(this), \"octicon octicon-sync\", \"btn-secondary\", \"Ctrl+O\");\n\n\t// \t// Add a button for \"Complete Order\"\n\t// \t//this.page.add_button(__(\"Complete Order\"), this.save_draft_invoice.bind(this), \"octicon octicon-check\", \"btn-primary\");\n\n\t// \t// Add a button for \"Branch Item Lookup\"\n\t// \tthis.page.add_button(__(\"Branch Item Lookup\"), () => {\n\t// \t\tthis.show_branch_selection_dialog()\n\t// \t}, \"octicon octicon-search\", \"btn-secondary\");\n\t// }\n\n\t// setup_shortcuts() {\n\t// \t// Add shortcut for \"Toggle Recent Orders\" - F1\n\t// \tfrappe.ui.keys.add_shortcut({\n\t// \t\tshortcut: 'f1',\n\t// \t\taction: () => this.toggle_recent_order(),\n\t// \t\tdescription: __('Toggle Recent Orders'),\n\t// \t\tpage: this.page\n\t// \t});\n\n\t// \t// Add shortcut for \"Complete Order\" - F2\n\t// \tfrappe.ui.keys.add_shortcut({\n\t// \t\tshortcut: 'f2',\n\t// \t\taction: () => this.save_draft_invoice(),\n\t// \t\tdescription: __('Complete Order'),\n\t// \t\tpage: this.page\n\t// \t});\n\n\t// \t// Add shortcut for \"Branch Item Lookup\" - F3\n\t// \tfrappe.ui.keys.add_shortcut({\n\t// \t\tshortcut: 'f3',\n\t// \t\taction: () => this.show_branch_selection_dialog(),\n\t// \t\tdescription: __('Branch Item Lookup'),\n\t// \t\tpage: this.page\n\t// \t});\n\t// }\n\n\t// buttons() {\n\t// \tpage.set_secondary_action('Refresh', () => refresh(), 'octicon octicon-sync')\n\t// }\n\n\tshow_branch_selection_dialog() {\n\t\tconst selectedWarehouse = localStorage.getItem('selected_warehouse') || '';\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Select Branch\"),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Link\",\n\t\t\t\t\tlabel: __(\"Warehouse\"),\n\t\t\t\t\toptions: \"Warehouse\",\n\t\t\t\t\tfieldname: \"warehouse\",\n\t\t\t\t\tdefault: selectedWarehouse,\n\t\t\t\t\treqd: 1,\n\t\t\t\t\tget_query: () => ({\n\t\t\t\t\t\tquery: \"custom_app.customapp.page.packing_list.packing_list.warehouse_query\",\n\t\t\t\t\t\tfilters: { company: frappe.defaults.get_default(\"company\") }\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t],\n\t\t\tprimary_action: function (data) {\n\t\t\t\t// console.log(\"Selected Warehouse:\", data.warehouse);\n\t\t\t\t// Save the selected warehouse to local storage\n\t\t\t\tlocalStorage.setItem('selected_warehouse', data.warehouse);\n\t\t\t\t// Refresh the POS with the selected warehouse\n\t\t\t\tlocation.reload();\n\t\t\t\tdialog.hide();\n\t\t\t},\n\t\t\tprimary_action_label: __(\"View\"),\n\t\t\tsecondary_action_label: __(\"Clear\"), // Adding a clear button\n\t\t\tsecondary_action: function () {\n\t\t\t\t// Clear the selected warehouse from local storage\n\t\t\t\tlocalStorage.removeItem('selected_warehouse');\n\t\t\t\t// Refresh the POS to reflect the change\n\t\t\t\tlocation.reload();\n\t\t\t\tdialog.hide();\n\t\t\t}\n\t\t});\n\n\t\tdialog.show();\n\t}\n\n\n\n\tprepare_profile_selection() {\n\t\tconst me = this;\n\n\t\t// Create a select field for Warehouses\n\t\tconst warehouseField = this.page.add_field({\n\t\t\tlabel: 'Branch',\n\t\t\tfieldtype: 'Select',\n\t\t\tfieldname: 'warehouse',\n\t\t\toptions: [],\n\t\t\tchange() {\n\t\t\t\tconst selectedWarehouse = warehouseField.get_value();\n\t\t\t\tif (selectedWarehouse) {\n\t\t\t\t\tme.set_warehouse(selectedWarehouse); // where do i put set_warehouse\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Fetch Warehouses and populate the select options\n\t\tfrappe.call({\n\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.warehouse_query\",\n\t\t\targs: {\n\t\t\t\tdoctype: \"Warehouse\",\n\t\t\t\ttxt: \"\",\n\t\t\t\tsearchfield: \"name\",\n\t\t\t\tstart: 0,\n\t\t\t\tpage_len: 100,\n\t\t\t\tfilters: {}\n\t\t\t},\n\t\t\tcallback: function (r) {\n\t\t\t\tif (r.message) {\n\t\t\t\t\t// console.log(r.message)\n\t\t\t\t\tconst warehouses = r.message.map(warehouse => warehouse[0]);\n\t\t\t\t\twarehouseField.df.options = [...warehouses];\n\t\t\t\t\twarehouseField.refresh();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\t// remove pos_profile when when changing page, and logout\n\tadd_event_listeners() {\n\n\t\t// Remove POS Profile from local storage on logout\n\t\tfrappe.logout = (function (originalLogout) {\n\t\t\treturn function () {\n\t\t\t\tlocalStorage.removeItem('pos_profile');\n\t\t\t\treturn originalLogout.apply(this, arguments);\n\t\t\t};\n\t\t})(frappe.logout);\n\t}\n\n\n\topen_form_view() {\n\t\tfrappe.model.sync(this.frm.doc);\n\t\tfrappe.set_route(\"Form\", this.frm.doc.doctype, this.frm.doc.name);\n\t}\n\n\ttoggle_recent_order() {\n\t\tconst show = this.recent_order_list.$component.is(\":hidden\");\n\t\tthis.toggle_recent_order_list(show);\n\t}\n\n\tasync save_draft_invoice() {\n\t\t\n\t\tif (this.passwordDialog) {\n\t\t\tthis.passwordDialog.hide();\n\t\t\tthis.passwordDialog.$wrapper.remove();\n\t\t\tdelete this.passwordDialog;\n\t\t}\n\n\t\tif (!this.$components_wrapper.is(\":visible\")) return;\n\t\n\t\tlet payment_amount = this.frm.doc.payments.reduce((sum, payment) => sum + payment.amount, 0);\n\n\t\tif (parseFloat(payment_amount.toFixed(2)) < this.frm.doc.grand_total) {\n\n\t\t\t// Show dialog indicating insufficient payment\n\t\t\tconst insufficientPaymentDialog = new frappe.ui.Dialog({\n\t\t\t\ttitle: __('Insufficient Payment'),\n\t\t\t\tprimary_action_label: __('OK'),\n\t\t\t\tprimary_action: () => {\n\t\t\t\t\tinsufficientPaymentDialog.hide();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tinsufficientPaymentDialog.body.innerHTML = `\n\t\t\t\t<div style=\"text-align: center; font-size: 30px; margin: 20px 0;\">\n\t\t\t\t\t${__('The payment amount is not enough to cover the grand total.')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tinsufficientPaymentDialog.show();\n\t\t\treturn; // Exit the function if payment is not sufficient\n\t\t}\n\t\n\t\tif (this.frm.doc.items.length === 0) {\n\t\t\tfrappe.show_alert({\n\t\t\t\tmessage: __(\"You must add at least one item to complete the order.\"),\n\t\t\t\tindicator: \"red\",\n\t\t\t});\n\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\treturn;\n\t\t}\n\t\n\t\t\n\n\t\t// Destroy any previous password dialogs\n\t\t// if (this.passwordDialog) {\n\t\t// \tthis.passwordDialog.$wrapper.remove();\n\t\t// \tdelete this.passwordDialog;\n\t\t// }\n\t\n\t\t// Create and show the password dialog\n\t\tthis.passwordDialog = new frappe.ui.Dialog({\n\t\t\ttitle: __('Enter Your Password'),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: 'HTML',\n\t\t\t\t\tfieldname: 'password_html',\n\t\t\t\t\toptions: `\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label for=\"password_field\">${__('Password')}</label>\n\t\t\t\t\t\t\t<input type=\"password\" id=\"sumbit_password\" class=\"form-control\" required>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`\n\t\t\t\t}\n\t\t\t],\n\t\t\tprimary_action_label: __('Ok'),\n\t\t\tprimary_action: () => {\n\t\t\t\tlet password = document.getElementById('sumbit_password').value;\n\t\t\t\tlet errorOccurred = false;\n\t\t\t\tconst user_data = JSON.parse(localStorage.getItem('user_data'));\n\n\t\t\t\tif (user_data && user_data.password === password) {\n\t\t\t\t\tthis.set_pharmacist_assist(this.frm, user_data.name);\n\t\t\t\t\tthis.frm\n\t\t\t\t\t\t.save(undefined, undefined, undefined, () => {\n\t\t\t\t\t\t\t// Error handling during save\n\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\tmessage: (\"There was an error saving the document.\"),\n\t\t\t\t\t\t\t\tindicator: \"red\",\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\t\t\t\t\terrorOccurred = true;  // Set error flag\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tif (errorOccurred) return;  // Skip further actions if an error occurred\n\t\t\t\n\t\t\t\t\t\t\tthis.passwordDialog.hide();\n\t\t\t\n\t\t\t\t\t\t\t// Load the order summary and print the receipt\n\t\t\t\t\t\t\tthis.order_summary.load_summary_of(this.frm.doc, true);\n\t\t\t\t\t\t\tthis.order_summary.print_receipt();\n\t\t\t\n\t\t\t\t\t\t\t// Remove stored data from local storage\n\t\t\t\t\t\t\tlocalStorage.removeItem('posCartItems');\n\t\t\t\n\t\t\t\t\t\t\t// Show alert after printing\n\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\tmessage: (\"Invoice Printed\"),\n\t\t\t\t\t\t\t\tindicator: \"blue\",\n\t\t\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t\t\t// Only run this block if no error occurred\n\t\t\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t\t\t() => frappe.dom.freeze(),\n\t\t\t\t\t\t\t\t() => this.make_new_invoice(),\n\t\t\t\t\t\t\t\t() => frappe.dom.unfreeze(),\n\t\t\t\t\t\t\t\t() => window.location.reload()\n\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\t// Handle any unanticipated errors\n\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\tmessage: __('An unexpected error occurred while saving the document. Please try again.'),\n\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\terrorOccurred = true;  // Set error flag\n\t\t\t\t\t\t});\n\t\t\t\t} else {\n\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.get_user_details_by_password\",\n\t\t\t\t\targs: { password: password },\n\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\tif (r.message && r.message.name) {\n\n\t\t\t\t\t\t\tlocalStorage.setItem('user_data', JSON.stringify(r.message));\n\n\t\t\t\t\t\t\tthis.set_pharmacist_assist(this.frm, r.message.name);\n\t\t\t\n\t\t\t\t\t\t\tthis.frm\n\t\t\t\t\t\t\t\t.save(undefined, undefined, undefined, () => {\n\t\t\t\t\t\t\t\t\t// Error handling during save\n\t\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\t\tmessage: (\"There was an error saving the document.\"),\n\t\t\t\t\t\t\t\t\t\tindicator: \"red\",\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\t\t\t\t\t\t\terrorOccurred = true;  // Set error flag\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tif (errorOccurred) return;  // Skip further actions if an error occurred\n\t\t\t\n\t\t\t\t\t\t\t\t\tthis.passwordDialog.hide();\n\t\t\t\n\t\t\t\t\t\t\t\t\t// Load the order summary and print the receipt\n\t\t\t\t\t\t\t\t\tthis.order_summary.load_summary_of(this.frm.doc, true);\n\t\t\t\t\t\t\t\t\tthis.order_summary.print_receipt();\n\t\t\t\n\t\t\t\t\t\t\t\t\t// Remove stored data from local storage\n\t\t\t\t\t\t\t\t\tlocalStorage.removeItem('posCartItems');\n\t\t\t\n\t\t\t\t\t\t\t\t\t// Show alert after printing\n\t\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\t\tmessage: (\"Invoice Printed\"),\n\t\t\t\t\t\t\t\t\t\tindicator: \"blue\",\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t\t\t\t\t// Only run this block if no error occurred\n\t\t\t\t\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t\t\t\t\t() => frappe.dom.freeze(),\n\t\t\t\t\t\t\t\t\t\t() => this.make_new_invoice(),\n\t\t\t\t\t\t\t\t\t\t() => frappe.dom.unfreeze(),\n\t\t\t\t\t\t\t\t\t\t() => window.location.reload()\n\t\t\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\t\t\t// Handle any unanticipated errors\n\t\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\t\tmessage: __('An unexpected error occurred while saving the document. Please try again.'),\n\t\t\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\terrorOccurred = true;  // Set error flag\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Handle incorrect password\n\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\tmessage: ('Incorrect password'),\n\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\terrorOccurred = true;  // Set error flag\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t}\n\t\t\t\n\t\t});\n\n\n\t\n\t\tthis.passwordDialog.$wrapper.on('shown.bs.modal', () => {\n\t\t\t// Use a short timeout to ensure the dialog is fully rendered\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst passwordField = document.getElementById('sumbit_password');\n\t\t\t\tif (passwordField) {\n\t\t\t\t\tpasswordField.focus();\n\t\t\t\t}\n\t\t\t}, 100); // Increase delay if necessary\n\t\t});\n\t\t\n\t\tthis.passwordDialog.show();\n\t}\n\t\n\n\t// save_draft_invoice() {\n\t// \tif (!this.$components_wrapper.is(\":visible\")) return;\n\t// \tlet payment_amount = this.frm.doc.payments.reduce((sum, payment) => sum + payment.amount, 0);\n\n\n\t// \tif (payment_amount < this.frm.doc.grand_total) {\n\t// \t\t// Show dialog indicating insufficient payment\n\t// \t\tconst insufficientPaymentDialog = new frappe.ui.Dialog({\n\t// \t\t\ttitle: __('Insufficient Payment'),\n\t// \t\t\tprimary_action_label: __('OK'),\n\t// \t\t\tprimary_action: () => {\n\t// \t\t\t\tinsufficientPaymentDialog.hide();\n\t// \t\t\t}\n\t// \t\t});\n\n\t// \t\tinsufficientPaymentDialog.body.innerHTML = `\n\t// \t\t\t<div style=\"text-align: center; font-size: 30px; margin: 20px 0;\">\n\t// \t\t\t\t${__('The payment amount is not enough to cover the grand total.')}\n\t// \t\t\t</div>\n\t// \t\t`;\n\n\t// \t\tinsufficientPaymentDialog.show();\n\t// \t\treturn; // Exit the function if payment is not sufficient\n\t// \t}\n\n\t// \tif (this.frm.doc.items.length == 0) {\n\t// \t\tfrappe.show_alert({\n\t// \t\t\tmessage: __(\"You must add atleast one item to complete the order.\"),\n\t// \t\t\tindicator: \"red\",\n\t// \t\t});\n\t// \t\tfrappe.utils.play_sound(\"error\");\n\t// \t\treturn;\n\t// \t}\n\n\t// \tconst passwordDialog = new frappe.ui.Dialog({\n\t// \t\ttitle: __('Enter Your Password'),\n\t// \t\tfields: [\n\t// \t\t\t{\n\t// \t\t\t\tfieldname: 'password',\n\t// \t\t\t\tfieldtype: 'Password',\n\t// \t\t\t\tlabel: __('Password'),\n\t// \t\t\t\treqd: 1\n\t// \t\t\t}\n\t// \t\t],\n\t// \t\tprimary_action_label: __('Ok'),\n\t// \t\tprimary_action: (values) => {\n    //             let password = values.password;\n\t// \t\t\tlet errorOccurred = false;\n\t\t\t\t\n    //             frappe.call({\n    //                 method: \"custom_app.customapp.page.packing_list.packing_list.get_user_details_by_password\",\n    //                 args: { password: password },\n    //                 callback: (r) => {\n    //                     if (r.message) {\n    //                         if(r.message.name) {\n    //                             this.set_pharmacist_assist(this.frm, r.message.name)\n\t// \t\t\t\t\t\t\tconsole.log(this.frm, r.message.name)\n    //                             this.frm\n    //                                 .save(undefined, undefined, undefined, () => {\n    //                                     frappe.show_alert({\n    //                                         message: (\"There was an error saving the document.\"),\n    //                                         indicator: \"red\",\n    //                                     });\n    //                                     frappe.utils.play_sound(\"error\");\n\t// \t\t\t\t\t\t\t\t\terrorOccurred = true;  \n    //                                 })\n    //                                 .then(() => {\n\n\t// \t\t\t\t\t\t\t\t\tif (errorOccurred) return; \n\n    //                                     frappe.run_serially([\n    //                                         () => frappe.dom.freeze(),\n    //                                         () => this.make_new_invoice(),\n    //                                         () => frappe.dom.unfreeze(),\n\t// \t\t\t\t\t\t\t\t\t\t() => window.location.reload()\n\n    //                                     ]);\n    //                                     passwordDialog.hide();\n\n    //                                     this.order_summary.load_summary_of(this.frm.doc, true);\n    //                                     this.order_summary.print_receipt();\n    //                                    // reload after successfull entered password\n    //                                     localStorage.removeItem('posCartItems'); // remove stored data from local storage\n    //                                     frappe.show_alert({\n    //                                         message: (\"Invoice Printed\"),\n    //                                         indicator: \"blue\",\n    //                                     }).catch((err) => {\n\t// \t\t\t\t\t\t\t\t\t\t// Handle any unanticipated errors\n\t// \t\t\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t// \t\t\t\t\t\t\t\t\t\t\tmessage: __('An unexpected error occurred while saving the document. Please try again.'),\n\t// \t\t\t\t\t\t\t\t\t\t\tindicator: 'red'\n\t// \t\t\t\t\t\t\t\t\t\t});\n\t// \t\t\t\t\t\t\t\t\t\terrorOccurred = true;  // Set error flag\n\t// \t\t\t\t\t\t\t\t\t});\n    //                                 });\n    //                         }else{\n    //                             frappe.show_alert({\n    //                                 message: ('Incorrect password'),\n    //                                 indicator: 'red'\n    //                             });\n\t// \t\t\t\t\t\t\terrorOccurred = true;  \n    //                         }\n    //                     } else {\n    //                         frappe.show_alert({\n    //                             message: ('Incorrect password'),\n    //                             indicator: 'red'\n    //                         });\n    //                     }\n    //                 }\n    //             });\n    //         }\n\t// \t})\n\t// \tpasswordDialog.show();\n\t// }\n\n\n\tsave_draft() {\n\t\t// Cleanup any existing dialog\n\t\tif (this.passwordDialog) {\n\t\t\tthis.passwordDialog.hide();\n\t\t\tthis.passwordDialog.$wrapper.remove();\n\t\t\tdelete this.passwordDialog;\n\t\t}\n\t\n\t\tif (!this.$components_wrapper.is(\":visible\")) return;\n\t\n\t\tif (this.frm.doc.items.length === 0) {\n\t\t\tfrappe.show_alert({\n\t\t\t\tmessage: __(\"You must add at least one item to complete the order.\"),\n\t\t\t\tindicator: \"red\",\n\t\t\t});\n\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\treturn;\n\t\t}\n\t\n\t\t// Create a new password dialog\n\t\tthis.passwordDialog = new frappe.ui.Dialog({\n\t\t\ttitle: __('Enter Your Password'),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: 'HTML',\n\t\t\t\t\tfieldname: 'password_html',\n\t\t\t\t\toptions: `\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label for=\"password_field\">${__('Password')}</label>\n\t\t\t\t\t\t\t<input type=\"password\" id=\"password_field\" class=\"form-control\" required>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`\n\t\t\t\t}\n\t\t\t],\n\t\t\tprimary_action_label: __('Ok'),\n\t\t\tprimary_action: () => {\n\t\t\t\tlet password = document.getElementById('password_field').value;\n\t\t\t\n\t\t\t\tlet errorOccurred = false;  // Flag to track errors\n\t\t\t\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.get_user_details_by_password\",\n\t\t\t\t\targs: { password: password },\n\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\tif (r.message && r.message.name) {\n\t\t\t\t\t\t\tthis.set_pharmacist_assist(this.frm, r.message.name);\n\t\t\t\n\t\t\t\t\t\t\tthis.frm\n\t\t\t\t\t\t\t\t.save(undefined, undefined, undefined, () => {\n\t\t\t\t\t\t\t\t\t// Error handling during save\n\t\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\t\tmessage: (\"There was an error saving the document.\"),\n\t\t\t\t\t\t\t\t\t\tindicator: \"red\",\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\t\t\t\t\t\t\terrorOccurred = true;  // Set error flag\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tif (errorOccurred) return;  // Skip further actions if an error occurred\n\t\t\t\n\t\t\t\t\t\t\t\t\tthis.passwordDialog.hide();\n\t\t\t\n\t\t\t\t\t\t\t\t\t// Load the order summary and print the receipt\n\t\t\t\t\t\t\t\t\tthis.order_summary.load_summary_of(this.frm.doc, true);\n\t\t\t\t\t\t\t\t\tthis.order_summary.print_receipt();\n\t\t\t\n\t\t\t\t\t\t\t\t\t// Remove stored data from local storage\n\t\t\t\t\t\t\t\t\tlocalStorage.removeItem('posCartItems');\n\t\t\t\n\t\t\t\t\t\t\t\t\t// Show alert after printing\n\t\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\t\tmessage: (\"Invoice Printed\"),\n\t\t\t\t\t\t\t\t\t\tindicator: \"blue\",\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t\t\t\t\t// Only run this block if no error occurred\n\t\t\t\t\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t\t\t\t\t() => frappe.dom.freeze(),\n\t\t\t\t\t\t\t\t\t\t() => this.make_new_invoice(),\n\t\t\t\t\t\t\t\t\t\t() => frappe.dom.unfreeze(),\n\t\t\t\t\t\t\t\t\t\t() => window.location.reload()\n\t\t\t\t\t\t\t\t\t]);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\t\t\t// Handle any unanticipated errors\n\t\t\t\t\t\t\t\t\tconsole.error(\"Unexpected error:\", err);\n\t\t\t\t\t\t\t\t\terrorOccurred = true;  // Set error flag\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Handle incorrect password\n\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\tmessage: ('Incorrect password'),\n\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\terrorOccurred = true;  // Set error flag\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\n\t\t// Ensure the password field gains focus every time the dialog is opened\n\t\tthis.passwordDialog.$wrapper.on('shown.bs.modal', () => {\n\t\t\t// Use a short timeout to ensure the dialog is fully rendered\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst passwordField = document.getElementById('password_field');\n\t\t\t\tif (passwordField) {\n\t\t\t\t\tpasswordField.focus();\n\t\t\t\t}\n\t\t\t}, 100); // Increase delay if necessary\n\t\t});\n\t\n\t\t// Show the dialog\n\t\tthis.passwordDialog.show();\n\t}\n\t\n\n\tset_pharmacist_assist(frm, user) {\n\t\tfrappe.model.set_value(frm.doc.doctype, frm.doc.name, \"custom_pharmacist_assistant\", user);\n\t\tfrm.refresh_field('custom_pharmacist_assistant');\n\t}\n\n\tclose_pos() {\n\t\tif (!this.$components_wrapper.is(\":visible\")) return;\n\n\t\tlet voucher = frappe.model.get_new_doc(\"POS Closing Entry\");\n\t\tvoucher.pos_profile = this.frm.doc.pos_profile;\n\t\tvoucher.user = frappe.session.user;\n\t\tvoucher.company = this.frm.doc.company;\n\t\tvoucher.pos_opening_entry = this.pos_opening;\n\t\tvoucher.period_end_date = frappe.datetime.now_datetime();\n\t\tvoucher.posting_date = frappe.datetime.now_date();\n\t\tvoucher.posting_time = frappe.datetime.now_time();\n\t\tfrappe.set_route(\"Form\", \"POS Closing Entry\", voucher.name);\n\t}\n\n\tinit_item_selector() {\n\t\tthis.item_selector = new custom_app.PointOfSale.ItemSelector({\n\t\t\twrapper: this.$components_wrapper,\n\t\t\tpos_profile: this.pos_profile,\n\t\t\tsettings: this.settings,\n\t\t\tevents: {\n\t\t\t\titem_selected: async (args) => {\n\t\t\t\t\tfrappe.call({\n\t\t\t\t\t\tmethod: 'custom_app.customapp.page.packing_list.packing_list.get_pos_warehouse',\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\tpos_profile: this.pos_profile\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\t\tif (r.message) {\n\t\t\t\t\t\t\t\tconst posWarehouse = r.message;\n\t\t\t\t\t\t\t\tconst selectedWarehouse = localStorage.getItem('selected_warehouse');\n\n\t\t\t\t\t\t\t\tif (posWarehouse === selectedWarehouse || selectedWarehouse === null) {\n\t\t\t\t\t\t\t\t\tthis.on_cart_update(args); // Proceed if warehouses match\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\t\tmessage: __(\"You cannot add items from a different branch.\"),\n\t\t\t\t\t\t\t\t\t\tindicator: \"red\",\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\tmessage: __(\"Could not retrieve the warehouse for the POS Profile.\"),\n\t\t\t\t\t\t\t\t\tindicator: \"red\",\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tget_frm: () => this.frm || {},\n\t\t\t\tget_pos_profile: () => {\n\t\t\t\t\treturn this.pos_profile\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\tinit_item_cart() {\n\t\tthis.cart = new custom_app.PointOfSale.ItemCart({\n\t\t\twrapper: this.$components_wrapper,\n\t\t\tsettings: this.settings,\n\t\t\tevents: {\n\t\t\t\tget_frm: () => this.frm,\n\n\t\t\t\t\n\n\t\t\t\tcart_item_clicked: (item, frm) => {\n\n\n\t\t\t\t\tconst item_row = this.get_item_from_frm(item);\n\t\t\t\t\tthis.item_details.toggle_item_details_section(item_row);\n\t\t\t\t},\n\n\t\t\t\tnumpad_event: (value, action) => this.update_item_field(value, action),\n\n\t\t\t\tcheckout: () => this.save_and_checkout(),\n\n\t\t\t\tedit_cart: () => this.payment.edit_cart(),\n\n\t\t\t\tcustomer_details_updated: (details) => {\n\t\t\t\t\tthis.customer_details = details;\n\t\t\t\t\t// will add/remove LP payment method\n\t\t\t\t\tthis.payment.render_loyalty_points_payment_mode();\n\t\t\t\t},\n\t\t\t},\n\n\t\t\t\n\t\t});\n\n\t}\n\n\tinit_item_details() {\n\t\tthis.item_details = new custom_app.PointOfSale.ItemDetails({\n\t\t\twrapper: this.$components_wrapper,\n\t\t\tsettings: this.settings,\n\t\t\tevents: {\n\t\t\t\tget_frm: () => this.frm,\n\n\t\t\t\ttoggle_item_selector: (minimize) => {\n\t\t\t\t\tthis.item_selector.resize_selector(minimize);\n\t\t\t\t\tthis.cart.toggle_numpad(minimize);\n\t\t\t\t},\n\n\t\t\t\tform_updated: (item, field, value) => {\n\t\t\t\t\tconst item_row = frappe.model.get_doc(item.doctype, item.name);\n\t\t\t\t\tif (item_row && item_row[field] != value) {\n\t\t\t\t\t\tconst args = {\n\t\t\t\t\t\t\tfield,\n\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\titem: this.item_details.current_item,\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn this.on_cart_update(args);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t},\n\n\t\t\t\thighlight_cart_item: (item) => {\n\t\t\t\t\tconst cart_item = this.cart.get_cart_item(item);\n\t\t\t\t\tthis.cart.toggle_item_highlight(cart_item);\n\t\t\t\t},\n\n\t\t\t\titem_field_focused: (fieldname) => {\n\t\t\t\t\tthis.cart.toggle_numpad_field_edit(fieldname);\n\t\t\t\t},\n\t\t\t\tset_value_in_current_cart_item: (selector, value) => {\n\t\t\t\t\tthis.cart.update_selector_value_in_cart_item(\n\t\t\t\t\t\tselector,\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\tthis.item_details.current_item\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tclone_new_batch_item_in_frm: (batch_serial_map, item) => {\n\t\t\t\t\t// called if serial nos are 'auto_selected' and if those serial nos belongs to multiple batches\n\t\t\t\t\t// for each unique batch new item row is added in the form & cart\n\t\t\t\t\tObject.keys(batch_serial_map).forEach((batch) => {\n\t\t\t\t\t\tconst item_to_clone = this.frm.doc.items.find((i) => i.name == item.name);\n\t\t\t\t\t\tconst new_row = this.frm.add_child(\"items\", { ...item_to_clone });\n\t\t\t\t\t\t// update new serialno and batch\n\t\t\t\t\t\tnew_row.batch_no = batch;\n\t\t\t\t\t\tnew_row.serial_no = batch_serial_map[batch].join(`\\n`);\n\t\t\t\t\t\tnew_row.qty = batch_serial_map[batch].length;\n\t\t\t\t\t\tthis.frm.doc.items.forEach((row) => {\n\t\t\t\t\t\t\tif (item.item_code === row.item_code) {\n\t\t\t\t\t\t\t\tthis.update_cart_html(row);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tremove_item_from_cart: () => this.remove_item_from_cart(),\n\t\t\t\tget_item_stock_map: () => this.item_stock_map,\n\t\t\t\tclose_item_details: () => {\n\t\t\t\t\tthis.item_details.toggle_item_details_section(null);\n\t\t\t\t\tthis.cart.prev_action = null;\n\t\t\t\t\tthis.cart.toggle_item_highlight();\n\t\t\t\t},\n\t\t\t\tget_available_stock: (item_code, warehouse) => this.get_available_stock(item_code, warehouse),\n\t\t\t},\n\t\t});\n\t}\n\n\tinit_payments() {\n\t\tthis.payment = new custom_app.PointOfSale.Payment({\n\t\t\twrapper: this.$components_wrapper,\n\t\t\tevents: {\n\t\t\t\tget_frm: () => this.frm || {},\n\n\t\t\t\tget_customer_details: () => this.customer_details || {},\n\n\t\t\t\ttoggle_other_sections: (show) => {\n\t\t\t\t\tif (show) {\n\t\t\t\t\t\tthis.item_details.$component.is(\":visible\")\n\t\t\t\t\t\t\t? this.item_details.$component.css(\"display\", \"none\")\n\t\t\t\t\t\t\t: \"\";\n\t\t\t\t\t\tthis.item_selector.toggle_component(false);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.item_selector.toggle_component(true);\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tsubmit_invoice: () => {\n\t\t\t\t\tthis.frm.savesubmit().then((r) => {\n\t\t\t\t\t\tthis.toggle_components(false);\n\t\t\t\t\t\tthis.order_summary.toggle_component(true);\n\t\t\t\t\t\tthis.order_summary.load_summary_of(this.frm.doc, true);\n\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\tindicator: \"green\",\n\t\t\t\t\t\t\tmessage: __(\"POS invoice {0} created succesfully\", [r.doc.name]),\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tsave_as_draft: () => {\n\t\t\t\t\tthis.save_draft_invoice()\n\t\t\t\t}\n\n\t\t\t},\n\t\t});\n\t}\n\n\tinit_recent_order_list() {\n\t\tthis.recent_order_list = new custom_app.PointOfSale.PastOrderList({\n\t\t\twrapper: this.$components_wrapper,\n\t\t\tevents: {\n\t\t\t\topen_invoice_data: (name) => {\n\t\t\t\t\tfrappe.db.get_doc(\"POS Invoice\", name).then((doc) => {\n\t\t\t\t\t\tthis.order_summary.load_summary_of(doc);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\t// return pos profile\n\t\t\t\tpos_profile: () => {\n\t\t\t\t\treturn this.pos_profile\n\t\t\t\t},\n\t\t\t\treset_summary: () => this.order_summary.toggle_summary_placeholder(true),\n\t\t\t},\n\t\t});\n\t}\n\n\tinit_order_summary() {\n\t\tthis.order_summary = new custom_app.PointOfSale.PastOrderSummary({\n\t\t\twrapper: this.$components_wrapper,\n\t\t\tevents: {\n\t\t\t\tget_frm: () => this.frm,\n\n\t\t\t\tprocess_return: (name) => {\n\t\t\t\t\tthis.recent_order_list.toggle_component(false);\n\t\t\t\t\tfrappe.db.get_doc(\"POS Invoice\", name).then((doc) => {\n\t\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t\t() => this.make_return_invoice(doc),\n\t\t\t\t\t\t\t() => this.cart.load_invoice(),\n\t\t\t\t\t\t\t() => this.item_selector.toggle_component(true),\n\t\t\t\t\t\t]);\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tedit_order: (name) => {\n\t\t\t\t\tthis.oic_edit_confirm(name); // Call password authentication before edit order\n\t\t\t\t},\n\n\t\t\t\tdelete_order: (name) => {\n\t\t\t\t\tfrappe.model.delete_doc(this.frm.doc.doctype, name, () => {\n\t\t\t\t\t\tthis.recent_order_list.refresh_list();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tnew_order: () => {\n\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t() => frappe.dom.freeze(),\n\t\t\t\t\t\t() => this.make_new_invoice(),\n\t\t\t\t\t\t() => this.item_selector.toggle_component(true),\n\t\t\t\t\t\t() => frappe.dom.unfreeze(),\n\t\t\t\t\t]);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\n\toic_edit_confirm(name) {\n\t\t// Cleanup any existing dialog\n\t\tif (this.passwordDialog) {\n\t\t\tthis.passwordDialog.$wrapper.remove();\n\t\t\tdelete this.passwordDialog;\n\t\t}\n\t\n\t\tlet isAuthorized = false;\n\t\n\t\t// Create a new password dialog\n\t\tthis.passwordDialog = new frappe.ui.Dialog({\n\t\t\ttitle: __('Authorization Required OIC'),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: 'HTML',\n\t\t\t\t\tfieldname: 'password_html',\n\t\t\t\t\toptions: `\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label for=\"password_field\">${__('Password')}</label>\n\t\t\t\t\t\t\t<input type=\"password\" id=\"password_field\" class=\"form-control\" required>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`\n\t\t\t\t}\n\t\t\t],\n\t\t\tprimary_action_label: __('Authorize'),\n\t\t\tprimary_action: () => {\n\t\t\t\tlet password = document.getElementById('password_field').value;\n\t\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.confirm_user_password\",\n\t\t\t\t\targs: { password: password },\n\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\tif (r.message) {\n\t\t\t\t\t\t\tif (r.message.name) {\n\t\t\t\t\t\t\t\tisAuthorized = true;\n\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\tmessage: __('Verified'),\n\t\t\t\t\t\t\t\t\tindicator: 'green'\n\t\t\t\t\t\t\t\t});\n\t\n\t\t\t\t\t\t\t\tfrappe.run_serially([\n\t\t\t\t\t\t\t\t\t() => this.frm.refresh(name),\n\t\t\t\t\t\t\t\t\t() => this.cart.load_invoice(),\n\t\t\t\t\t\t\t\t\t() => this.item_selector.toggle_component(true),\n\t\t\t\t\t\t\t\t\t() => this.toggle_recent_order_list(false),\n\t\t\t\t\t\t\t\t\t() => this.item_selector.load_items_data()\n\t\t\t\t\t\t\t\t]).then(() => {\n\t\t\t\t\t\t\t\t\tthis.passwordDialog.hide();\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\tmessage: __('Incorrect password or user is not an OIC'),\n\t\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\tmessage: __('Incorrect password or user is not an OIC'),\n\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\n\t\t// Bind an event to reload the window when the dialog is hidden\n\t\tthis.passwordDialog.$wrapper.on('hidden.bs.modal', () => {\n\t\t\tif (!isAuthorized) {\n\t\t\t\twindow.location.reload();\n\t\t\t}\n\t\t});\n\t\n\t\t// Show the dialog\n\t\tthis.passwordDialog.show();\n\t\n\t\t// Ensure the password field gains focus every time the dialog is opened\n\t\tthis.passwordDialog.$wrapper.on('shown.bs.modal', () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tdocument.getElementById('password_field').focus();\n\t\t\t}, 100); // Slight delay to ensure field is rendered before focusing\n\t\t});\n\t}\n\t\n\n\n\n\ttoggle_recent_order_list(show) {\n\t\tthis.toggle_components(!show);\n\t\tthis.recent_order_list.toggle_component(show);\n\t\tthis.order_summary.toggle_component(show);\n\t}\n\n\ttoggle_components(show) {\n\t\tthis.cart.toggle_component(show);\n\t\tthis.item_selector.toggle_component(show);\n\n\t\t// do not show item details or payment if recent order is toggled off\n\t\t!show ? this.item_details.toggle_component(false) || this.payment.toggle_component(false) : \"\";\n\t}\n\n\tmake_new_invoice() {\n\t\treturn frappe.run_serially([\n\t\t\t() => frappe.dom.freeze(),\n\t\t\t() => this.make_sales_invoice_frm(),\n\t\t\t() => this.set_pos_profile_data(),\n\t\t\t() => this.set_pos_profile_status(),\n\t\t\t() => this.cart.load_invoice(),\n\t\t\t() => frappe.dom.unfreeze(),\n\t\t]);\n\t}\n\n\tmake_sales_invoice_frm() {\n\t\tconst doctype = \"POS Invoice\";\n\t\treturn new Promise((resolve) => {\n\t\t\tif (this.frm) {\n\t\t\t\tthis.frm = this.get_new_frm(this.frm);\n\t\t\t\t// console.log(this.frm.doc.payment)\n\t\t\t\tthis.frm.doc.items = [];\n\t\t\t\tthis.frm.doc.is_pos = 1;\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\tfrappe.model.with_doctype(doctype, () => {\n\t\t\t\t\tthis.frm = this.get_new_frm();\n\t\t\t\t\t// console.log(this.frm.doc.payments)\n\t\t\t\t\tthis.frm.doc.items = [];\n\t\t\t\t\tthis.frm.doc.is_pos = 1;\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tget_new_frm(_frm) {\n\t\tconst doctype = \"POS Invoice\";\n\t\tconst page = $(\"<div>\");\n\t\tconst frm = _frm || new frappe.ui.form.Form(doctype, page, false);\n\t\tconst name = frappe.model.make_new_doc_and_get_name(doctype, true);\n\t\tfrm.refresh(name);\n\n\t\treturn frm;\n\t}\n\n\tasync make_return_invoice(doc) {\n\t\tfrappe.dom.freeze();\n\t\tthis.frm = this.get_new_frm(this.frm);\n\t\tthis.frm.doc.items = [];\n\t\treturn frappe.call({\n\t\t\tmethod: \"erpnext.accounts.doctype.order_list.order_list.make_sales_return\",\n\t\t\targs: {\n\t\t\t\tsource_name: doc.name,\n\t\t\t\ttarget_doc: this.frm.doc,\n\t\t\t},\n\t\t\tcallback: (r) => {\n\t\t\t\tfrappe.model.sync(r.message);\n\t\t\t\tfrappe.get_doc(r.message.doctype, r.message.name).__run_link_triggers = false;\n\t\t\t\tthis.set_pos_profile_data().then(() => {\n\t\t\t\t\tfrappe.dom.unfreeze();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\tset_pos_profile_data() {\n\t\tif (this.company && !this.frm.doc.company) this.frm.doc.company = this.company;\n\t\tif (\n\t\t\t(this.pos_profile && !this.frm.doc.pos_profile) |\n\t\t\t(this.frm.doc.is_return && this.pos_profile != this.frm.doc.pos_profile)\n\t\t) {\n\t\t\tthis.frm.doc.pos_profile = this.pos_profile;\n\t\t}\n\n\t\tif (!this.frm.doc.company) return;\n\n\t\treturn this.frm.trigger(\"set_pos_data\");\n\t}\n\n\tset_pos_profile_status() {\n\t\tthis.page.set_indicator(this.pos_profile, \"blue\");\n\n\t}\n\n\tasync on_cart_update(args) {\n\t\tfrappe.dom.freeze();\n\t\tlet item_row = undefined;\n\t\ttry {\n\t\t\tlet { field, value, item } = args;\n\t\t\titem_row = this.get_item_from_frm(item);\n\t\t\tconst item_row_exists = !$.isEmptyObject(item_row);\n\n\t\t\tconst from_selector = field === \"qty\" && value === \"+1\";\n\t\t\tif (from_selector) value = flt(item_row.stock_qty) + flt(value);\n\n\t\t\tif (item_row_exists) {\n\t\t\t\tif (field === \"qty\") value = flt(value);\n\n\t\t\t\tif ([\"qty\", \"conversion_factor\"].includes(field) && value > 0 && !this.allow_negative_stock) {\n\t\t\t\t\tconst qty_needed =\n\t\t\t\t\t\tfield === \"qty\" ? value * item_row.conversion_factor : item_row.qty * value;\n\t\t\t\t\tawait this.check_stock_availability(item_row, qty_needed, this.frm.doc.set_warehouse);\n\t\t\t\t}\n\n\t\t\t\tif (this.is_current_item_being_edited(item_row) || from_selector) {\n\t\t\t\t\tawait frappe.model.set_value(item_row.doctype, item_row.name, field, value);\n\t\t\t\t\tthis.update_cart_html(item_row);\n\n\t\t\t\t\t// await this.auto_add_batch(item_row);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (!this.frm.doc.customer) return this.raise_customer_selection_alert();\n\n\t\t\t\tconst { item_code, batch_no, serial_no, rate, uom } = item;\n\n\t\t\t\tif (!item_code) return;\n\n\t\t\t\tconst new_item = { item_code, batch_no, rate, uom, [field]: value };\n\n\t\t\t\tif (serial_no && serial_no !== \"undefined\") {\n\t\t\t\t\tawait this.check_serial_no_availablilty(item_code, this.frm.doc.set_warehouse, serial_no);\n\t\t\t\t\tnew_item[\"serial_no\"] = serial_no;\n\t\t\t\t}\n\n\t\t\t\tif (field === \"serial_no\") new_item[\"qty\"] = value.split(`\\n`).length || 0;\n\n\t\t\t\titem_row = this.frm.add_child(\"items\", new_item);\n\n\t\t\t\tif (field === \"qty\" && value !== 0 && !this.allow_negative_stock) {\n\t\t\t\t\tconst qty_needed = value * item_row.conversion_factor;\n\t\t\t\t\tawait this.check_stock_availability(item_row, qty_needed, this.frm.doc.set_warehouse);\n\t\t\t\t}\n\n\t\t\t\tawait this.trigger_new_item_events(item_row);\n\n\t\t\t\tthis.update_cart_html(item_row);\n\n\t\t\t\t// await this.auto_add_batch(item_row);\n\n\t\t\t\tif (this.item_details.$component.is(\":visible\")) this.edit_item_details_of(item_row);\n\n\t\t\t\tif (\n\t\t\t\t\tthis.check_serial_batch_selection_needed(item_row) &&\n\t\t\t\t\t!this.item_details.$component.is(\":visible\")\n\t\t\t\t)\n\t\t\t\t\tthis.edit_item_details_of(item_row);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.log(error);\n\t\t} finally {\n\t\t\tfrappe.dom.unfreeze();\n\t\t\treturn item_row; // eslint-disable-line no-unsafe-finally\n\t\t}\n\t}\n\n\traise_customer_selection_alert() {\n\t\tfrappe.dom.unfreeze();\n\t\tfrappe.show_alert({\n\t\t\tmessage: __(\"You must select a customer before adding an item.\"),\n\t\t\tindicator: \"orange\",\n\t\t});\n\t\tfrappe.utils.play_sound(\"error\");\n\t}\n\n\tget_item_from_frm({ name, item_code, batch_no, uom, rate }) {\n\t\tlet item_row = null;\n\t\tif (name) {\n\t\t\titem_row = this.frm.doc.items.find((i) => i.name == name);\n\t\t} else {\n\t\t\t// if item is clicked twice from item selector\n\t\t\t// then \"item_code, batch_no, uom, rate\" will help in getting the exact item\n\t\t\t// to increase the qty by one\n\t\t\tconst has_batch_no = batch_no !== \"null\" && batch_no !== null;\n\t\t\titem_row = this.frm.doc.items.find(\n\t\t\t\t(i) =>\n\t\t\t\t\ti.item_code === item_code &&\n\t\t\t\t\t(!has_batch_no || (has_batch_no && i.batch_no === batch_no)) &&\n\t\t\t\t\ti.uom === uom &&\n\t\t\t\t\ti.rate === flt(rate)\n\t\t\t);\n\t\t}\n\n\t\treturn item_row || {};\n\t}\n\n\tedit_item_details_of(item_row) {\n\t\tthis.item_details.toggle_item_details_section(item_row);\n\t}\n\n\tis_current_item_being_edited(item_row) {\n\t\treturn item_row.name == this.item_details.current_item.name;\n\t}\n\n\tupdate_cart_html(item_row, remove_item) {\n\t\tthis.cart.update_item_html(item_row, remove_item);\n\t\n\t\t// Debounce the save action to prevent multiple saves\n\t\tclearTimeout(this.saveTimeout); // Clear any existing timeout\n\t\tthis.saveTimeout = setTimeout(() => {\n\t\t\tthis.frm.save().then(() => {\n\t\t\t\t// Update the totals section in the cart\n\t\t\t\tthis.cart.update_totals_section(this.frm);\n\t\t\t}).catch((error) => {\n\t\t\t\tconsole.error(\"Error saving the document:\", error);\n\t\t\t});\n\t\t}, 500); // Adjust the delay as needed (500ms in this case)\n\t}\n\t\n\n\tcheck_serial_batch_selection_needed(item_row) {\n\t\t// right now item details is shown for every type of item.\n\t\t// if item details is not shown for every item then this fn will be needed\n\t\tconst serialized = item_row.has_serial_no;\n\t\tconst batched = item_row.has_batch_no;\n\t\tconst no_serial_selected = !item_row.serial_no;\n\t\tconst no_batch_selected = !item_row.batch_no;\n\n\t\tif (\n\t\t\t(serialized && no_serial_selected) ||\n\t\t\t(batched && no_batch_selected) ||\n\t\t\t(serialized && batched && (no_batch_selected || no_serial_selected))\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tasync trigger_new_item_events(item_row) {\n\t\tawait this.frm.script_manager.trigger(\"item_code\", item_row.doctype, item_row.name);\n\t\tawait this.frm.script_manager.trigger(\"qty\", item_row.doctype, item_row.name);\n\t}\n\n\tasync check_stock_availability(item_row, qty_needed, warehouse) {\n\t\tconst resp = (await this.get_available_stock(item_row.item_code, warehouse)).message;\n\t\tconst available_qty = resp[0];\n\t\tconst is_stock_item = resp[1];\n\n\t\tfrappe.dom.unfreeze();\n\t\tconst bold_uom = item_row.stock_uom.bold();\n\t\tconst bold_item_code = item_row.item_code.bold();\n\t\tconst bold_warehouse = warehouse.bold();\n\t\tconst bold_available_qty = available_qty.toString().bold();\n\t\tif (!(available_qty > 0)) {\n\t\t\tif (is_stock_item) {\n\t\t\t\tfrappe.model.clear_doc(item_row.doctype, item_row.name);\n\t\t\t\tfrappe.throw({\n\t\t\t\t\ttitle: __(\"Not Available\"),\n\t\t\t\t\tmessage: __(\"Item Code: {0} is not available under warehouse {1}.\", [\n\t\t\t\t\t\tbold_item_code,\n\t\t\t\t\t\tbold_warehouse,\n\t\t\t\t\t]),\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t} else if (is_stock_item && available_qty < qty_needed) {\n\t\t\tfrappe.throw({\n\t\t\t\tmessage: __(\n\t\t\t\t\t\"Stock quantity not enough for Item Code: {0} under warehouse {1}. Available quantity {2} {3}.\",\n\t\t\t\t\t[bold_item_code, bold_warehouse, bold_available_qty, bold_uom]\n\t\t\t\t),\n\t\t\t\tindicator: \"orange\",\n\t\t\t});\n\t\t\tfrappe.utils.play_sound(\"error\");\n\t\t}\n\t\tfrappe.dom.freeze();\n\t}\n\n\tasync check_serial_no_availablilty(item_code, warehouse, serial_no) {\n\t\tconst method = \"erpnext.stock.doctype.serial_no.serial_no.get_pos_reserved_serial_nos\";\n\t\tconst args = { filters: { item_code, warehouse } };\n\t\tconst res = await frappe.call({ method, args });\n\n\t\tif (res.message.includes(serial_no)) {\n\t\t\tfrappe.throw({\n\t\t\t\ttitle: (\"Not Available\"),\n\t\t\t\tmessage: (\"Serial No: {0} has already been transacted into another POS Invoice.\", [\n\t\t\t\t\tserial_no.bold(),\n\t\t\t\t]),\n\t\t\t});\n\t\t}\n\t}\n\n\tget_available_stock(item_code, warehouse) {\n\t\tconst me = this;\n\t\treturn frappe.call({\n\t\t\tmethod: \"erpnext.accounts.doctype.pos_invoice.pos_invoice.get_stock_availability\",\n\t\t\targs: {\n\t\t\t\titem_code: item_code,\n\t\t\t\twarehouse: warehouse,\n\t\t\t},\n\t\t\tcallback(res) {\n\t\t\t\tif (!me.item_stock_map[item_code]) me.item_stock_map[item_code] = {};\n\t\t\t\tme.item_stock_map[item_code][warehouse] = res.message;\n\t\t\t},\n\t\t});\n\t}\n\t\n\tasync auto_add_batch(item_row) {\n\t\ttry {\n\t\t\t// Fetch batches for the item with a valid expiry date\n\t\t\tlet batches = await frappe.db.get_list('Batch', {\n\t\t\t\tfilters: {\n\t\t\t\t\titem: item_row.item_code,\n\t\t\t\t\texpiry_date: ['>=', frappe.datetime.now_date()]\n\t\t\t\t},\n\t\t\t\tfields: ['name', 'expiry_date'],\n\t\t\t\torder_by: 'expiry_date desc'\n\t\t\t});\n\t\n\t\t\tif (batches.length > 0) {\n\t\t\t\tlet latest_batch = batches[0];  // Get the most recent batch\n\t\t\t\tlet entries = [{\n\t\t\t\t\tbatch_no: latest_batch.name,\n\t\t\t\t\tqty: item_row.qty,\n\t\t\t\t\tname: \"row 1\",\n\t\t\t\t\twarehouse: this.frm.doc.set_warehouse\n\t\t\t\t}];\n\t\n\t\t\t\t// Call the server-side method to process batch entries\n\t\t\t\tconst res = await frappe.call({\n\t\t\t\t\tmethod: \"erpnext.stock.doctype.serial_and_batch_bundle.serial_and_batch_bundle.add_serial_batch_ledgers\",\n\t\t\t\t\targs: {\n\t\t\t\t\t\tentries: entries,\n\t\t\t\t\t\tchild_row: item_row,\n\t\t\t\t\t\tdoc: this.frm.doc,\n\t\t\t\t\t\twarehouse: this.frm.doc.set_warehouse\n\t\t\t\t\t},\n\t\t\t\t});\n\t\n\t\t\t\t// Update POS Invoice Item with batch_no and expiry_date\n\t\t\t\tif (res.message) {\n\t\t\t\t\t// Update batch_no and expiry_date fields\n\t\t\t\t\tfrappe.model.set_value(item_row.doctype, item_row.name, {\n\t\t\t\t\t\tserial_and_batch_bundle: res.message.name,\n\t\t\t\t\t\tqty: Math.abs(res.message.total_qty),\n\t\t\t\t\t\tcustom_batch_number: latest_batch.name,    // Set batch number\n\t\t\t\t\t\tcustom_batch_expiry: latest_batch.expiry_date, \n\t\t\t\t\t});\n\t\t\t\t}\n\t\n\t\t\t} else {\n\t\t\t\tfrappe.show_alert({\n\t\t\t\t\tmessage: __('No batches found for the selected item.'),\n\t\t\t\t\tindicator: 'red',\n\t\t\t\t});\n\t\t\t}\n\t\n\t\t} catch (error) {\n\t\t\tfrappe.show_alert({\n\t\t\t\tmessage: __('Batch fetch failed. Please try again.'),\n\t\t\t\tindicator: 'red',\n\t\t\t});\n\t\t\tconsole.error(error);\n\t\t}\n\t}\n\t\n\t\n\n\tasync update_item_field(value, field_or_action) {\n\n\t\tif (field_or_action === \"checkout\") {\n\t\t\tthis.item_details.toggle_item_details_section(null);\n\t\t\t\n\t\t} else if (field_or_action === \"remove\") {\n\t\t\tthis.remove_item_from_cart();\n\t\t} else {\n\t\t\tconst field_control = this.item_details[`${field_or_action}_control`];\n\t\t\tif (!field_control) return;\n\t\t\tfield_control.set_focus();\n\t\t\tvalue != \"\" && field_control.set_value(value);\n\t\t}\n\t}\n\n\t// remove_item_from_cart() {\t\n\t// \tfrappe.dom.freeze();\n\t// \tconst { doctype, name, current_item } = this.item_details;\n\n\t// \treturn frappe.model\n\t// \t\t.set_value(doctype, name, \"qty\", 0)\n\t// \t\t.then(() => {\n\t// \t\t\tfrappe.model.clear_doc(doctype, name);\n\t// \t\t\tthis.update_cart_html(current_item, true);\n\t// \t\t\tthis.item_details.toggle_item_details_section(null);\n\t// \t\t\tfrappe.dom.unfreeze();\n\t// \t\t})\n\t// \t.catch((e) => console.log(e));\n\t// }\n\n\t\n\n\t// remove_item_from_cart() {\n\n\t// \t//Authenticate OIC to Remove\n\t// \tconst passwordDialog = new frappe.ui.Dialog({\n\t// \t\ttitle: __('Enter OIC Password'),\n\t// \t\tfields: [\n\t// \t\t\t{\n\t// \t\t\t\tfieldname: 'password',\n\t// \t\t\t\tfieldtype: 'Password',\n\t// \t\t\t\tlabel: __('Password'),\n\t// \t\t\t\treqd: 1\n\t// \t\t\t}\n\t// \t\t],\n\t// \t\tprimary_action_label: __('Remove'),\n\t// \t\tprimary_action: (values) => {\n\t// \t\t\tlet password = values.password;\n\t// \t\t\tlet role = \"oic\";\n\t\n\t// \t\t\tfrappe.call({\n\t// \t\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.confirm_user_password\",\n\t// \t\t\t\targs: { password: password, role: role },\n\t// \t\t\t\tcallback: (r) => {\n\t// \t\t\t\t\tif (r.message) {\n\t// \t\t\t\t\t\t// Password authenticated, proceed with item removal\n\t// \t\t\t\t\t\tfrappe.dom.freeze();\n\t// \t\t\t\t\t\tconst { doctype, name, current_item } = this.item_details;\n\t\n\t// \t\t\t\t\t\tfrappe.model\n\t// \t\t\t\t\t\t\t.set_value(doctype, name, \"qty\", 0)\n\t// \t\t\t\t\t\t\t.then(() => {\n\t// \t\t\t\t\t\t\t\tfrappe.model.clear_doc(doctype, name);\n\t// \t\t\t\t\t\t\t\tthis.update_cart_html(current_item, true);\n\t// \t\t\t\t\t\t\t\tthis.item_details.toggle_item_details_section(null);\n\t// \t\t\t\t\t\t\t\tfrappe.dom.unfreeze();\n\t// \t\t\t\t\t\t\t\tpasswordDialog.hide();\n\t// \t\t\t\t\t\t\t})\n\t// \t\t\t\t\t\t\t.catch((e) => {\n\t// \t\t\t\t\t\t\t\tconsole.log(e);\n\t// \t\t\t\t\t\t\t\tfrappe.dom.unfreeze();\n\t// \t\t\t\t\t\t\t\tpasswordDialog.hide();\n\t// \t\t\t\t\t\t\t});\n\t// \t\t\t\t\t} else {\n\t// \t\t\t\t\t\tfrappe.show_alert({\n\t// \t\t\t\t\t\t\tmessage: __('Incorrect password or user is not an OIC'),\n\t// \t\t\t\t\t\t\tindicator: 'red'\n\t// \t\t\t\t\t\t});\n\t// \t\t\t\t\t}\n\t// \t\t\t\t}\n\t// \t\t\t});\n\t// \t\t}\n\t// \t});\n\t// \tpasswordDialog.show();\n\t// }\n\n\n\n\tremove_item_from_cart() {\n\t\t// Destroy any previous instances of the dialog\n\t\tif (this.passwordDialog) {\n\t\t\tthis.passwordDialog.$wrapper.remove();\n\t\t\tdelete this.passwordDialog;\n\t\t}\n\t\n\t\t// Create and show the password dialog\n\t\tthis.passwordDialog = new frappe.ui.Dialog({\n\t\t\ttitle: __('Enter OIC Password'),\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: 'HTML',\n\t\t\t\t\tfieldname: 'password_html',\n\t\t\t\t\toptions: `\n\t\t\t\t\t\t<div class=\"form-group\">\n\t\t\t\t\t\t\t<label for=\"password_field\">${__('Password')}</label>\n\t\t\t\t\t\t\t<input type=\"password\" id=\"password_field\" class=\"form-control\" required>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`\n\t\t\t\t}\n\t\t\t],\n\t\t\tprimary_action_label: __('Ok'),\n\t\t\tprimary_action: () => {\n\t\t\t\t// Retrieve the password value from the HTML field\n\t\t\t\tlet password = document.getElementById('password_field').value;\n\t\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_app.customapp.page.packing_list.packing_list.confirm_user_password\",\n\t\t\t\t\targs: { password: password },\n\t\t\t\t\tcallback: (r) => {\n\t\t\t\t\t\tif (r.message) {\n\t\t\t\t\t\t\tif (r.message.name) {\n\t\t\t\t\t\t\t\tfrappe.dom.freeze();\n\t\t\t\t\t\t\t\tconst { doctype, name, current_item } = this.item_details;\n\t\n\t\t\t\t\t\t\t\tfrappe.model\n\t\t\t\t\t\t\t\t\t.set_value(doctype, name, \"qty\", 0)\n\t\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\t\tfrappe.model.clear_doc(doctype, name);\n\t\t\t\t\t\t\t\t\t\tthis.update_cart_html(current_item, true);\n\t\t\t\t\t\t\t\t\t\tthis.item_details.toggle_item_details_section(null);\n\t\t\t\t\t\t\t\t\t\tfrappe.dom.unfreeze();\n\t\t\t\t\t\t\t\t\t\tthis.passwordDialog.hide();\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t.catch((e) => {\n\t\t\t\t\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t\t\t\t\t\tfrappe.dom.unfreeze();\n\t\t\t\t\t\t\t\t\t\tthis.passwordDialog.hide();\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\t\tmessage: ('Incorrect password'),\n\t\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\t\t\tmessage: ('Incorrect password'),\n\t\t\t\t\t\t\t\tindicator: 'red'\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\n\t\tthis.passwordDialog.show();\n\t\n\t\t// Ensure the password field gains focus every time the dialog is opened\n\t\tthis.passwordDialog.$wrapper.on('shown.bs.modal', function () {\n\t\t\tsetTimeout(() => {\n\t\t\t\tdocument.getElementById('password_field').focus();\n\t\t\t}, 100); // Slight delay to ensure field is rendered before focusing\n\t\t});\n\t}\n\t\n\n\t// remove_item_from_cart() {\n\n\t// \t//Authenticate OIC to Remove\n\t// \tconst passwordDialog = new frappe.ui.Dialog({\n\t// \t\ttitle: __('Enter OIC Password'),\n\t// \t\tfields: [\n\t// \t\t\t{\n\t// \t\t\t\tfieldname: 'password',\n\t// \t\t\t\tfieldtype: 'Password',\n\t// \t\t\t\tlabel: __('Password'),\n\t// \t\t\t\treqd: 1\n\t// \t\t\t}\n\t// \t\t],\n\t// \t\tprimary_action_label: __('Ok'),\n\t// \t\tprimary_action: (values) => {\n    //             let password = values.password;\n    //             frappe.call({\n    //                 method: \"custom_app.customapp.page.packing_list.packing_list.confirm_user_password\",\n    //                 args: { password: password },\n    //                 callback: (r) => {\n    //                     if (r.message) {\n    //                         if(r.message.name) {\n    //                             this.set_pharmacist_assist(this.frm, r.message.name)\n\t// \t\t\t\t\t\t\tconsole.log(this.frm, r.message.name)\n    //                             this.frm\n    //                                 .save(undefined, undefined, undefined, () => {\n    //                                     frappe.show_alert({\n    //                                         message: (\"There was an error saving the document.\"),\n    //                                         indicator: \"red\",\n    //                                     });\n    //                                     frappe.utils.play_sound(\"error\");\n    //                                 })\n    //                                 .then(() => {\n\t// \t\t\t\t\t\t\t\t\tfrappe.dom.freeze();\n\t// \t\t\t\t\t\t\t\t\tconst { doctype, name, current_item } = this.item_details;\n\t\t\t\t\n\t// \t\t\t\t\t\t\t\t\tfrappe.model\n\t// \t\t\t\t\t\t\t\t\t\t.set_value(doctype, name, \"qty\", 0)\n\t// \t\t\t\t\t\t\t\t\t\t.then(() => {\n\t// \t\t\t\t\t\t\t\t\t\t\tfrappe.model.clear_doc(doctype, name);\n\t// \t\t\t\t\t\t\t\t\t\t\tthis.update_cart_html(current_item, true);\n\t// \t\t\t\t\t\t\t\t\t\t\tthis.item_details.toggle_item_details_section(null);\n\t// \t\t\t\t\t\t\t\t\t\t\tfrappe.dom.unfreeze();\n\t// \t\t\t\t\t\t\t\t\t\t\tpasswordDialog.hide();\n\t// \t\t\t\t\t\t\t\t\t\t})\n\t// \t\t\t\t\t\t\t\t\t\t.catch((e) => {\n\t// \t\t\t\t\t\t\t\t\t\t\tconsole.log(e);\n\t// \t\t\t\t\t\t\t\t\t\t\tfrappe.dom.unfreeze();\n\t// \t\t\t\t\t\t\t\t\t\t\tpasswordDialog.hide();\n\t// \t\t\t\t\t\t\t\t\t\t});\n    //                                 });\n    //                         }else{\n    //                             frappe.show_alert({\n    //                                 message: ('Incorrect password'),\n    //                                 indicator: 'red'\n    //                             });\n    //                         }\n    //                     } else {\n    //                         frappe.show_alert({\n    //                             message: ('Incorrect password'),\n    //                             indicator: 'red'\n    //                         });\n    //                     }\n    //                 }\n    //             });\n    //         }\n\t// \t})\n\t// \tpasswordDialog.show();\n\t// }\n\n\n\tasync save_and_checkout() {\n\t\tif (this.frm.is_dirty()) {\n\t\t\tlet save_error = false;\n\t\t\t// await this.frm.save(null, null, null, () => (save_error = true));\n\t\t\t// only move to payment section if save is successful\n\t\t\t!save_error && this.payment.checkout();\n\t\t\t// show checkout button on error\n\t\t\tsave_error &&\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.cart.toggle_checkout_btn(true);\n\t\t\t\t}, 300); // wait for save to finish\n\t\t} else {\n\t\t\tthis.payment.checkout();\n\t\t}\n\t}\n};\n"],
  "mappings": "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",
  "names": ["onScan", "Barcode", "CODE39", "characterValue", "CODE128", "matchSetALength", "matchSetBLength", "matchSetC", "CODE128AUTO", "CODE128A", "CODE128B", "CODE128C", "require_CODE128", "require_constants", "encode", "EAN", "checksum", "EAN13", "checksum", "EAN8", "checksum", "EAN5", "EAN2", "UPC", "UPCE", "require_constants", "ITF", "checksum", "ITF14", "require_ITF", "MSI", "MSI10", "MSI11", "MSI1010", "MSI1110", "require_MSI", "pharmacode", "codabar", "GenericBarcode", "CanvasRenderer", "SVGRenderer", "ObjectRenderer", "InvalidInputException", "InvalidElementException", "NoElementException", "ErrorHandler", "API", "JsBarcode", "name", "precision", "onScan", "selectedUOM", "rate", "uom", "dialog", "response", "quantity", "event", "email_id", "mobile_no", "max_width", "item_data", "customer_group", "updated_discount_log", "$btn", "save_button", "dialog", "validateLastFourDigits", "me", "currency", "event", "jsbarcode", "max_width", "dialog", "rate"]
}
